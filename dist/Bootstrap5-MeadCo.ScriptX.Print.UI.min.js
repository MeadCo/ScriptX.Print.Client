!function(e,l){"use strict";if(!e)return;let t=e.createNS("MeadCo.ScriptX.Print.UI");t.version="1.16.1.0",e.log("MeadCo.ScriptX.Print.UI version is: "+t.version);let o=!1,r=null,a=null;function i(e){e.preventDefault(),function(){const e=document.querySelector("#dlg-printoptions"),l=MeadCo.ScriptX.Print.HTML.settings;e&&(l.page.orientation=e.querySelector('[name="fld-orientation"]:checked').value,l.printBackgroundColorsAndImages=e.querySelector("#fld-printbackground").checked,l.viewScale=e.querySelector("#fld-shrinktofit").checked?-1:100,l.page.units=parseInt(e.querySelector('[name="fld-measure"]:checked').value),l.page.margins.left=e.querySelector("#fld-marginL").value,l.page.margins.top=e.querySelector("#fld-marginT").value,l.page.margins.right=e.querySelector("#fld-marginR").value,l.page.margins.bottom=e.querySelector("#fld-marginB").value,l.header=e.querySelector("#fld-header").value,l.footer=e.querySelector("#fld-footer").value,MeadCo.ScriptX.Print.deviceSettings.paperSizeName=e.querySelector("#fld-papersize").value)}(),o=!0,r.hide()}function d(){a&&a(o)}function s(){switch(document.querySelector('[name="fld-measure"]:checked').value){case"2":document.querySelectorAll("#dlg-printoptions input[type=number][data-rule=measure]").forEach((e=>{var l;(l=e).value=(2540*parseFloat(l.value)/100).toFixed(2)}));break;case"1":document.querySelectorAll("#dlg-printoptions input[type=number][data-rule=measure]").forEach((e=>{var l;(l=e).value=(100*parseFloat(l.value)/2540).toFixed(2)}))}}function c(e){e.preventDefault(),function(){let e=document.querySelector("#dlg-printersettings");const l=MeadCo.ScriptX.Print;if(e){const t=l.onErrorAction;l.onErrorAction=l.ErrorAction.THROW;try{l.printerName=e.querySelector("#fld-printerselect").value}finally{l.onErrorAction=t}let o=l.deviceSettings;o.paperSourceName=e.querySelector("#fld-papersource").value,o.collate=e.querySelector("#fld-collate").getAttribute("checked")?l.CollateOptions.TRUE:l.CollateOptions.FALSE,o.copies=parseInt(e.querySelector("#fld-copies").value)}}(),o=!0,r.hide()}function n(e){m(document.getElementById("dlg-printersettings"),e.target.options[e.target.selectedIndex].value)}function m(e,l){u(e,l)}function u(e,l,t){MeadCo.ScriptX.Print.deviceSettingsForAsync(l,(l=>{const o=l.bins,r=e.querySelector("#fld-papersource");f(r);for(var a=0;a<o.length;a++)r.add(new Option(o[a]));r.value=l.paperSourceName,t&&t()}),(e=>{MeadCo.ScriptX.Print.reportError(e),t&&t()}))}function f(e){for(let l=e.options.length-1;l>=0;l--)e.remove(l)}t.PageSetup=function(e){if(!bootstrap.Modal)return console.error("MeadCo.ScriptX.Print.UI requires bootstrap v5 or later"),void e(!1);o=!1,a=e;const l=(bootstrap.Modal.VERSION||"").split(" ")[0].split(".")[0],t="dlg-printoptions";let c=document.getElementById(t);if(!c){let o;if(console.log("UI.PageSetup bootstrap modal version: "+bootstrap.Modal.VERSION+", major: "+l),"5"!==l)return console.error("Unknown version of bootstrap: "+l),void e(!1);o='<div class="modal" tabindex="-1" id="dlg-printoptions"><div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-lg" role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Page setup</h5><button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button></div><div class="modal-body"><div class="bs-component"><fieldset><legend>Paper</legend><div class="row"><label for="fld-papersize" class="col-md-4 col-form-label text-right col-form-label-sm">Size</label><div class="col-md-8"><select class=" form-select form-select-sm" id="fld-papersize"></select></div></div><div class="row mt-2"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-portrait" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Portrait</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-landscape" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Landscape</label></div></div></div><div class="row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-shrinktofit" id="fld-shrinktofit"><label class="form-check-label" for="fld-shrinktofit">Shrink to fit</label></div></div></div><div class="row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-printbackground" id="fld-printbackground"><label class="form-check-label" for="fld-printbackground">Print background colour and images</label></div></div></div></fieldset><fieldset><legend>Margins</legend><div class="row"><div class="col-md-8 offset-md-4" id="radiomeasures"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-millimetres" name="fld-measure" /><label class="form-check-label" for="fld-millimetres">Millimetres</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-inches" name="fld-measure" /><label class="form-check-label" for="fld-inches">Inches</label></div></div></div><div class="row mt-2"><label class="col-md-4 col-form-label text-right col-form-label-sm">Left</label><div class="col-md-3"><div class="input-group"><input name="fld-marginL" id="fld-marginL" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" data-rule="measure" value="1" /></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Top</label><div class="col-md-3"><div class="input-group"><input name="fld-marginT" id="fld-marginT" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" data-rule="measure" value="1" /></div></div></div><div class="row mt-2"><label class="col-md-4 col-form-label text-right col-form-label-sm">Right</label><div class="col-md-3"><div class="input-group"><input name="fld-marginR" id="fld-marginR" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" value="1" data-rule="measure"/></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Bottom</label><div class="col-md-3"><div class="input-group"><input name="fld-marginB" id="fld-marginB" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" value="1" data-rule="measure"/></div></div></div></fieldset><fieldset class="mt-2"><legend>Headers and footers</legend><div class="row"><label for="fld-header" class="col-md-4 col-form-label text-right col-form-label-sm">Header</label><div class="col-md-8"><input type="text" name="fld-header" id="fld-header" class="form-control form-control-sm" /></div></div><div class="row mt-2"><label for="fld-footer" class="col-md-4 col-form-label text-right col-form-label-sm">Footer</label><div class="col-md-8"><input type="text" name="fld-footer" id="fld-footer" class="form-control form-control-sm" /></div></div></fieldset></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-saveoptions">OK</button><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button></div></div></div></div>';const r=document.createElement("div");r.innerHTML=o,document.body.appendChild(r,null),c=document.getElementById(t)}if(c){c.querySelector("#radiomeasures").addEventListener("change",s);const e=c.querySelector("#btn-saveoptions");e&&e.addEventListener("click",i),c.addEventListener("hidden.bs.modal",d)}let n=MeadCo.ScriptX.Print.HTML.settings,m=c.querySelector(`input[name="fld-orientation"][value="${n.page.orientation}"]`);m&&(m.checked=!0),c.querySelector("#fld-printbackground").checked=n.printBackgroundColorsAndImages,c.querySelector("#fld-shrinktofit").checked=-1==n.viewScale,m=c.querySelector(`input[name="fld-measure"][value="${n.page.units}"]`),m&&(m.checked=!0),c.querySelector("#fld-marginL").value=n.page.margins.left,c.querySelector("#fld-marginT").value=n.page.margins.top,c.querySelector("#fld-marginR").value=n.page.margins.right,c.querySelector("#fld-marginB").value=n.page.margins.bottom,c.querySelector("#fld-header").value=n.header,c.querySelector("#fld-footer").value=n.footer;const u=MeadCo.ScriptX.Print,p=document.querySelector("#fld-papersize"),v=u.deviceSettingsFor(u.printerName).forms;for(var b in f(p),v)p.add(new Option(v[b]));p.value=MeadCo.ScriptX.Print.deviceSettings.paperSizeName,r=new bootstrap.Modal(document.getElementById(t),{backdrop:"static",keyboard:!1}),r.show()},t.PrinterSettings=function(e){if(!bootstrap.Modal)return console.error("MeadCo.ScriptX.Print.UI requires bootstrap Modal"),void e(!1);const l=(bootstrap.Modal.VERSION||"").split(" ")[0].split(".")[0],t="dlg-printersettings";let i=document.getElementById(t);o=!1;if(a=e,!i){let o;if(console.log("UI.PageSetup bootstrap modal version: "+bootstrap.Modal.VERSION+", major: "+l),"5"!==l)return console.error("Unknown version of bootstrap: "+l),void e(!1);o='<div class="modal" id="dlg-printersettings"><div class="modal-dialog role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Print</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button></div><div class="modal-body"><div class="bs-component"><div class="row"><label for="fld-printerselect" class="col-md-4 form-label text-right col-form-label-sm">Printer</label><div class="col-md-8"><select class=" form-select form-select-sm" id="fld-printerselect"></select></div></div><div class="row mt-2"><label for="fld-papersource" class="col-md-4 form-label text-right col-form-label-sm">Paper source</label><div class="col-md-8"><select class=" form-select form-select-sm" id="fld-papersource"></select></div></div><div class="row g-3" style="margin-top:-8px"><label for="fld-copies" class="col-md-4 form-label text-right col-form-label-sm">Copies</label><div class="col-md-3"><input name="fld-copies" id="fld-copies" type="number" min="1" max="5" step="1" class="form-control form-control-sm text-right" data-rule="quantity" value="1" /></div><div class="col-md-5"><div class="form-check" style="margin-top: 4px"><input class="form-check-input" type="checkbox" name="fld-collate" id="fld-collate"><label class="form-check-label" for="fld-collate">Collate</label></div></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-savesettings">Print</button><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button></div></div></div></div >';const r=document.createElement("div");r.innerHTML=o,document.body.appendChild(r,null),i=document.getElementById(t)}if(i){let e=i.querySelector("#btn-savesettings");e&&e.addEventListener("click",c),e=i.querySelector("#fld-printerselect"),e&&e.addEventListener("change",n),i.addEventListener("hidden.bs.modal",d)}!function(e){const l=MeadCo.ScriptX.Print,t=e.querySelector("#fld-printerselect"),o=l.availablePrinterNames;f(t);for(let e=0;e<o.length;e++)t.add(new Option(o[e]));t.value=l.printerName,m(e,l.printerName)}(i),function(e){u(e,MeadCo.ScriptX.Print.printerName,(()=>{const l=MeadCo.ScriptX.Print,t=l.deviceSettings;e.querySelector("#fld-collate").setAttribute("checked",t.collate===l.CollateOptions.TRUE),e.querySelector("#fld-copies").value=t.copies}))}(i),r=new bootstrap.Modal(document.getElementById(t),{backdrop:"static",keyboard:!1}),r.show()}}(window.MeadCo=window.MeadCo||null);
//# sourceMappingURL=Bootstrap5-MeadCo.ScriptX.Print.UI.min.js.map
