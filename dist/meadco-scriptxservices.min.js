/*!
 * MeadCo.Core (support for modern browsers and IE 11) JS client library
 * Copyright 2017 Mead & Company. All rights reserved.
 * https://github.com/MeadCo/ScriptX.Print.Client
 *
 * Released under the MIT license
 */
(function(n,t){var f=t(),o=typeof define=="function"&&define.amd,s=typeof module!="undefined"&&module.exports,i,r,e,u;if(o)define(f);else if(s)module.exports=f;else{if(i=this,r=null,typeof i[n]!="undefined"&&(console.log(n+" already exists"),r=i[n]),i[n]=f,r!=null){e=i[n];console.log("preserving old scope ... ");for(u in r)r.hasOwnProperty(u)&&(console.log("will preserve: "+u),e[u]=r[u])}f.scope=i}})("MeadCo",function(){var t=this,i="1.4.9.0",n=function(n){console.log("MeadCo :: "+n)},r=function(n){console.warn("MeadCo :: "+n)},u=function(n){console.error("MeadCo :: "+n)};return t.extendMeadCoNamespace=function(i,r){var s=r(),a=typeof define=="function"&&define.amd,v=typeof t!="undefined"&&t.exports,h,f,e,u,c,l,o;if(a)define(s);else if(v)t.exports=s;else for(n("MeadCo root extending namespace: "+i),h=i.split("."),f=t.scope||this.jQuery||this.ender||this.$||this,e=0;e<h.length;e++){if(u=h[e],e===h.length-1)if(typeof f[u]=="undefined")n("installing implementation at: "+u),f[u]=s;else{n("Warning - extending package: "+u);c=f[u];f[u]=s;l=f[u];console.log("preserving old scope ... ");for(o in c)c.hasOwnProperty(o)&&(console.log("will preserve: "+o),l[o]=c[o])}else typeof f[u]=="undefined"?(n("initialising new: "+u),f[u]={}):n("using existing package: "+u);f=f[u]}},n("MeadCo root namespace loaded."),{log:n,warn:r,error:u,get version(){return i},createNS:function(n){var t=n.split("."),i=window.MeadCo,r,u;for(t[0]==="MeadCo"&&(t=t.slice(1)),r=0;r<t.length;r++)u=t[r],typeof i[u]=="undefined"&&(i[u]={}),i=i[u];return i},set scope(n){t.scope=n},makeApiEndPoint:function(n,t){return n.indexOf("/api/")===-1&&(n.lastIndexOf("/")!==n.length-1&&(n+="/"),n+="api/"+t),n}}});
/*!
 * MeadCo ScriptX 'window.factory' shim (support for modern browsers and IE 11) JS client library
 * Copyright 2017 Mead & Company. All rights reserved.
 * https://github.com/MeadCo/ScriptX.Print.Client
 *
 * Released under the MIT license
 */
(function(n,t,i){if(this[n]!=i||document.getElementById(n)!=null){if(console.log("ScriptX factory anti-polyfill believes it may not be requred."),this[n]!=i&&console.log("this["+n+"] is defined"),document.getElementById(n)!=null&&console.log("document.getElementById("+n+") is defined"),this[n].object!=i){console.log("this["+n+"].object is defined -- not required!!!");return}console.log("this["+n+"].object is *not* defined")}console.log("ScriptX factory anti-polyfill believes it is requred.");var r=t();this[n]=r})("factory",function(){function n(n){console.log("factory anti-polyfill :: "+n)}var r="1.4.9.0",t="8.0.0.0",i=this;return i.extendFactoryNamespace=function(t,i){var o=i(),e,u,f,r;for(n("MeadCo factory extending namespace: "+t),e=t.split("."),u=this,f=0;f<e.length;f++)r=e[f],f===e.length-1?typeof u[r]=="undefined"?(n("installing implementation at: "+r),u[r]=o):n("Warning - not overwriting package: "+r):typeof u[r]=="undefined"?(n("initialising new: "+r),u[r]={}):n("using existing package: "+r),u=u[r]},n("'factory' loaded."),{log:n,GetComponentVersion:function(u,f,e,o,s){n("factory.object.getcomponentversion: "+u);var h=t;switch(u.toLowerCase()){case"scriptx.factory":h=t;break;case"scriptx.factory.cloud":h=r;break;case"meadco.secmgr":try{h=i.secmgr.version}catch(c){}break;case"meadco.triprint":try{h=MeadCo.ScriptX.Print.HTML.version}catch(c){}}h=h.split(".");f[0]=h[0];e[0]=h[1];o[0]=h[2];s[0]=h[3]},get ScriptXVersion(){return t},get SecurityManagerVersion(){return t},baseURL:function(){return window.location.href.substring(0,window.location.href.length-window.location.pathname.length)},relativeURL:function(){throw"MeadCo.ScriptX.Print :: relativeUrl is not implemented yet.";}}}),function(n,t){typeof extendFactoryNamespace=="function"&&extendFactoryNamespace(n,t)}("factory.printing",function(){function u(t,i,r){typeof t=="undefined"&&(t=!0);var u=n.ensureSpoolingStatus();if(t){if(MeadCo.ScriptX.Print.UI)return MeadCo.ScriptX.Print.UI.PrinterSettings(function(t){t?(MeadCo.log("promptAndPrint requesting print ..."),r(i())):r(!1);n.freeSpoolStatus(u)}),MeadCo.log("promptAndPrint exits ..."),!0;console.warn("prompted print requested but no UI library loaded")}return r(i()),n.freeSpoolStatus(u),!0}function f(n,t,f,e,o){var h="",c,s;return n.indexOf("html://")===0?(h=n.substring(7),c="<!doctype",h.substr(0,c.length).toLowerCase()===c&&(h=h.substring(h.indexOf(">")+1))):n.indexOf("://")===-1&&n.indexOf("\\\\")===-1&&(s=r.factory.baseURL(),n=s.substring(s.length-1,s.length)!=="/"?n.substring(0,1)!=="/"?s+"/"+n:s+n:n.substring(0,1)!=="/"?s+n:s+n.substring(1)),u(t,function(){return MeadCo.log("printHtmlContent requesting print ..."),h.length>0?i.printHtml(h,null,e,o):i.printFromUrl(n,null,e,o)},f)}var i=MeadCo.ScriptX.Print.HTML,t=i.settings,n=MeadCo.ScriptX.Print,o=MeadCo.ScriptX.Print.Licensing,r=this,e;return r.factory.log("factory.Printing loaded."),typeof r.print=="function"&&(r.factory.log("overwriting module.print"),r.print=function(){r.factory.log("window.print() called and being handled.");u(!0,function(){return i.printDocument()},function(){})}),e={get allPagesHeader(){return t.extraHeadersAndFooters.allPagesHeader},set allPagesHeader(n){t.extraHeadersAndFooters.allPagesHeader=n},get allPagesFooter(){return t.extraHeadersAndFooters.allPagesFooter},set allPagesFooter(n){t.extraHeadersAndFooters.allPagesFooter=n},get firstPageHeader(){return t.extraHeadersAndFooters.firstPageHeader},set firstPageHeader(n){t.extraHeadersAndFooters.firstPageHeader=n},get firstPageFooter(){return t.extraHeadersAndFooters.firstPageFooter},set firstPageFooter(n){t.extraHeadersAndFooters.firstPageFooter=n},get extraFirstPageFooter(){return t.extraHeadersAndFooters.extraFirstPageFooter},set extraFirstPageFooter(n){t.extraHeadersAndFooters.extraFirstPageFooter=n},get allHeaderHeight(){return t.extraHeadersAndFooters.allHeaderHeight},set allHeaderHeight(n){if(typeof n!="number")throw"Invalid argument";t.extraHeadersAndFooters.allHeaderHeight=n},get allFooterHeight(){return t.extraHeadersAndFooters.allFooterHeight},set allFooterHeight(n){if(typeof n!="number")throw"Invalid argument";t.extraHeadersAndFooters.allFooterHeight=n},get firstHeaderHeight(){return t.extraHeadersAndFooters.firstHeaderHeight},set firstHeaderHeight(n){if(typeof n!="number")throw"Invalid argument";t.extraHeadersAndFooters.firstHeaderHeight=n},get firstFooterHeight(){return t.extraHeadersAndFooters.firstFooterHeight},set firstFooterHeight(n){if(typeof n!="number")throw"Invalid argument";t.extraHeadersAndFooters.firstFooterHeight=n},get extraFirstFooterHeight(){return t.extraHeadersAndFooters.extraFirstFooterHeight},set extraFirstFooterHeight(n){if(typeof n!="number")throw"Invalid argument";t.extraHeadersAndFooters.extraFirstFooterHeight=n},get pageRange(){return t.pageRange},set pageRange(n){t.pageRange=n},get printingPass(){var n="";switch(t.printingPass){case i.PrintingPasses.ALL:n="all";break;case i.PrintingPasses.ODD:n="odd";break;case i.PrintingPasses.EVEN:n="even";break;case i.PrintingPasses.ODDANDEVEN:n="odd&even"}return n},set printingPass(n){var r=i.PrintingPasses.ALL;if(typeof n=="string")switch(n.toLowerCase()){case"odd":r=i.PrintingPasses.ODD;break;case"even":r=i.PrintingPasses.EVEN;break;case"odd&even":r=i.PrintingPasses.ODDANDEVEN}t.printingPass=r}},n.useAttributes(),{set header(n){r.factory.log("set factory.printing.header: "+n);t.header=n},get header(){return t.header},set footer(n){t.footer=n},get footer(){return t.footer},set headerFooterFont(n){t.headerFooterFont=n},get headerFooterFont(){return t.headerFooterFont},set orientation(n){switch(n.toLowerCase()){case"landscape":t.page.orientation=i.PageOrientation.LANDSCAPE;break;case"portrait":t.page.orientation=i.PageOrientation.PORTRAIT}},get orientation(){return t.page.orientation===i.PageOrientation.PORTRAIT?"portrait":"landscape"},set portrait(n){t.page.orientation=n?i.PageOrientation.PORTRAIT:i.PageOrientation.LANDSCAPE},get portrait(){return t.page.orientation===i.PageOrientation.PORTRAIT},set leftMargin(n){t.page.margins.left=n},get leftMargin(){return t.page.margins.left},set topMargin(n){t.page.margins.top=n},get topMargin(){return t.page.margins.top},set bottomMargin(n){t.page.margins.bottom=n},get bottomMargin(){return t.page.margins.bottom},set rightMargin(n){t.page.margins.right=n},get rightMargin(){return t.page.margins.right},set templateURL(){},get templateURL(){return"MeadCo://default"},IsTemplateSupported:function(){return!0},PageSetup:function(t){typeof t=="undefined"&&(console.warn("PageSeup API in ScriptX.Print Service is not synchronous, there is no return value."),t=function(n){console.log("PageSetugDlg: "+n)});MeadCo.ScriptX.Print.UI?MeadCo.ScriptX.Print.UI.PageSetup(t):n.reportFeatureNotImplemented("Page setup dialog")},PrintSetup:function(t){typeof t=="undefined"&&(console.warn("PrintSetup API in ScriptX.Print Service is not synchronous, there is no return value."),t=function(n){console.log("PrintSetugDlg: "+n)});MeadCo.ScriptX.Print.UI?MeadCo.ScriptX.Print.UI.PrinterSettings(t):n.reportFeatureNotImplemented("Print settings dialog")},Preview:function(){n.reportFeatureNotImplemented("Preview")},Print:function(n,t,r){return typeof r=="undefined"&&(r=function(){}),typeof t=="undefined"&&(t=null),u(n,function(){if(t!=null){var n=typeof t=="string"?t:t.id;return i.printFrame(n)}return i.printDocument()},r)},PrintHTML:function(n,t,i){return typeof i=="undefined"&&(i=function(){}),f(n,t,i)},PrintHTMLEx:function(n,t,i,r,u){return typeof u=="undefined"&&(u=function(){}),f(n,t,u,i,r)},set units(n){this.SetMarginMeasure(n)},get units(){return this.GetMarginMeasure()},set paperSize(t){n.deviceSettings.paperSizeName=t},get paperSize(){return n.deviceSettings.paperSizeName},set paperSource(t){n.deviceSettings.paperSourceName=t},get paperSource(){return n.deviceSettings.paperSourceName},set paperSource2(t){n.deviceSettings.paperSourceName=t},get paperSource2(){return n.deviceSettings.paperSourceName},get pageWidth(){return n.deviceSettings.paperPageSize.width},get pageHeight(){return n.deviceSettings.paperPageSize.height},set copies(t){n.deviceSettings.copies=t},get copies(){return n.deviceSettings.copies},set collate(t){n.deviceSettings.collate=t===!0||t===1?i.CollateOptions.TRUE:i.CollateOptions.FALSE},get collate(){return n.deviceSettings.collate===i.CollateOptions.TRUE},set duplex(t){n.deviceSettings.duplex=t},get duplex(){return n.deviceSettings.duplex},set duplex2(t){n.deviceSettings.duplex=t},get duplex2(){return n.deviceSettings.duplex},set onbeforeprint(){n.reportFeatureNotImplemented("onbeforeprint")},set onafterprint(){n.reportFeatureNotImplemented("onafterprint")},set onuserprintpreview(){n.reportFeatureNotImplemented("onuserprintpreview")},get CurrentPrinter(){return n.printerName},set CurrentPrinter(t){n.printerName=t},get currentPrinter(){return n.printerName},set currentPrinter(t){n.printerName=t},get printer(){return n.printerName},set printer(t){n.printerName=t},set printToFileName(){n.reportFeatureNotImplemented("printToFileName")},get printBackground(){return t.printBackgroundColorsAndImages},set printBackground(n){t.printBackgroundColorsAndImages=n},get viewScale(){return t.viewScale},set viewScale(n){t.viewScale=n},set unprintableLeft(t){n.deviceSettings.unprintableMargins.left=t},get unprintableLeft(){return n.deviceSettings.unprintableMargins.left},set unprintableRight(t){n.deviceSettings.unprintableMargins.right=t},get unprintableRight(){return n.deviceSettings.unprintableMargins.right},set unprintableTop(t){n.deviceSettings.unprintableMargins.top=t},get unprintableTop(){return n.deviceSettings.unprintableMargins.top},set unprintableBottom(t){n.deviceSettings.unprintableMargins.bottom=t},get unprintableBottom(){return n.deviceSettings.unprintableMargins.bottom},EnumPrinters:function(t){var i=n.availablePrinterNames;if(i&&i.length!==0){if(t<i.length)return i[t]}else if(t===0)return this.CurrentPrinter;return""},EnumJobs:function(t,i,r){var e=n.queue,u,f=[];for(t=t.toLowerCase(),u=0;u<e.length;u++)e[u].printerName.toLowerCase()===t&&f.push(e[u]);return i<f.length?(r.name=f[i].jobName,f[i].status):0},GetJobsCount:function(t){var r=n.queue,i,u=0;for(t=t.toLowerCase(),i=0;i<r.length;i++)r[i].printerName.toLowerCase()===t&&u++;return u},printerControl:function(t){return{get Forms(){return n.deviceSettingsFor(t).forms},get Bins(){return n.deviceSettingsFor(t).bins},get forms(){return n.deviceSettingsFor(t).forms},get bins(){return n.deviceSettingsFor(t).bins},get name(){return t},get port(){return n.deviceSettingsFor(t).port},get attributes(){return n.deviceSettingsFor(t).attributes},get serverName(){return n.deviceSettingsFor(t).serverName},get shareName(){return n.deviceSettingsFor(t).shareName},get location(){return n.deviceSettingsFor(t).location},get isLocal(){return n.deviceSettingsFor(t).isLocal},get isNetwork(){return n.deviceSettingsFor(t).isNetwork},get isShared(){return n.deviceSettingsFor(t).isShared},get Jobs(){n.reportFeatureNotImplemented("printerControl.Jobs")},Purge:function(){n.reportFeatureNotImplemented("printerControl.Purge()")},Pause:function(){n.reportFeatureNotImplemented("printerControl.Pause()")},Resume:function(){n.reportFeatureNotImplemented("printerControl.Resume()")}}},GetMarginMeasure:function(){return t.page.units===i.PageMarginUnits.INCHES?2:1},SetMarginMeasure:function(n){t.page.units=n===2?i.PageMarginUnits.INCHES:i.PageMarginUnits.MM},SetPrintScale:function(n){t.viewScale=n},IsSpooling:function(){return n.isSpooling()},OwnQueue:function(){},SetPageRange:function(i,r,u){i&&n.reportFeatureNotImplemented("SetPageRange selection only");t.pageRange=""+r+"-"+u},SetPreviewZoom:function(){n.reportFeatureNotImplemented("SetPreviewZoom")},Sleep:function(){n.reportFeatureNotImplemented("Sleep")},TotalPrintPages:function(){n.reportFeatureNotImplemented("TotalPrintPages")},WaitForSpoolingComplete:function(t,i){n.waitForSpoolingComplete(t,i)},enhancedFormatting:e,PolyfillInit:function(){return MeadCo.ScriptX.Print.isConnected},PolyfillInitAsync:function(n,t){MeadCo.ScriptX.Print.isConnected?n():i.connectAsync("","",n,t)}}}),function(n,t){typeof extendFactoryNamespace=="function"&&extendFactoryNamespace(n,t)}("factory.object",function(){var n=this;return n.factory.log("factory.object loaded."),this.factory}),function(n,t){typeof extendFactoryNamespace=="function"&&extendFactoryNamespace(n,t)}("factory.object.js",function(){var n=this;return n.factory.log("factory.object.js loaded."),{FormatNumber:function(n){return isNaN(n)?0:typeof n=="string"?Number(n):n}}});
/*!
 * MeadCo.ScriptX.Print (support for modern browsers and IE 11) JS client library
 * Copyright 2017-2018 Mead & Company. All rights reserved.
 * https://github.com/MeadCo/ScriptX.Print.Client
 *
 * Released under the MIT license
 */
(function(n,t){extendMeadCoNamespace(n,t)})("MeadCo.ScriptX.Print",function(){function p(n){t.push(n);MeadCo.log("ScriptX.Print queueJob, jobCount: "+t.length)}function v(){return MeadCo.log("ScriptX.Print jobCount: "+t.length),t.length}function y(n){for(var r,i=0;i<t.length;i++)if(t[i].jobIdentifier===n.jobIdentifier){r=n.fnNotify;typeof r!="function"&&(n.fnNotify=t[i].fnNotify);typeof n.fnNotify=="function"&&(n.status===h.QUEUEDTOFILE||n.status!==t[i].status)&&n.fnNotify(n);t[i]=n;return}console.warn("Unable to find job: "+n.jobIdentifier+" to update it")}function e(n){for(var i=0;i<t.length;i++)if(t[i].jobIdentifier===n){t.splice(i,1);MeadCo.log("ScriptX.Print remove job, jobCount: "+t.length);return}console.warn("Unable to find job: "+n+" to remove it")}function r(n,t,i){typeof n.OnProgress=="function"&&n.OnProgress(t,i,n.UserData)}function it(t,u,e,s,h,c,l){var v,a;return MeadCo.log("started MeadCo.ScriptX.Print.print.printHtmlAtServer() Type: "+t+", printerName: "+i),t===nt.URL&&MeadCo.log(".. request print url: "+u),v=i===""?{}:o[i],a={ContentType:t,Content:u,Settings:e,Device:v,OnProgress:c,UserData:l},et(a,{fail:function(t,i,u){r(a,n.ERROR,u);MeadCo.ScriptX.Print.reportServerError(u);typeof s=="function"&&s(t)},queuedToFile:function(t){MeadCo.log("default handler on queued to file response");r(a,n.QUEUED);typeof h=="function"&&(t.fnNotify=h,y(t));tt(a,t.jobIdentifier,-1,function(t){t!=null&&(MeadCo.log("Will download printed file"),r(a,n.COMPLETED),window.open(f+"/download/"+t.jobIdentifier,"_self"));typeof s=="function"&&s(t!=null?"Server error":null)})},queuedToDevice:function(t){r(a,n.QUEUED);MeadCo.log("print was queued to device");typeof h=="function"&&(t.fnNotify=h,y(t));tt(a,t.jobIdentifier,-1,function(t){t!=null&&r(a,n.COMPLETED);typeof s=="function"&&s(t!=null?"Server error":null)})},softError:function(){r(a,n.ERROR);MeadCo.log("print has soft error")},ok:function(t){r(a,n.COMPLETED);MeadCo.log("printed ok, no further information");typeof h=="function"&&(t.fnNotify=h,y(t));typeof s=="function"&&s(null)}})}function w(n,t){n.length>0&&(MeadCo.log("Print server requested: "+n+" => "+MeadCo.makeApiEndPoint(n,d)+" with license: "+t),f=MeadCo.makeApiEndPoint(n,d),c=t)}function rt(n,t){w(n,t);a({name:"default",async:!1})}function ut(n,t,i,r){w(n,t);a({name:"default",done:i,async:!0,fail:r})}function ft(n,t,i){var r,f;n.length>0&&(r="v1/licensing",MeadCo.log("Test server requested: "+n+" => "+MeadCo.makeApiEndPoint(n,r)),n=MeadCo.makeApiEndPoint(n,r),u.jQuery&&(f=n+"/ping",MeadCo.log(".ajax() get: "+f),u.jQuery.ajax(f,{method:"GET",dataType:"json",cache:!1,async:!0}).done(function(n){t(n)}).fail(function(n,t,r){MeadCo.log("**warning: failure in MeadCo.ScriptX.Print.testServerConnection: ["+t+"], ["+r+"], ["+n.responseText+"]");typeof n.responseText!="undefined"&&(r=n.responseText);r===""&&(r="Unknown server or network error");typeof i=="function"&&i(r)})))}function et(n,t){if(f.length<=0)throw new Error("MeadCo.ScriptX.Print : print server URL is not set or is invalid");var i={jobIdentifier:Date.now(),printerName:n.Device.printerName,jobName:"Job starting"};if(u.jQuery)return MeadCo.log(".ajax() post to: "+f),MeadCo.log(JSON.stringify(n)),p(i),u.jQuery.ajax(f+"/print",{data:JSON.stringify(n),dataType:"json",contentType:"application/json",method:"POST",headers:{Authorization:"Basic "+btoa(c+":")}}).done(function(r){MeadCo.log("Success response: "+r.status);r.printerName=n.Device.printerName;r.jobName=n.Settings.jobTitle;p(r);e(i.jobIdentifier);switch(r.status){case h.QUEUEDTOFILE:t.queuedToFile(r);break;case h.QUEUEDTODEVICE:t.queuedToDevice(r);break;case h.SOFTERROR:t.softError(r);break;case h.OK:t.ok(r)}}).fail(function(n,r,u){MeadCo.log("Fail response from server: ["+r+"], ["+u+"], ["+n.responseText+"]");e(i.jobIdentifier);typeof n.responseText!="undefined"&&(u=n.responseText);u===""&&(u="Unknown server or network error");typeof t.fail=="function"&&t.fail(n,r,u)}),!0;throw new Error("MeadCo.ScriptX.Print : no known ajax helper available");}function ot(n,t,i,r){if(u.jQuery){var e=f+n;MeadCo.log(".ajax() get: "+e);u.jQuery.ajax(e,{method:"GET",dataType:"json",cache:!1,async:t,headers:{Authorization:"Basic "+btoa(c+":")}}).done(function(n){l=!0;i(n)}).fail(function(n,t,i){MeadCo.log("**warning: failure in MeadCo.ScriptX.Print.getFromServer: ["+t+"], ["+i+"], ["+n.responseText+"]");typeof n.responseText!="undefined"&&(i=n.responseText);i===""&&(i="Unknown server or network error");typeof r=="function"&&r(i)})}}function tt(t,i,u,o){MeadCo.log("monitorJob: "+i);var a=0,l=1e3,h=!1,s=window.setInterval(function(){h?MeadCo.log("** info : still waiting for last status request to complete"):(MeadCo.log("Going to request status with .ajax"),h=!0,$.ajax(f+"/status/"+i,{dataType:"json",method:"GET",cache:!1,headers:{Authorization:"Basic "+btoa(c+":")}}).done(function(f){MeadCo.log("jobStatus: "+f.status);switch(f.status){case n.COMPLETED:MeadCo.log("clear interval: "+s);window.clearInterval(s);e(i);o(f);break;case n.NOTSTARTED:case n.DOWNLOADED:case n.DOWNLOADING:case n.PRINTING:case n.QUEUED:case n.STARTING:case n.PAUSED:r(t,f.status,f.message);y(f);u>0&&++a*l>u&&(window.clearInterval(s),MeadCo.ScriptX.Print.reportServerError("unknown failure while printing."));h=!1;break;case n.ERROR:case n.ABANDONED:MeadCo.log("error status in monitorJob so clear interval: "+s);r(t,f.status,f.message);e(i);window.clearInterval(s);MeadCo.ScriptX.Print.reportServerError("The print failed.\n\n"+f.message);o(null);break;default:r(t,f.status,f.message);MeadCo.log("unknown status in monitorJob so clear interval: "+s);e(i);window.clearInterval(s);o(null)}}).fail(function(u,f,h){MeadCo.log("**warning: failure in MeadCo.ScriptX.Print.monitorJob: ["+f+"], ["+h+"], ["+u.responseText+"]");typeof u.responseText!="undefined"&&(h=u.responseText);h===""&&(h="Unknown server or network error");MeadCo.log("error: "+h+" in monitorJob so clear interval: "+s);r(t,n.ERROR,h);e(i);window.clearInterval(s);o(null)}))},l);MeadCo.log("intervalId: "+s)}function b(n){o[n.printerName]=n;n.isDefault&&i.length===0&&(i=n.printerName)}function a(n){if(n.name=n.name.replace(/\\/g,"||"),MeadCo.log("Request get device info: "+n.name),u.jQuery){var t=f+"/deviceinfo/"+encodeURIComponent(n.name)+"/0";MeadCo.log(".ajax() get: "+t);u.jQuery.ajax(t,{dataType:"json",method:"GET",cache:!1,async:n.async,headers:{Authorization:"Basic "+btoa(c+":")}}).done(function(t){l=!0;b(t);typeof n.done=="function"&&n.done(t)}).fail(function(t,i,r){r===""?r=t.responseText:(l=!0,r=r.toString());MeadCo.log("failed to getdevice: "+r);typeof n.fail=="function"&&n.fail(r)})}else if(typeof n.fail=="function")n.fail("MeadCo.ScriptX.Print : no known ajax helper available");else throw new Error("MeadCo.ScriptX.Print : no known ajax helper available");}function st(n){return typeof n=="string"&&n!=""?(typeof o[n]=="undefined"&&a({name:n,async:!1,fail:function(n){MeadCo.ScriptX.Print.reportServerError(n)}}),o[n]):{}}function ht(){if(MeadCo.log("MeadCo.ScriptX.Print ... looking for auto connect: "+s),this.jQuery&&!s){var t=MeadCo.ScriptX.Print.HTML,i=MeadCo.ScriptX.Print,n=MeadCo.ScriptX.Print.Licensing;$("[data-meadco-subscription]").each(function(){var f,r,e,u;return typeof i=="undefined"||typeof t=="undefined"?console.error("Unable to auto-connect subscription - print or printHtml API not present"):s||(f=$(this),r=f.data(),MeadCo.log("Auto connect susbcription to: "+r.meadcoServer+", or "+r.meadcoPrinthtmlserver+", with subscription: "+r.meadcoSubscription+", sync: "+r.meadcoSyncinit),e=(""+r.meadcoSyncinit).toLowerCase()!=="false",u=r.meadcoServer,typeof u=="undefined"&&(u=r.meadcoPrinthtmlserver),typeof u=="undefined"?console.error("No server specified"):(typeof n!="undefined"&&n.connect(u,r.meadcoSubscription),e?(console.warn("Synchronous connection is deprecated, please use data-meadco-syncinit='false'"),t.connect(u,r.meadcoSubscription)):(MeadCo.log("Async connectlite..."),i.connectLite(u,r.meadcoSubscription)),s=!0)),!1});$("[data-meadco-license]").each(function(){var f,r,e,u;return typeof i=="undefined"||typeof t=="undefined"||typeof n=="undefined"?console.error("Unable to auto-connect client license - print or printHtml or license API not present"):s||(f=$(this),r=f.data(),MeadCo.log("Auto connect client license to: "+r.meadcoServer+", with license: "+r.meadcoLicense+", path: "+r.meadcoLicensePath+", revision: "+r.meadcoLicenseRevision+", sync: "+r.meadcoSyncinit),e=(""+r.meadcoSyncinit).toLowerCase()!=="false",u=r.meadcoServer,e?(console.warn("Synchronous connection is deprecated, please use data-meadco-syncinit='false'"),n.connect(u,r.meadcoLicense),typeof r.meadcoLicensePath!="undefined"&&typeof r.meadcoLicenseRevision!="undefined"&&n.apply(r.meadcoLicense,r.meadcoLicenseRevision,r.meadcoLicensePath),t.connect(u,r.meadcoLicense)):(MeadCo.log("Async connectlite..."),n.connectLite(u,r.meadcoLicense,r.meadcoLicenseRevision,r.meadcoLicensePath),i.connectLite(u,r.meadcoLicense)),s=!0),!1})}}var k="1.4.9.0",d="v1/printHtml",i="",o={},u=this,t=[],f="",c="",l=!1,s=!1,g=[],nt={URL:1,HTML:2,INNERTHTML:4},h={QUEUEDTODEVICE:1,QUEUEDTOFILE:2,SOFTERROR:3,OK:4},n={NOTSTARTED:0,QUEUED:1,STARTING:2,DOWNLOADING:3,DOWNLOADED:4,PRINTING:5,COMPLETED:6,PAUSED:7,PRINTPDF:8,ERROR:-1,ABANDONED:-2};return u.jQuery||MeadCo.log("**** warning :: no jQuery"),MeadCo.log("MeadCo.ScriptX.Print "+k+" loaded."),{ContentType:nt,ResponseType:h,get printerName(){return i},set printerName(n){n===i||n.name===i||(typeof n=="string"?typeof o[n]=="undefined"?a({name:n,done:function(n){i=n.printerName},async:!1,fail:function(n){MeadCo.ScriptX.Print.reportServerError(n)}}):i=n:a(n))},get version(){return k},set deviceSettings(n){b(n)},get deviceSettings(){return i!==""?o[i]:{}},deviceSettingsFor:function(n){return st(n)},useAttributes:function(){ht()},connect:function(n,t){rt(n,t)},connectLite:function(n,t){arguments.length===2&&n.length>0&&t.length>0&&w(n,t)},connectAsync:function(n,t,i,r){ut(n,t,i,r)},connectTestAsync:function(n,t,i){ft(n,t,i)},connectDeviceAndPrinters:function(n,t){l=!0;b(n);g=t},get isConnected(){return l},get availablePrinterNames(){return g},getFromServer:ot,printHtml:it,reportServerError:function(n){alert("There was an error in the printing service\n\n"+n)},reportFeatureNotImplemented:function(n){MeadCo.log("Call to not implemented: "+n);alert(n+"\n\nis not available.")},get queue(){return t},get activeJobs(){return v()},ensureSpoolingStatus:function(){var n={jobIdentifier:Date.now()};return p(n),n},freeSpoolStatus:function(n){e(n.jobIdentifier)},isSpooling:function(){return v()>0},waitForSpoolingComplete:function(n,t){if(MeadCo.log("Started WaitForSpoolingComplete("+n+")"),typeof t!="function")throw"WaitForSpoolingComplete requires a completion callback";var r=Date.now(),i=window.setInterval(function(){v()===0?(MeadCo.log("WaitForSpoolingComplete - complete"),window.clearInterval(i),t(!0)):n>=0&&Date.now()-r>n&&(MeadCo.log("WaitForSpoolingComplete - timeout"),window.clearInterval(i),t(v()===0))},250)}}});
/*!
 * MeadCo.ScriptX.Print.HTML (support for modern browsers and IE 11) JS client library
 * Copyright 2017 Mead & Company. All rights reserved.
 * https://github.com/MeadCo/ScriptX.Print.Client
 *
 * Released under the MIT license
 */
(function(n,t){extendMeadCoNamespace(n,t)})("MeadCo.ScriptX.Print.HTML",function(){function e(t){n=t;n.locale=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language;n.timezoneOffset=(new Date).getTimezoneOffset();n.documentUrl=document.URL;MeadCo.log("Settings cache updated, .locale: ["+n.locale+"], .offset: "+n.timezoneOffset)}function c(n){$(":checked",n).each(function(){this.setAttribute("checked","checked")});$("input[type='text']",n).each(function(){this.setAttribute("value",$(this).val())});$("select",n).each(function(){var n=$(this);$("option",n).each(function(){n.val()==$(this).val()&&this.setAttribute("selected","selected")})});$("textarea",n).each(function(){var n=$(this).attr("value");$.browser.mozilla&&this.firstChild?this.firstChild.textContent=n:this.innerHTML=n})}function o(){var n=window.location.port?":"+window.location.port:"";return window.location.protocol+"//"+window.location.hostname+n+window.location.pathname}function s(n){if(c(n),$("script",n).remove(),$("object",n).remove(),!$("head>base",n).length){MeadCo.log("No base element, fabricating one to: "+o());var t=$("<base>",{href:o()});$("head",n).prepend(t)}return n.html()}function l(){return s($("html"))}function a(){if(this.jQuery)return l();throw new Error("No supported html snapshot helper available (jQuery is required)");}function v(n){if(this.jQuery){var t=$("#"+n);if(!t.length)throw new Error("Unabled to print frame - frame does not exist");return s(t.contents().find("html"))}throw new Error("No supported framed html snapshot helper available (jQuery is required)");}function i(t,i,r,u,f,e){var o=n;return o.jobTitle=r,MeadCo.ScriptX.Print.printHtml(t,i,o,u,null,f,e)}var r="1.4.9.0",u={DEFAULT:0,LANDSCAPE:1,PORTRAIT:2},f={DEFAULT:0,INCHES:1,MM:2},t={ALL:1,ODD:2,EVEN:3,ODDANDEVEN:4},n={header:null,footer:null,headerFooterFont:null,viewScale:0,locale:navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language,timezoneOffset:0,shortDateFormat:"",longDateFormat:"",printBackgroundColorsAndImages:!1,page:{orientation:u.PORTRAIT,units:f.DEFAULT,margins:{left:"",top:"",bottom:"",right:""}},extraHeadersAndFooters:{},pageRange:"",printingPass:t.ALL,jobTitle:"",documentUrl:document.URL},h={set header(t){MeadCo.log("MeadCo.ScriptX.Print.HTML setting header: "+t);t.length===0&&(t="%20");n.header=t},get header(){return n.header},set footer(t){t.length===0&&(t="%20");n.footer=t},get footer(){return n.footer},set headerFooterFont(t){t.length===0&&(t="%20");n.headerFooterFont=t},get headerFooterFont(){return n.headerFooterFont},set viewScale(t){n.viewScale=t},get viewScale(){return n.viewScale},set locale(t){n.locale=t},set shortDateFormat(t){n.longDateFormat=t},set longDateFormat(t){n.longDateFormat=t},set printBackgroundColorsAndImages(t){n.printBackgroundColorsAndImages=t},get printBackgroundColorsAndImages(){return n.printBackgroundColorsAndImages},extraHeadersAndFooters:{get allPagesHeader(){return n.extraHeadersAndFooters.allPagesHeader},set allPagesHeader(t){n.extraHeadersAndFooters.allPagesHeader=t},get allPagesFooter(){return n.extraHeadersAndFooters.allPagesFooter},set allPagesFooter(t){n.extraHeadersAndFooters.allPagesFooter=t},get firstPageHeader(){return n.extraHeadersAndFooters.firstPageHeader},set firstPageHeader(t){n.extraHeadersAndFooters.firstPageHeader=t},get firstPageFooter(){return n.extraHeadersAndFooters.firstPageFooter},set firstPageFooter(t){n.extraHeadersAndFooters.firstPageFooter=t},get extraFirstPageFooter(){return n.extraHeadersAndFooters.extraFirstPageFooter},set extraFirstPageFooter(t){n.extraHeadersAndFooters.extraFirstPageFooter=t},get allHeaderHeight(){return n.extraHeadersAndFooters.allHeaderHeight},set allHeaderHeight(t){if(typeof t!="number")throw"Invalid argument";n.extraHeadersAndFooters.allHeaderHeight=t},get allFooterHeight(){return n.extraHeadersAndFooters.allFooterHeight},set allFooterHeight(t){if(typeof t!="number")throw"Invalid argument";n.extraHeadersAndFooters.allFooterHeight=t},get firstHeaderHeight(){return n.extraHeadersAndFooters.firstHeaderHeight},set firstHeaderHeight(t){if(typeof t!="number")throw"Invalid argument";n.extraHeadersAndFooters.firstHeaderHeight=t},get firstFooterHeight(){return n.extraHeadersAndFooters.firstFooterHeight},set firstFooterHeight(t){if(typeof t!="number")throw"Invalid argument";n.extraHeadersAndFooters.firstFooterHeight=t},get extraFirstFooterHeight(){return n.extraHeadersAndFooters.extraFirstFooterHeight},set extraFirstFooterHeight(t){if(typeof t!="number")throw"Invalid argument";n.extraHeadersAndFooters.extraFirstFooterHeight=t}},page:{set orientation(t){n.page.orientation=t},get orientation(){return n.page.orientation},set units(t){n.page.units=t},get units(){return n.page.units},margins:{set left(t){n.page.margins.left=t},get left(){return n.page.margins.left},set top(t){n.page.margins.top=t},get top(){return n.page.margins.top},set bottom(t){n.page.margins.bottom=t},get bottom(){return n.page.margins.bottom},set right(t){n.page.margins.right=t},get right(){return n.page.margins.right}}},get pageRange(){return n.pageRange},set pageRange(t){n.pageRange=t},get printingPass(){return n.printingPass},set printingPass(i){if(typeof i=="number"&&i>=t.ALL&&i<=t.ODDANDEVEN){n.printingPass=i;return}throw"Invalid argument";}};return MeadCo.log("MeadCo.ScriptX.Print.HTML "+r+" loaded."),this.jQuery||MeadCo.log("**** warning :: no jQuery"),{PageMarginUnits:f,PageOrientation:u,CollateOptions:{DEFAULT:0,TRUE:1,FALSE:2},PrintingPasses:t,settings:h,printDocument:function(n,t,r){return i(MeadCo.ScriptX.Print.ContentType.INNERTHTML,a(),document.title,n,t,r)},printFrame:function(n,t,r,u){return i(MeadCo.ScriptX.Print.ContentType.INNERTHTML,v(n),document.title,t,r,u)},printFromUrl:function(n,t,r,u){return i(MeadCo.ScriptX.Print.ContentType.URL,n,n,t,r,u)},printHtml:function(n,t,r,u){return i(MeadCo.ScriptX.Print.ContentType.HTML,n,"HTML snippet",t,r,u)},connectLite:function(n,t){MeadCo.ScriptX.Print.connectLite(n,t)},connect:function(t,i){MeadCo.warn("Print.HTML SYNC connection request");MeadCo.ScriptX.Print.connectLite(t,i);MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+n.page.units,!1,function(n){MeadCo.log("got default html settings");e(n.settings);n.device!=null&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(n.device,n.availablePrinters)})},connectAsync:function(t,i,r,u){MeadCo.log("Print.HTML ASYNC connection request");MeadCo.ScriptX.Print.connectLite(t,i);MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+n.page.units,!0,function(n){MeadCo.log("got default html settings");e(n.settings);n.device!=null&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(n.device,n.availablePrinters);r()},u)},get version(){return r}}}),function(n,t){"use strict";function o(){u();var n=t("#dlg-printersettings"),i=MeadCo.ScriptX.Printing;n.find("#fld-collate").prop("checked",i.collate);n.find("#fld-copies").val(i.copies)}function s(){var n=t("#dlg-printoptions"),i=MeadCo.ScriptX.Print.HTML.settings;n.length&&(i.page.orientation=n.find('[name="fld-orientation"]:checked').val(),i.printBackgroundColorsAndImages=n.find("#fld-printbackground").prop("checked"),i.viewScale=n.find("#fld-shrinktofit").prop("checked")?-1:100,i.page.units=parseInt(n.find('[name="fld-measure"]:checked').val()),i.page.margins.left=n.find("#fld-marginL").val(),i.page.margins.top=n.find("#fld-marginT").val(),i.page.margins.right=n.find("#fld-marginR").val(),i.page.margins.bottom=n.find("#fld-marginB").val(),i.header=n.find("#fld-header").val(),i.footer=n.find("#fld-footer").val(),MeadCo.ScriptX.Printing.paperSize=t("#fld-papersize").val())}function h(){var i=t("#dlg-printersettings"),r=MeadCo.ScriptX.Print.HTML,n=MeadCo.ScriptX.Printing,u=MeadCo.ScriptX.Print.HTML.settings;i.length&&(n.currentPrinter=t("#fld-printerselect").val(),n.paperSource=t("#fld-papersource").val(),n.collate=i.find("#fld-collate").prop("checked"),n.copies=i.find("#fld-copies").val())}function c(){var r=MeadCo.ScriptX.Printing,n=t("#fld-printerselect"),u,i;for(t("#fld-printerselect > option").remove(),i=0;(u=r.EnumPrinters(i)).length>0;i++)n.append("<option>"+u);n.val(r.currentPrinter);n.hasClass("selectpicker")&&n.selectpicker("refresh")}function l(n){var t=MeadCo.ScriptX.Printing,r=t.currentPrinter,f=t.paperSource;try{t.currentPrinter=n;u()}catch(i){alert("Sorry, an error has occurred:\n\n"+i.description)}try{t.currentPrinter=r;t.paperSource=f}catch(i){alert("Sorry, an error has occurred restoring current printer settings:\n\n"+i.description)}}function u(){var r=MeadCo.ScriptX.Printing,u=r.printerControl(r.CurrentPrinter).Bins,n=t("#fld-papersource"),i;for(t("#fld-papersource > option").remove(),i=0;i<u.length;i++)n.append("<option>"+u[i]);n.val(r.paperSource);n.hasClass("selectpicker")&&n.selectpicker("refresh")}function f(n){n.val((parseFloat(n.val())*2540/100).toFixed(2))}function e(n){n.val((parseFloat(n.val())*100/2540).toFixed(2))}var r="",i;t.fn.selectpicker&&(r="selectpicker");i=MeadCo.createNS("MeadCo.ScriptX.Print.UI");i.moduleversion="1.4.9.0";i.AttachPrintAction=function(n){console.log("starting PrintUI.AttachPrintAction");var i=t(n);i.click(function(){var n=t(this);switch(n.data("action")){case"remote":MeadCo.ScriptX.Print.HTML.printFromUrl(n.data("url"))}})};console.log("Autostart meadco.PrintUI ...");t("[data-meadco-ui='print']").each(function(){i.AttachPrintAction(this)});i.PageSetup=function(){var h,n,i,u,o,c;if(!t("#dlg-printoptions").length){h='<style>.modal-dialog legend { font-size: 1.2em; font-weight: bold; margin-bottom: 10px; } .modal-dialog fieldset { padding-bottom: 0px; } .modal-dialog .options-modal-body { padding-bottom: 0px !important; } .modal-dialog .checkbox2 {  padding-top: 0px !important; min-height: 0px !important; } .modal-dialog .radio2 { padding-top: 0px !important; min-height: 0px !important; } <\/style><div class="modal fade" id="dlg-printoptions"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;<\/button><h4 class="modal-title">Page setup<\/h4><\/div><div class="modal-body form-horizontal options-modal-body"><fieldset><legend>Paper<\/legend><div class="form-group"><label class="col-md-4 control-label" for="fld-papersize">Size<\/label><select class="'+r+' col-md-8 show-tick show-menu-arrow" id="fld-papersize"><\/select><\/div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="radio2"><label class="radio-inline"><input type="radio" value="2" id="fld-portrait" name="fld-orientation"> Portrait<\/label><label class="radio-inline"><input type="radio" value="1" id="fld-landscape" name="fld-orientation"> Landscape<\/label><\/div><\/div><\/div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-shrinktofit" id="fld-shrinktofit"> Shrink to fit<\/label><\/div><\/div><\/div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-printbackground" id="fld-printbackground"> Print background colour and images<\/label><\/div><\/div><\/div><\/fieldset><fieldset><legend>Margins<\/legend><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="radio2"><label class="radio-inline"><input type="radio" value="2" id="fld-millimetres" name="fld-measure"> Millimetres<\/label><label class="radio-inline"><input type="radio" value="1" id="fld-inches" name="fld-measure"> Inches<\/label><\/div><\/div><\/div><div class="form-group"><label class="control-label col-md-4">Left<\/label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginL" id="fld-marginL" type="text" class="form-control text-right" data-rule="currency" value="1" /><span class="input-group-addon"><a class="spin-up" href="javascript:;" data-spin="up"><i class="fa fa-caret-up"><\/i><\/a><a class="spin-down" href="javascript:;" data-spin="down"><i class="fa fa-caret-down"><\/i><\/a><\/span><\/div><\/div><label class="control-label col-md-2">Top<\/label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginT" id="fld-marginT" type="text" class="form-control text-right" data-rule="currency" value="1" /><span class="input-group-addon"><a class="spin-up" href="javascript:;" data-spin="up"><i class="fa fa-caret-up"><\/i><\/a><a class="spin-down" href="javascript:;" data-spin="down"><i class="fa fa-caret-down"><\/i><\/a><\/span><\/div><\/div><\/div><div class="form-group"><label class="control-label col-md-4">Right<\/label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginR" id="fld-marginR" type="text" class="form-control text-right" data-rule="currency" value="1" /><span class="input-group-addon"><a class="spin-up" href="javascript:;" data-spin="up"><i class="fa fa-caret-up"><\/i><\/a><a class="spin-down" href="javascript:;" data-spin="down"><i class="fa fa-caret-down"><\/i><\/a><\/span><\/div><\/div><label class="control-label col-md-2">Bottom<\/label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginB" id="fld-marginB" type="text" class="form-control text-right" data-rule="currency" value="1" /><span class="input-group-addon"><a class="spin-up" href="javascript:;" data-spin="up"><i class="fa fa-caret-up"><\/i><\/a><a class="spin-down" href="javascript:;" data-spin="down"><i class="fa fa-caret-down"><\/i><\/a><\/span><\/div><\/div><\/div><\/fieldset><fieldset><legend>Headers and footers<\/legend><div class="form-group"><label class="control-label col-md-4">Header<\/label><div class="col-md-8"><input type="text" name="fld-header" id="fld-header" class="form-control" style="max-width: none !important;" /><\/div><\/div><div class="form-group"><label class="control-label col-md-4">Footer<\/label><div class="col-md-8"><input type="text" name="fld-footer" id="fld-footer" class="form-control" style="max-width: none !important;" /><\/div><\/div><\/fieldset><\/div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-saveoptions">OK<\/button><button type="button" class="btn btn-default" data-dismiss="modal">Cancel<\/button><\/div><\/div><!-- /.modal-content --><\/div><!-- /.modal-dialog --><\/div><!-- /.modal -->';t("body").append(h);t("#btn-saveoptions").click(function(n){n.preventDefault();s();t("#dlg-printoptions").modal("hide")});t('[name="fld-measure"]').on("change",function(){switch(t(this).val()){case"2":t("#dlg-printoptions input[type=text][data-rule=currency]").each(function(){f(t(this))});break;case"1":t("#dlg-printoptions input[type=text][data-rule=currency]").each(function(){e(t(this))})}});t.fn.spinner&&t('#dlg-printoptions [data-trigger="spinner"]').spinner()}n=t("#dlg-printoptions");i=MeadCo.ScriptX.Print.HTML.settings;n.find('[name="fld-orientation"]').val([i.page.orientation]);n.find("#fld-printbackground").prop("checked",i.printBackgroundColorsAndImages);n.find("#fld-shrinktofit").prop("checked",i.viewScale==-1);n.find('[name="fld-measure"]').val([i.page.units]);n.find("#fld-marginL").val(i.page.margins.left);n.find("#fld-marginT").val(i.page.margins.top);n.find("#fld-marginR").val(i.page.margins.right);n.find("#fld-marginB").val(i.page.margins.bottom);n.find("#fld-header").val(i.header);n.find("#fld-footer").val(i.footer);u=t("#fld-papersize");o=MeadCo.ScriptX.Printing.printerControl(MeadCo.ScriptX.Printing.currentPrinter);t("#fld-papersize > option").remove();for(c in o.Forms)u.append("<option>"+o.Forms[c]+"<\/option>");u.hasClass("selectpicker")&&u.selectpicker("refresh");u.val(MeadCo.ScriptX.Printing.paperSize);n.modal("show");u.hasClass("selectpicker")&&u.selectpicker("refresh")};i.PrinterSettings=function(n){if(!t("#dlg-printersettings").length){var i='<style>.modal-dialog legend { font-size: 1.2em; font-weight: bold; margin-bottom: 10px; } .modal-dialog fieldset { padding-bottom: 0px; } .modal-dialog .options-modal-body { padding-bottom: 0px !important; } .modal-dialog .checkbox2 {  padding-top: 0px !important; min-height: 0px !important; } .modal-dialog .radio2 { padding-top: 0px !important; min-height: 0px !important; } <\/style><div class="modal fade" id="dlg-printersettings"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;<\/button><h4 class="modal-title">Print<\/h4><\/div><div class="modal-body form-horizontal options-modal-body"><div class="form-group"><label class="col-md-4 control-label" for="fld-printerselect">Printer<\/label><select class="'+r+' col-md-8 show-tick show-menu-arrow" id="fld-printerselect"><\/select><\/div><div class="form-group"><label class="col-md-4 control-label" for="fld-papersource">Paper source<\/label><select class="'+r+' col-md-8 show-tick show-menu-arrow" id="fld-papersource"><\/select><\/div><div class="form-group"><label class="control-label col-md-4">Copies<\/label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-copies" id="fld-copies" type="text" class="form-control text-right" data-rule="quantity" value="1" /><span class="input-group-addon"><a class="spin-up" href="javascript:;" data-spin="up"><i class="fa fa-caret-up"><\/i><\/a><a class="spin-down" href="javascript:;" data-spin="down"><i class="fa fa-caret-down"><\/i><\/a><\/span><\/div><\/div><div class="col-md-5"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-collate" id="fld-collate"> Collate<\/label><\/div><\/div><\/div><\/div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-savesettings">Print<\/button><button type="button" class="btn btn-default" data-dismiss="modal">Cancel<\/button><\/div><\/div><!-- /.modal-content --><\/div><!-- /.modal-dialog --><\/div><!-- /.modal -->';t("body").append(i);t('[name="fld-measure"]').on("change",function(){switch(t(this).val()){case"2":t("#dlg-printersettings input[type=text][data-rule=currency]").each(function(){f(t(this))});break;case"1":t("#dlg-printersettings input[type=text][data-rule=currency]").each(function(){e(t(this))})}});t.fn.spinner&&t('#dlg-printersettings [data-trigger="spinner"]').spinner();t("#dlg-printersettings #fld-printerselect").change(function(){l(t(this).val())})}t("#btn-savesettings").off("click").on("click",function(i){i.preventDefault();h();t("#dlg-printersettings").modal("hide");typeof n=="function"&&n(!0)});t("#dlg-printersettings").off("hidden.bs.modal").on("hidden.bs.modal",function(){typeof n=="function"&&n(!1)});c();o();t("#dlg-printersettings").modal("show");r==="selectpicker"&&t("#dlg-printersettings .selectpicker").selectpicker("refresh")}}(window.MeadCo=window.MeadCo||{},jQuery);
/*!
 * MeadCo ScriptX 'window.secmgr' shim (support for modern browsers and IE 11) JS client library
 * Copyright 2017 Mead & Company. All rights reserved.
 * https://github.com/MeadCo/ScriptX.Print.Client
 *
 * Released under the MIT license
 */
(function(n,t,i){if(this[n]!=i||document.getElementById(n)!=null){if(console.log("MeadCo security manager anti-polyfill believes it may not be requred."),this[n]!=i&&console.log("this["+n+"] is defined"),document.getElementById(n)!=null&&console.log("document.getElementById("+n+") is defined"),this[n].object!=i){console.log("this["+n+"].object is defined -- not required!!!");return}console.log("this["+n+"].object is *not* defined")}var r=t();this[n]=r})("secmgr",function(){function t(n){console.log("secmgr anti-polyfill :: "+n)}var r="1.4.9.0",u=this,i=MeadCo.ScriptX.Print,n=MeadCo.ScriptX.Print.Licensing;return u.extendSecMgrNamespace=function(n,i){var o=i(),e,u,f,r;for(t("MeadCo security manager extending namespace2: "+n),e=n.split("."),u=this,f=0;f<e.length;f++)r=e[f],f===e.length-1?typeof u[r]=="undefined"?(t("installing implementation at: "+r),u[r]=o):t("Warning - not overwriting package: "+r):typeof u[r]=="undefined"?(t("initialising new: "+r),u[r]={}):t("using existing package: "+r),u=u[r]},t("'secmgr' loaded."),(typeof n=="undefined"||n===null)&&console.error("MeadCo.ScriptX.Print.Licensing not available"),typeof i=="undefined"||i===null?console.error("MeadCo.ScriptX.Print not available"):i.useAttributes(),{log:t,get version(){return r},get result(){return n.result},get validLicense(){return n.validLicense},get License(){return n.License},GetLicenseAsync:function(t,i){n.GetLicenseAsync(t,i)},PolyfillInit:function(){return n.PolyfillInit()},PolyfillInitAsync:function(t,i){n.PolyfillInitAsync(t,i)}}}),function(n,t){typeof extendSecMgrNamespace=="function"&&extendSecMgrNamespace(n,t)}("secmgr.object",function(){var n=this;return n.secmgr.log("secmgr.object loaded."),this.secmgr});
/*! 
 * MeadCo.ScriptX.Print.Licensing (support for modern browsers and IE 11) JS client library
 * Copyright 2017-2018 Mead & Company. All rights reserved.
 * https://github.com/MeadCo/ScriptX.Print.Client
 *
 * This module is only required when working with ScriptX Services for Windows PC.
 * 
 * Released under the MIT license
 */
(function(n,t){extendMeadCoNamespace(n,t)})("MeadCo.ScriptX.Print.Licensing",function(){function a(n){MeadCo.log("License server requested: "+MeadCo.makeApiEndPoint(n,h));t=MeadCo.makeApiEndPoint(n,h)}function c(n,t){a(n);i=t}function l(r,e){if(t.length<=0)throw new Error("MeadCo.ScriptX.Licensing : License server API URL is not set or is invalid");return n.length>0?(typeof r=="function"&&r(n),n):f.jQuery?(MeadCo.log(".ajax() get: "+t),f.jQuery.ajax(t,{method:"GET",dataType:"json",jsonp:!1,cache:!1,async:typeof r=="function",headers:{Authorization:"Basic "+btoa(i+":")}}).done(function(t){if(u="",$.extend(n,t),typeof r=="function"){r(n);return}}).fail(function(n,t,i){if(MeadCo.log("**warning: failure in MeadCo.ScriptX.Licensing.getSubscriptionFromServer: "+i),u=i,typeof e=="function"){e(i);return}}),n):void 0}function e(r,e,o,s,h){if(MeadCo.log("Apply license: "+r+",revision: "+e+", path: "+o),t.length<=0)throw new Error("MeadCo.ScriptX.Licensing : License server API URL is not set or is invalid");i=r;var c={Guid:r,Url:o,Revision:e};return(f.jQuery&&(MeadCo.log(".ajax() post: "+t),f.jQuery.ajax(t,{method:"POST",data:JSON.stringify(c),dataType:"json",contentType:"application/json",jsonp:!1,cache:!1,async:typeof s=="function"}).done(function(t){if(u="",$.extend(n,t),typeof s=="function"){s(n);return}}).fail(function(n,t,i){if(MeadCo.log("**warning: failure in MeadCo.ScriptX.Print.Licensing.applyLicense: "+i),u=i,typeof h=="function"){h(i);return}})),typeof s!="function")?(MeadCo.log("returning applied (sync) license: "+n.company),n):0}var s="1.4.9.0",h="v1/licensing",t="",i="",o=0,r="",u="",f=this,n={};return f.jQuery||MeadCo.log("**** warning :: no jQuery"),MeadCo.log("MeadCo.ScriptX.Print.Licensing "+s+" loaded."),{get version(){return s},connect:function(n,t){c(n,t)},connectLite:function(n,t,i,u){c(n,t);o=i;r=u},apply:function(n,t,i){return e(n,t,i)},applyAsync:function(n,t,i,r,u){e(n,t,i,r,u)},get result(){return u===""?0:5},get validLicense(){return typeof n.guid!="undefined"},get License(){return typeof n.guid!="undefined"?n:l()},GetLicenseAsync:function(n,t){l(n,t)},PolyfillInit:function(){return typeof n.guid!="undefined"?!0:i===""?!1:r===""?!0:(e(i,o,r),typeof n.guid!="undefined")},PolyfillInitAsync:function(t,u){typeof n.guid!="undefined"||r===""?t(n):e(i,o,r,t,u)}}});