/**
 * Static class for namespace creation and core utility functions for ScriptX.Services client libraries
 * 
 * This must be included before any other files from this package.
 * 
 * @namespace MeadCo
 * @author Pete Cole <pcole@meadroid.com>
 * @license MIT license
 */
!function(e,o){var n=function(){var p=this,v=function(e){console.log("MeadCo :: "+e)};return p.extendMeadCoNamespace=function(e,o){var n=o(),i="function"==typeof define&&define.amd,r=void 0!==p&&p.exports;if(i)define(n);else if(r)p.exports=n;else{v("MeadCo root extending namespace: "+e);for(var a=e.split("."),s=p.scope||this.jQuery||this.ender||this.$||this,t=0;t<a.length;t++){var l=a[t];if(t===a.length-1)if(void 0===s[l])v("installing implementation at: "+l),s[l]=n;else{v("Warning - extending package: "+l);var d=s[l];s[l]=n;var f=s[l];for(var c in console.log("preserving old scope ... "),d)d.hasOwnProperty(c)&&(console.log("will preserve: "+c),f[c]=d[c])}else void 0===s[l]?(v("initialising new: "+l),s[l]={}):v("using existing package: "+l);s=s[l]}}},v("MeadCo root namespace loaded."),{log:v,warn:function(e){console.warn("MeadCo :: "+e)},error:function(e){console.error("MeadCo :: "+e)},get version(){return"1.5.1.3"},createNS:function(e){var o=e.split("."),n=p.scope.MeadCo;"MeadCo"===o[0]&&(o=o.slice(1));for(var i=0;i<o.length;i++){var r=o[i];void 0===n[r]&&(n[r]={}),n=n[r]}return n},set scope(e){p.scope=e},makeApiEndPoint:function(e,o){var n=e.indexOf("/api");return-1===n?(e.lastIndexOf("/")!==e.length-1&&(e+="/"),e+="api/"+o):e=e.substr(0,n)+"/api/"+o,e}}}(),i="function"==typeof define&&define.amd,r="undefined"!=typeof module&&module.exports;if(i)define(n);else if(r)module.exports=n;else{var a=this,s=null;if(void 0!==a[e]&&(console.log(e+" already exists"),s=a[e]),a[e]=n,null!=s){var t=a[e];for(var l in console.log("preserving old scope ... "),s)s.hasOwnProperty(l)&&(console.log("will preserve: "+l),t[l]=s[l])}n.scope=a}}("MeadCo");
/**
 * MeadCo.ScriptX.Print
 * 
 * A static class wrapping calls the the server API. Performs processing of 
 * calls to print that returns "printing to file" including collecting the 
 * file output. 
 * Provides attribute based connection to the server.
 * 
 * @namespace MeadCoScriptXPrint
 * @author Pete Cole <pcole@meadroid.com>
 * @license MIT license
 */
extendMeadCoNamespace("MeadCo.ScriptX.Print",function(){var e="1.5.1.1",o="v1/printHtml",l="",d={},u=this,t=[],f="",p="",i=!1,c=!1,r=[],v={URL:1,HTML:2,INNERTHTML:4},g={QUEUEDTODEVICE:1,QUEUEDTOFILE:2,SOFTERROR:3,OK:4},m={NOTSTARTED:0,QUEUED:1,STARTING:2,DOWNLOADING:3,DOWNLOADED:4,PRINTING:5,COMPLETED:6,PAUSED:7,PRINTPDF:8,ERROR:-1,ABANDONED:-2};function C(e){t.push(e),MeadCo.log("ScriptX.Print queueJob, jobCount: "+t.length)}function a(){return MeadCo.log("ScriptX.Print jobCount: "+t.length),t.length}function S(e){var n;for(n=0;n<t.length;n++)if(t[n].jobIdentifier===e.jobIdentifier){var o=e.fnNotify;return"function"!=typeof o&&(e.fnNotify=t[n].fnNotify),"function"!=typeof e.fnNotify||e.status!==g.QUEUEDTOFILE&&e.status===t[n].status||e.fnNotify(e),void(t[n]=e)}console.warn("Unable to find job: "+e.jobIdentifier+" to update it")}function M(e){var n;for(n=0;n<t.length;n++)if(t[n].jobIdentifier===e)return t.splice(n,1),void MeadCo.log("ScriptX.Print remove job, jobCount: "+t.length);console.warn("Unable to find job: "+e+" to remove it")}function y(e,n,o){"function"==typeof e.OnProgress&&e.OnProgress(n,o,e.UserData)}function s(e,n){0<e.length&&(MeadCo.log("Print server requested: "+e+" => "+MeadCo.makeApiEndPoint(e,o)+" with license: "+n),f=MeadCo.makeApiEndPoint(e,o),p=n)}function E(t,r,n,i){MeadCo.log("monitorJob: "+r);var o=0,a=!1,c=window.setInterval(function(){a?MeadCo.log("** info : still waiting for last status request to complete"):(MeadCo.log("Going to request status with .ajax"),a=!0,$.ajax(f+"/status/"+r,{dataType:"json",method:"GET",cache:!1,headers:{Authorization:"Basic "+btoa(p+":")}}).done(function(e){switch(MeadCo.log("jobStatus: "+e.status),e.status){case m.COMPLETED:MeadCo.log("clear interval: "+c),window.clearInterval(c),M(r),i(e);break;case m.NOTSTARTED:case m.DOWNLOADED:case m.DOWNLOADING:case m.PRINTING:case m.QUEUED:case m.STARTING:case m.PAUSED:y(t,e.status,e.message),S(e),0<n&&1e3*++o>n&&(window.clearInterval(c),MeadCoScriptXPrint.reportServerError("unknown failure while printing.")),a=!1;break;case m.ERROR:case m.ABANDONED:MeadCo.log("error status in monitorJob so clear interval: "+c),y(t,e.status,e.message),M(r),window.clearInterval(c),MeadCoScriptXPrint.reportServerError("The print failed.\n\n"+e.message),i(null);break;default:y(t,e.status,e.message),MeadCo.log("unknown status in monitorJob so clear interval: "+c),M(r),window.clearInterval(c),i(null)}}).fail(function(e,n,o){MeadCo.log("**warning: failure in MeadCoScriptXPrint.monitorJob: ["+n+"], ["+o+"], ["+e.responseText+"]"),void 0!==e.responseText&&(o=e.responseText),""===o&&(o="Unknown server or network error"),MeadCo.log("error: "+o+" in monitorJob so clear interval: "+c),y(t,m.ERROR,o),M(r),window.clearInterval(c),i(null)}))},1e3);MeadCo.log("intervalId: "+c)}function w(e){(d[e.printerName]=e).isDefault&&0===l.length&&(l=e.printerName)}function h(t){if(t.name=t.name.replace(/\\/g,"||"),MeadCo.log("Request get device info: "+t.name),u.jQuery){var e=f+"/deviceinfo/"+encodeURIComponent(t.name)+"/0";MeadCo.log(".ajax() get: "+e),u.jQuery.ajax(e,{dataType:"json",method:"GET",cache:!1,async:t.async,headers:{Authorization:"Basic "+btoa(p+":")}}).done(function(e){i=!0,w(e),"function"==typeof t.done&&t.done(e)}).fail(function(e,n,o){o=""===o?e.responseText:(i=!0,o.toString()),MeadCo.log("failed to getdevice: "+o),"function"==typeof t.fail&&t.fail(o)})}else{if("function"!=typeof t.fail)throw new Error("MeadCoScriptXPrint : no known ajax helper available");t.fail("MeadCoScriptXPrint : no known ajax helper available")}}return u.jQuery||MeadCo.log("**** warning :: no jQuery *******"),MeadCo.log("MeadCo.ScriptX.Print "+e+" loaded."),{ContentType:v,ResponseStatus:g,get printerName(){return l},set printerName(e){e!==l&&e.name!==l&&("string"==typeof e?void 0===d[e]?h({name:e,done:function(e){l=e.printerName},async:!1,fail:function(e){MeadCoScriptXPrint.reportServerError(e)}}):l=e:h(e))},get version(){return e},get deviceSettings(){return""!==l?d[l]:{}},set deviceSettings(e){w(e)},deviceSettingsFor:function(e){return"string"!=typeof(n=e)||""==n?{}:(void 0===d[n]&&h({name:n,async:!1,fail:function(e){MeadCoScriptXPrint.reportServerError(e)}}),d[n]);var n},useAttributes:function(){!function(){if(MeadCo.log("MeadCo.ScriptX.Print ... looking for auto connect, already found?: "+c),this.jQuery&&!c){var r=MeadCoScriptXPrint.HTML,i=MeadCoScriptXPrint,a=MeadCoScriptXPrint.Licensing;$("[data-meadco-subscription]").each(function(){if(void 0===i||void 0===r)console.warn("Unable to auto-connect subscription - print or printHtml API not present (yet?)");else if(!c){var e=$(this),n=e.data();MeadCo.log("Auto connect susbcription to: "+n.meadcoServer+", or "+n.meadcoPrinthtmlserver+", with subscription: "+n.meadcoSubscription+", sync: "+n.meadcoSyncinit);var o="false"!==(""+n.meadcoSyncinit).toLowerCase(),t=n.meadcoServer;void 0===t&&(t=n.meadcoPrinthtmlserver),void 0===t?console.error("No server specified"):(void 0!==a&&a.connect(t,n.meadcoSubscription),o?(console.warn("Synchronous connection is deprecated, please use data-meadco-syncinit='false'"),r.connect(t,n.meadcoSubscription)):(MeadCo.log("Async connectlite..."),i.connectLite(t,n.meadcoSubscription)),c=!0)}return!1}),$("[data-meadco-license]").each(function(){if(void 0===i||void 0===r||void 0===a)console.warn("Unable to auto-connect client license - print or printHtml or license API not present (yet?)");else if(!c){var e=$(this),n=e.data();MeadCo.log("Auto connect client license to: "+n.meadcoServer+", with license: "+n.meadcoLicense+", path: "+n.meadcoLicensePath+", revision: "+n.meadcoLicenseRevision+", sync: "+n.meadcoSyncinit);var o="false"!==(""+n.meadcoSyncinit).toLowerCase(),t=n.meadcoServer;o?(console.warn("Synchronous connection is deprecated, please use data-meadco-syncinit='false'"),a.connect(t,n.meadcoLicense),void 0!==n.meadcoLicensePath&&void 0!==n.meadcoLicenseRevision&&a.apply(n.meadcoLicense,n.meadcoLicenseRevision,n.meadcoLicensePath),r.connect(t,n.meadcoLicense)):(MeadCo.log("Async connectlite..."),a.connectLite(t,n.meadcoLicense,n.meadcoLicenseRevision,n.meadcoLicensePath),i.connectLite(t,n.meadcoLicense)),c=!0}return!1})}}()},connect:function(e,n){s(e,n),h({name:"default",async:!1})},connectLite:function(e,n){2===arguments.length&&0<e.length&&0<n.length&&s(e,n)},connectAsync:function(e,n,o,t){var r,i;r=o,i=t,s(e,n),h({name:"default",done:r,async:!0,fail:i})},connectTestAsync:function(e,n,o){!function(e,n,t){if(0<e.length){var o="v1/licensing";if(MeadCo.log("Test server requested: "+e+" => "+MeadCo.makeApiEndPoint(e,o)),e=MeadCo.makeApiEndPoint(e,o),u.jQuery){var r=e+"/ping";MeadCo.log(".ajax() get: "+r),u.jQuery.ajax(r,{method:"GET",dataType:"json",cache:!1,async:!0}).done(function(e){n(e)}).fail(function(e,n,o){MeadCo.log("**warning: failure in MeadCo.ScriptX.Print.testServerConnection: ["+n+"], ["+o+"], ["+e.responseText+"]"),void 0!==e.responseText&&(o=e.responseText),""===o&&(o="Unknown server or network error"),"function"==typeof t&&t(o)})}}}(e,n,o)},connectDeviceAndPrinters:function(e,n){i=!0,w(e),r=n},get isConnected(){return i},get availablePrinterNames(){return r},getFromServer:function(e,n,o,t){if(u.jQuery){var r=f+e;MeadCo.log(".ajax() get: "+r),u.jQuery.ajax(r,{method:"GET",dataType:"json",cache:!1,async:n,headers:{Authorization:"Basic "+btoa(p+":")}}).done(function(e){i=!0,o(e)}).fail(function(e,n,o){MeadCo.log("**warning: failure in MeadCoScriptXPrint.getFromServer: ["+n+"], ["+o+"], ["+e.responseText+"]"),void 0!==e.responseText&&(o=e.responseText),""===o&&(o="Unknown server or network error"),"function"==typeof t&&t(o)})}},printHtml:function(e,n,o,t,r,i,a){var c;MeadCo.log("started MeadCo.ScriptX.Print.print.printHtmlAtServer() Type: "+e+", printerName: "+l),e===v.URL&&MeadCo.log(".. request print url: "+n),c=""===l?{}:d[l];var s={ContentType:e,Content:n,Settings:o,Device:c,OnProgress:i,UserData:a};return function(n,t){if(f.length<=0)throw new Error("MeadCo.ScriptX.Print : print server URL is not set or is invalid");var r={jobIdentifier:Date.now(),printerName:n.Device.printerName,jobName:"Job starting"};if(u.jQuery)return MeadCo.log(".ajax() post to: "+f),C(r),u.jQuery.ajax(f+"/print",{data:JSON.stringify(n),dataType:"json",contentType:"application/json",method:"POST",headers:{Authorization:"Basic "+btoa(p+":")}}).done(function(e){switch(MeadCo.log("Success response: "+e.status),e.printerName=n.Device.printerName,e.jobName=n.Settings.jobTitle,C(e),M(r.jobIdentifier),e.status){case g.QUEUEDTOFILE:t.queuedToFile(e);break;case g.QUEUEDTODEVICE:t.queuedToDevice(e);break;case g.SOFTERROR:t.softError(e);break;case g.OK:t.ok(e)}}).fail(function(e,n,o){MeadCo.log("Fail response from server: ["+n+"], ["+o+"], ["+e.responseText+"]"),M(r.jobIdentifier),void 0!==e.responseText&&(o=e.responseText),""===o&&(o="Unknown server or network error"),"function"==typeof t.fail&&t.fail(e,n,o)}),!0;throw new Error("MeadCoScriptXPrint : no known ajax helper available")}(s,{fail:function(e,n,o){y(s,m.ERROR,o),MeadCoScriptXPrint.reportServerError(o),"function"==typeof t&&t(e)},queuedToFile:function(e){MeadCo.log("default handler on queued to file response"),y(s,m.QUEUED),"function"==typeof r&&(e.fnNotify=r,S(e)),E(s,e.jobIdentifier,-1,function(e){null!=e&&(MeadCo.log("Will download printed file"),y(s,m.COMPLETED),window.open(f+"/download/"+e.jobIdentifier,"_self")),"function"==typeof t&&t(null!=e?"Server error":null)})},queuedToDevice:function(e){y(s,m.QUEUED),MeadCo.log("print was queued to device"),"function"==typeof r&&(e.fnNotify=r,S(e)),E(s,e.jobIdentifier,-1,function(e){null!=e&&y(s,m.COMPLETED),"function"==typeof t&&t(null!=e?"Server error":null)})},softError:function(e){y(s,m.ERROR),MeadCo.log("print has soft error")},ok:function(e){y(s,m.COMPLETED),MeadCo.log("printed ok, no further information"),"function"==typeof r&&(e.fnNotify=r,S(e)),"function"==typeof t&&t(null)}})},reportServerError:function(e){alert("There was an error in the printing service\n\n"+e)},reportFeatureNotImplemented:function(e){MeadCo.log("Call to not implemented: "+e),alert(e+"\n\nis not available.")},get queue(){return t},get activeJobs(){return a()},ensureSpoolingStatus:function(){var e={jobIdentifier:Date.now()};return C(e),e},freeSpoolStatus:function(e){M(e.jobIdentifier)},isSpooling:function(){return 0<a()},waitForSpoolingComplete:function(e,n){if(MeadCo.log("Started WaitForSpoolingComplete("+e+")"),"function"!=typeof n)throw"WaitForSpoolingComplete requires a completion callback";var o=Date.now(),t=window.setInterval(function(){0===a()?(MeadCo.log("WaitForSpoolingComplete - complete"),window.clearInterval(t),n(!0)):0<=e&&Date.now()-o>e&&(MeadCo.log("WaitForSpoolingComplete - timeout"),window.clearInterval(t),n(0===a()))},250)}}});
/**
 * MeadCo.ScriptX.Print.HTML (support for modern browsers and IE 11) JS client library
 * Copyright 2017 Mead & Company. All rights reserved.
 * https://github.com/MeadCo/ScriptX.Print.Client
 *
 * @author Pete Cole <pcole@meadroid.com>
 * @license Released under the MIT license
 */
extendMeadCoNamespace("MeadCo.ScriptX.Print.HTML",function(){var e="1.4.9.0",t={DEFAULT:0,LANDSCAPE:1,PORTRAIT:2},r={DEFAULT:0,INCHES:1,MM:2},n={ALL:1,ODD:2,EVEN:3,ODDANDEVEN:4},s={header:null,footer:null,headerFooterFont:null,viewScale:0,locale:navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language,timezoneOffset:0,shortDateFormat:"",longDateFormat:"",printBackgroundColorsAndImages:!1,page:{orientation:t.PORTRAIT,units:r.DEFAULT,margins:{left:"",top:"",bottom:"",right:""}},extraHeadersAndFooters:{},pageRange:"",printingPass:n.ALL,jobTitle:"",documentUrl:document.URL},o={set header(e){MeadCo.log("MeadCo.ScriptX.Print.HTML setting header: "+e),0===e.length&&(e="%20"),s.header=e},get header(){return s.header},set footer(e){0===e.length&&(e="%20"),s.footer=e},get footer(){return s.footer},set headerFooterFont(e){0===e.length&&(e="%20"),s.headerFooterFont=e},get headerFooterFont(){return s.headerFooterFont},set viewScale(e){s.viewScale=e},get viewScale(){return s.viewScale},set locale(e){s.locale=e},set shortDateFormat(e){s.longDateFormat=e},set longDateFormat(e){s.longDateFormat=e},set printBackgroundColorsAndImages(e){s.printBackgroundColorsAndImages=e},get printBackgroundColorsAndImages(){return s.printBackgroundColorsAndImages},extraHeadersAndFooters:{get allPagesHeader(){return s.extraHeadersAndFooters.allPagesHeader},set allPagesHeader(e){s.extraHeadersAndFooters.allPagesHeader=e},get allPagesFooter(){return s.extraHeadersAndFooters.allPagesFooter},set allPagesFooter(e){s.extraHeadersAndFooters.allPagesFooter=e},get firstPageHeader(){return s.extraHeadersAndFooters.firstPageHeader},set firstPageHeader(e){s.extraHeadersAndFooters.firstPageHeader=e},get firstPageFooter(){return s.extraHeadersAndFooters.firstPageFooter},set firstPageFooter(e){s.extraHeadersAndFooters.firstPageFooter=e},get extraFirstPageFooter(){return s.extraHeadersAndFooters.extraFirstPageFooter},set extraFirstPageFooter(e){s.extraHeadersAndFooters.extraFirstPageFooter=e},get allHeaderHeight(){return s.extraHeadersAndFooters.allHeaderHeight},set allHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.allHeaderHeight=e},get allFooterHeight(){return s.extraHeadersAndFooters.allFooterHeight},set allFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.allFooterHeight=e},get firstHeaderHeight(){return s.extraHeadersAndFooters.firstHeaderHeight},set firstHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.firstHeaderHeight=e},get firstFooterHeight(){return s.extraHeadersAndFooters.firstFooterHeight},set firstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.firstFooterHeight=e},get extraFirstFooterHeight(){return s.extraHeadersAndFooters.extraFirstFooterHeight},set extraFirstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.extraFirstFooterHeight=e}},page:{set orientation(e){s.page.orientation=e},get orientation(){return s.page.orientation},set units(e){s.page.units=e},get units(){return s.page.units},margins:{set left(e){s.page.margins.left=e},get left(){return s.page.margins.left},set top(e){s.page.margins.top=e},get top(){return s.page.margins.top},set bottom(e){s.page.margins.bottom=e},get bottom(){return s.page.margins.bottom},set right(e){s.page.margins.right=e},get right(){return s.page.margins.right}}},get pageRange(){return s.pageRange},set pageRange(e){s.pageRange=e},get printingPass(){return s.printingPass},set printingPass(e){if(!("number"==typeof e&&n.ALL<=e&&e<=n.ODDANDEVEN))throw"Invalid argument";s.printingPass=e}};function a(e){(s=e).locale=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language,s.timezoneOffset=(new Date).getTimezoneOffset(),s.documentUrl=document.URL,MeadCo.log("Settings cache updated, .locale: ["+s.locale+"], .offset: "+s.timezoneOffset)}function i(){var e=window.location.port?":"+window.location.port:"";return window.location.protocol+"//"+window.location.hostname+e+window.location.pathname}function g(e){var t;if(t=e,$(":checked",t).each(function(){this.setAttribute("checked","checked")}),$("input[type='text']",t).each(function(){this.setAttribute("value",$(this).val())}),$("select",t).each(function(){var e=$(this);$("option",e).each(function(){e.val()==$(this).val()&&this.setAttribute("selected","selected")})}),$("textarea",t).each(function(){var e=$(this).attr("value");$.browser.mozilla&&this.firstChild?this.firstChild.textContent=e:this.innerHTML=e}),$("script",e).remove(),$("object",e).remove(),!$("head>base",e).length){MeadCo.log("No base element, fabricating one to: "+i());var r=$("<base>",{href:i()});$("head",e).prepend(r)}return e.html()}function l(){if(this.jQuery)return g($("html"));throw new Error("No supported html snapshot helper available (jQuery is required)")}function d(e,t,r,n,o,a){var i=s;return i.jobTitle=r,MeadCo.ScriptX.Print.printHtml(e,t,i,n,null,o,a)}return MeadCo.log("MeadCo.ScriptX.Print.HTML "+e+" loaded."),this.jQuery||MeadCo.log("**** warning :: no jQuery"),{PageMarginUnits:r,PageOrientation:t,CollateOptions:{DEFAULT:0,TRUE:1,FALSE:2},PrintingPasses:n,settings:o,printDocument:function(e,t,r){return d(MeadCo.ScriptX.Print.ContentType.INNERTHTML,l(),document.title,e,t,r)},printFrame:function(e,t,r,n){return d(MeadCo.ScriptX.Print.ContentType.INNERTHTML,function(e){if(this.jQuery){var t=$("#"+e);if(!t.length)throw new Error("Unabled to print frame - frame does not exist");return g(t.contents().find("html"))}throw new Error("No supported framed html snapshot helper available (jQuery is required)")}(e),document.title,t,r,n)},printFromUrl:function(e,t,r,n){return d(MeadCo.ScriptX.Print.ContentType.URL,e,e,t,r,n)},printHtml:function(e,t,r,n){return d(MeadCo.ScriptX.Print.ContentType.HTML,e,"HTML snippet",t,r,n)},connectLite:function(e,t){MeadCo.ScriptX.Print.connectLite(e,t)},connect:function(e,t){MeadCo.warn("Print.HTML SYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+s.page.units,!1,function(e){MeadCo.log("got default html settings"),a(e.settings),null!=e.device&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters)})},connectAsync:function(e,t,r,n){MeadCo.log("Print.HTML ASYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+s.page.units,!0,function(e){MeadCo.log("got default html settings"),a(e.settings),null!=e.device&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters),r()},n)},get version(){return e}}});
/**
 * MeadCo ScriptX 'window.factory' shim (support for modern browsers and IE 11) JS client library
 * Copyright 2017 Mead & Company. All rights reserved.
 * https://github.com/MeadCo/ScriptX.Print.Client
 *
 * @author Pete Cole <pcole@meadroid.com>
 * @license Released under the MIT license
 */
!function(e,t,r){if(this[e]!=r||null!=document.getElementById(e)){if(console.log("ScriptX factory anti-polyfill believes it may not be requred."),this[e]!=r&&console.log("this["+e+"] is defined"),null!=document.getElementById(e)&&console.log("document.getElementById("+e+") is defined"),this[e].object!=r)return console.log("this["+e+"].object is defined -- not required!!!");console.log("this["+e+"].object is *not* defined")}console.log("ScriptX factory anti-polyfill believes it is requred.");var n=function(){var a="1.4.9.1",s="8.0.0.0",g=this;function u(e){console.log("factory anti-polyfill :: "+e)}return g.extendFactoryNamespace=function(e,t){var r=t();u("MeadCo factory extending namespace: "+e);for(var n=e.split("."),i=this,o=0;o<n.length;o++){var a=n[o];o===n.length-1?void 0===i[a]?(u("installing implementation at: "+a),i[a]=r):u("Warning - not overwriting package: "+a):void 0===i[a]?(u("initialising new: "+a),i[a]={}):u("using existing package: "+a),i=i[a]}},u("'factory' loaded "+a),{log:u,GetComponentVersion:function(e,t,r,n,i){u("factory.object.getcomponentversion: "+e);var o=s;switch(e.toLowerCase()){case"scriptx.factory":o=s;break;case"scriptx.factory.cloud":o=a;break;case"meadco.secmgr":try{o=g.secmgr.version}catch(e){}break;case"meadco.triprint":try{o=MeadCo.ScriptX.Print.HTML.version}catch(e){}}o=o.split("."),t[0]=o[0],r[0]=o[1],n[0]=o[2],i[0]=o[3]},get ScriptXVersion(){return s},get SecurityManagerVersion(){return s},baseURL:function(e){return window.location.href.substring(0,window.location.href.length-window.location.pathname.length)},relativeURL:function(e){throw"MeadCo.ScriptX.Print :: relativeUrl is not implemented yet."}}}();this[e]=n}("factory"),"function"==typeof extendFactoryNamespace&&extendFactoryNamespace("factory.printing",function(){var g=MeadCo.ScriptX.Print.HTML,n=g.settings,a=MeadCo.ScriptX.Print,u=(MeadCo.ScriptX.Print.Licensing,this);function p(e,t,r){void 0===e&&(e=!0);var n=a.ensureSpoolingStatus();if(e){if(MeadCo.ScriptX.Print.UI)return MeadCo.ScriptX.Print.UI.PrinterSettings(function(e){e?(MeadCo.log("promptAndPrint requesting print ..."),r(t())):r(!1),a.freeSpoolStatus(n)}),MeadCo.log("promptAndPrint exits ..."),!0;console.warn("prompted print requested but no UI library loaded")}return r(t()),a.freeSpoolStatus(n),!0}function o(e,t,r,n,i){var o="";if(0===e.indexOf("html://")){o=e.substring(7);var a="<!doctype";o.substr(0,a.length).toLowerCase()===a&&(o=o.substring(o.indexOf(">")+1))}else if(-1===e.indexOf("://")&&-1===e.indexOf("\\\\")){var s=u.factory.baseURL();e="/"!==s.substring(s.length-1,s.length)?"/"!==e.substring(0,1)?s+"/"+e:s+e:"/"!==e.substring(0,1)?s+e:s+e.substring(1)}return p(t,function(){return MeadCo.log("printHtmlContent requesting print ..."),0<o.length?g.printHtml(o,null,n,i):g.printFromUrl(e,null,n,i)},r)}u.factory.log("factory.Printing loaded."),"function"==typeof u.print&&(u.factory.log("overwriting module.print"),u.print=function(){u.factory.log("window.print() called and being handled."),p(!0,function(){return g.printDocument()},function(){})});var e={get allPagesHeader(){return n.extraHeadersAndFooters.allPagesHeader},set allPagesHeader(e){n.extraHeadersAndFooters.allPagesHeader=e},get allPagesFooter(){return n.extraHeadersAndFooters.allPagesFooter},set allPagesFooter(e){n.extraHeadersAndFooters.allPagesFooter=e},get firstPageHeader(){return n.extraHeadersAndFooters.firstPageHeader},set firstPageHeader(e){n.extraHeadersAndFooters.firstPageHeader=e},get firstPageFooter(){return n.extraHeadersAndFooters.firstPageFooter},set firstPageFooter(e){n.extraHeadersAndFooters.firstPageFooter=e},get extraFirstPageFooter(){return n.extraHeadersAndFooters.extraFirstPageFooter},set extraFirstPageFooter(e){n.extraHeadersAndFooters.extraFirstPageFooter=e},get allHeaderHeight(){return n.extraHeadersAndFooters.allHeaderHeight},set allHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";n.extraHeadersAndFooters.allHeaderHeight=e},get allFooterHeight(){return n.extraHeadersAndFooters.allFooterHeight},set allFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";n.extraHeadersAndFooters.allFooterHeight=e},get firstHeaderHeight(){return n.extraHeadersAndFooters.firstHeaderHeight},set firstHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";n.extraHeadersAndFooters.firstHeaderHeight=e},get firstFooterHeight(){return n.extraHeadersAndFooters.firstFooterHeight},set firstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";n.extraHeadersAndFooters.firstFooterHeight=e},get extraFirstFooterHeight(){return n.extraHeadersAndFooters.extraFirstFooterHeight},set extraFirstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";n.extraHeadersAndFooters.extraFirstFooterHeight=e},get pageRange(){return n.pageRange},set pageRange(e){n.pageRange=e},get printingPass(){var e="";switch(n.printingPass){case g.PrintingPasses.ALL:e="all";break;case g.PrintingPasses.ODD:e="odd";break;case g.PrintingPasses.EVEN:e="even";break;case g.PrintingPasses.ODDANDEVEN:e="odd&even"}return e},set printingPass(e){var t=g.PrintingPasses.ALL;if("string"==typeof e)switch(e.toLowerCase()){case"odd":t=g.PrintingPasses.ODD;break;case"even":t=g.PrintingPasses.EVEN;break;case"odd&even":t=g.PrintingPasses.ODDANDEVEN}n.printingPass=t}};return a.useAttributes(),{set header(e){u.factory.log("set factory.printing.header: "+e),n.header=e},get header(){return n.header},set footer(e){n.footer=e},get footer(){return n.footer},set headerFooterFont(e){n.headerFooterFont=e},get headerFooterFont(){return n.headerFooterFont},set orientation(e){switch(e.toLowerCase()){case"landscape":n.page.orientation=g.PageOrientation.LANDSCAPE;break;case"portrait":n.page.orientation=g.PageOrientation.PORTRAIT}},get orientation(){return n.page.orientation===g.PageOrientation.PORTRAIT?"portrait":"landscape"},set portrait(e){n.page.orientation=e?g.PageOrientation.PORTRAIT:g.PageOrientation.LANDSCAPE},get portrait(){return n.page.orientation===g.PageOrientation.PORTRAIT},set leftMargin(e){n.page.margins.left=e},get leftMargin(){return n.page.margins.left},set topMargin(e){n.page.margins.top=e},get topMargin(){return n.page.margins.top},set bottomMargin(e){n.page.margins.bottom=e},get bottomMargin(){return n.page.margins.bottom},set rightMargin(e){n.page.margins.right=e},get rightMargin(){return n.page.margins.right},set templateURL(e){},get templateURL(){return"MeadCo://default"},IsTemplateSupported:function(){return!0},PageSetup:function(e){void 0===e&&(console.warn("PageSeup API in ScriptX.Print Service is not synchronous, there is no return value."),e=function(e){console.log("PageSetugDlg: "+e)}),MeadCo.ScriptX.Print.UI?MeadCo.ScriptX.Print.UI.PageSetup(e):a.reportFeatureNotImplemented("Page setup dialog")},PrintSetup:function(e){void 0===e&&(console.warn("PrintSetup API in ScriptX.Print Service is not synchronous, there is no return value."),e=function(e){console.log("PrintSetugDlg: "+e)}),MeadCo.ScriptX.Print.UI?MeadCo.ScriptX.Print.UI.PrinterSettings(e):a.reportFeatureNotImplemented("Print settings dialog")},Preview:function(e){a.reportFeatureNotImplemented("Preview",e)},Print:function(e,t,r){return void 0===r&&(r=function(e){}),void 0===t&&(t=null),p(e,function(){if(null==t)return g.printDocument();var e="string"==typeof t?t:t.id;return g.printFrame(e)},r)},PrintHTML:function(e,t,r){return void 0===r&&(r=function(e){}),o(e,t,r)},PrintHTMLEx:function(e,t,r,n,i){return void 0===i&&(i=function(e){}),o(e,t,i,r,n)},set units(e){this.SetMarginMeasure(e)},get units(){return this.GetMarginMeasure()},set paperSize(e){a.deviceSettings.paperSizeName=e},get paperSize(){return a.deviceSettings.paperSizeName},set paperSource(e){a.deviceSettings.paperSourceName=e},get paperSource(){return a.deviceSettings.paperSourceName},set paperSource2(e){a.deviceSettings.paperSourceName=e},get paperSource2(){return a.deviceSettings.paperSourceName},get pageWidth(){return a.deviceSettings.paperPageSize.width},get pageHeight(){return a.deviceSettings.paperPageSize.height},set copies(e){a.deviceSettings.copies=e},get copies(){return a.deviceSettings.copies},set collate(e){a.deviceSettings.collate=!0===e||1===e?g.CollateOptions.TRUE:g.CollateOptions.FALSE},get collate(){return a.deviceSettings.collate===g.CollateOptions.TRUE},set duplex(e){a.deviceSettings.duplex=e},get duplex(){return a.deviceSettings.duplex},set duplex2(e){a.deviceSettings.duplex=e},get duplex2(){return a.deviceSettings.duplex},set onbeforeprint(e){a.reportFeatureNotImplemented("onbeforeprint",e)},set onafterprint(e){a.reportFeatureNotImplemented("onafterprint",e)},set onuserprintpreview(e){a.reportFeatureNotImplemented("onuserprintpreview",e)},get CurrentPrinter(){return a.printerName},set CurrentPrinter(e){a.printerName=e},get currentPrinter(){return a.printerName},set currentPrinter(e){a.printerName=e},get printer(){return a.printerName},set printer(e){a.printerName=e},set printToFileName(e){a.reportFeatureNotImplemented("printToFileName",e)},get printBackground(){return n.printBackgroundColorsAndImages},set printBackground(e){n.printBackgroundColorsAndImages=e},get viewScale(){return n.viewScale},set viewScale(e){n.viewScale=e},set unprintableLeft(e){a.deviceSettings.unprintableMargins.left=e},get unprintableLeft(){return a.deviceSettings.unprintableMargins.left},set unprintableRight(e){a.deviceSettings.unprintableMargins.right=e},get unprintableRight(){return a.deviceSettings.unprintableMargins.right},set unprintableTop(e){a.deviceSettings.unprintableMargins.top=e},get unprintableTop(){return a.deviceSettings.unprintableMargins.top},set unprintableBottom(e){a.deviceSettings.unprintableMargins.bottom=e},get unprintableBottom(){return a.deviceSettings.unprintableMargins.bottom},EnumPrinters:function(e){var t=a.availablePrinterNames;if(t&&0!==t.length){if(e<t.length)return t[e]}else if(0===e)return this.CurrentPrinter;return""},EnumJobs:function(e,t,r){var n,i=a.queue,o=new Array;for(e=e.toLowerCase(),n=0;n<i.length;n++)i[n].printerName.toLowerCase()===e&&o.push(i[n]);return t<o.length?(r.name=o[t].jobName,o[t].status):0},GetJobsCount:function(e){var t,r=a.queue,n=0;for(e=e.toLowerCase(),t=0;t<r.length;t++)r[t].printerName.toLowerCase()===e&&n++;return n},printerControl:function(e){return{get Forms(){return a.deviceSettingsFor(e).forms},get Bins(){return a.deviceSettingsFor(e).bins},get forms(){return a.deviceSettingsFor(e).forms},get bins(){return a.deviceSettingsFor(e).bins},get name(){return e},get port(){return a.deviceSettingsFor(e).port},get attributes(){return a.deviceSettingsFor(e).attributes},get serverName(){return a.deviceSettingsFor(e).serverName},get shareName(){return a.deviceSettingsFor(e).shareName},get location(){return a.deviceSettingsFor(e).location},get isLocal(){return a.deviceSettingsFor(e).isLocal},get isNetwork(){return a.deviceSettingsFor(e).isNetwork},get isShared(){return a.deviceSettingsFor(e).isShared},get Jobs(){a.reportFeatureNotImplemented("printerControl.Jobs")},Purge:function(){a.reportFeatureNotImplemented("printerControl.Purge()")},Pause:function(){a.reportFeatureNotImplemented("printerControl.Pause()")},Resume:function(){a.reportFeatureNotImplemented("printerControl.Resume()")}}},GetMarginMeasure:function(){return n.page.units===g.PageMarginUnits.INCHES?2:1},SetMarginMeasure:function(e){n.page.units=2===e?g.PageMarginUnits.INCHES:g.PageMarginUnits.MM},SetPrintScale:function(e){n.viewScale=e},IsSpooling:function(){return a.isSpooling()},OwnQueue:function(){},SetPageRange:function(e,t,r){e&&a.reportFeatureNotImplemented("SetPageRange selection only"),n.pageRange=t+"-"+r},SetPreviewZoom:function(){a.reportFeatureNotImplemented("SetPreviewZoom")},Sleep:function(){a.reportFeatureNotImplemented("Sleep")},TotalPrintPages:function(){a.reportFeatureNotImplemented("TotalPrintPages")},WaitForSpoolingComplete:function(e,t){a.waitForSpoolingComplete(e,t)},enhancedFormatting:e,PolyfillInit:function(){return MeadCo.ScriptX.Print.isConnected},PolyfillInitAsync:function(e,t){MeadCo.ScriptX.Print.isConnected?e():g.connectAsync("","",e,t)}}}),"function"==typeof extendFactoryNamespace&&extendFactoryNamespace("factory.object",function(){return this.factory.log("factory.object loaded."),this.factory}),"function"==typeof extendFactoryNamespace&&extendFactoryNamespace("factory.object.js",function(){return this.factory.log("factory.object.js loaded."),{FormatNumber:function(e){return isNaN(e)?0:"string"==typeof e?Number(e):e}}});
/** 
 * MeadCo.ScriptX.Print.Licensing (support for modern browsers and IE 11) JS client library
 * Copyright 2017-2018 Mead & Company. All rights reserved.
 * https://github.com/MeadCo/ScriptX.Print.Client
 *
 * This module is only required when working with ScriptX Services for Windows PC.
 * 
 * @author Pete Cole <pcole@meadroid.com>
 * @license Released under the MIT license
 */
extendMeadCoNamespace("MeadCo.ScriptX.Print.Licensing",function(){var n="1.4.9.0",o="v1/licensing",a="",c="",t=0,r="",u="",d=this,s={};function f(n,e){var i;i=n,MeadCo.log("License server requested: "+MeadCo.makeApiEndPoint(i,o)),a=MeadCo.makeApiEndPoint(i,o),c=e}function i(e,o){if(a.length<=0)throw new Error("MeadCo.ScriptX.Licensing : License server API URL is not set or is invalid");return 0<s.length?("function"==typeof e&&e(s),s):d.jQuery?(MeadCo.log(".ajax() get: "+a),d.jQuery.ajax(a,{method:"GET",dataType:"json",jsonp:!1,cache:!1,async:"function"==typeof e,headers:{Authorization:"Basic "+btoa(c+":")}}).done(function(n){u="",$.extend(s,n),"function"!=typeof e||e(s)}).fail(function(n,e,i){MeadCo.log("**warning: failure in MeadCo.ScriptX.Licensing.getSubscriptionFromServer: "+i),u=i,"function"!=typeof o||o(i)}),s):void 0}function p(n,e,i,o,t){if(MeadCo.log("Apply license: "+n+",revision: "+e+", path: "+i),a.length<=0)throw new Error("MeadCo.ScriptX.Licensing : License server API URL is not set or is invalid");var r={Guid:c=n,Url:i,Revision:e};return d.jQuery&&(MeadCo.log(".ajax() post: "+a),d.jQuery.ajax(a,{method:"POST",data:JSON.stringify(r),dataType:"json",contentType:"application/json",jsonp:!1,cache:!1,async:"function"==typeof o}).done(function(n){u="",$.extend(s,n),"function"!=typeof o||o(s)}).fail(function(n,e,i){MeadCo.log("**warning: failure in MeadCo.ScriptX.Print.Licensing.applyLicense: "+i),u=i,"function"!=typeof t||t(i)})),"function"!=typeof o?(MeadCo.log("returning applied (sync) license: "+s.company),s):0}return d.jQuery||MeadCo.log("**** warning :: no jQuery"),MeadCo.log("MeadCo.ScriptX.Print.Licensing "+n+" loaded."),{get version(){return n},connect:function(n,e){f(n,e)},connectLite:function(n,e,i,o){f(n,e),t=i,r=o},apply:function(n,e,i){return p(n,e,i)},applyAsync:function(n,e,i,o,t){p(n,e,i,o,t)},get result(){return""===u?0:5},get validLicense(){return void 0!==s.guid},get License(){return void 0!==s.guid?s:i()},GetLicenseAsync:function(n,e){i(n,e)},PolyfillInit:function(){return void 0!==s.guid||""!==c&&(""===r||(p(c,t,r),void 0!==s.guid))},PolyfillInitAsync:function(n,e){void 0!==s.guid||""===r?n(s):p(c,t,r,n,e)}}});
/**
 * MeadCo ScriptX 'window.secmgr' shim (support for modern browsers and IE 11) JS client library
 * Copyright 2017 Mead & Company. All rights reserved.
 * https://github.com/MeadCo/ScriptX.Print.Client
 *
 * @author Pete Cole <pcole@meadroid.com>
 * @license Released under the MIT license
 */
!function(e,n,t){if(this[e]!=t||null!=document.getElementById(e)){if(console.log("MeadCo security manager anti-polyfill believes it may not be requred."),this[e]!=t&&console.log("this["+e+"] is defined"),null!=document.getElementById(e)&&console.log("document.getElementById("+e+") is defined"),this[e].object!=t)return console.log("this["+e+"].object is defined -- not required!!!");console.log("this["+e+"].object is *not* defined")}var i=function(){var e=MeadCo.ScriptX.Print,t=MeadCo.ScriptX.Print.Licensing;function c(e){console.log("secmgr anti-polyfill :: "+e)}this.extendSecMgrNamespace=function(e,n){var t=n();c("MeadCo security manager extending namespace2: "+e);for(var i=e.split("."),o=this,l=0;l<i.length;l++){var r=i[l];l===i.length-1?void 0===o[r]?(c("installing implementation at: "+r),o[r]=t):c("Warning - not overwriting package: "+r):void 0===o[r]?(c("initialising new: "+r),o[r]={}):c("using existing package: "+r),o=o[r]}},c("'secmgr' loaded."),null==t&&console.error("MeadCo.ScriptX.Print.Licensing not available");null==e?console.error("MeadCo.ScriptX.Print not available"):e.useAttributes();return{log:c,get version(){return"1.4.9.0"},get result(){return t.result},get validLicense(){return t.validLicense},get License(){return t.License},GetLicenseAsync:function(e,n){t.GetLicenseAsync(e,n)},PolyfillInit:function(){return t.PolyfillInit()},PolyfillInitAsync:function(e,n){t.PolyfillInitAsync(e,n)}}}();this[e]=i}("secmgr"),"function"==typeof extendSecMgrNamespace&&extendSecMgrNamespace("secmgr.object",function(){return this.secmgr.log("secmgr.object loaded."),this.secmgr});