!function(e){var t=function(){var e=this,t="1.16.2.2",r="undefined"!=typeof MeadCo&&void 0!==MeadCo.logEnable&&MeadCo.logEnable,o="undefined"!=typeof MeadCo&&void 0!==MeadCo.useFetch?MeadCo.useFetch:void 0===e.jQuery,n=function(e){r&&console.log("MeadCo :: "+e)},i=function(e){console.error("MeadCo :: "+e)};return e.extendMeadCoNamespace=function(t,r){var o=r();n("MeadCo root extending namespace: "+t);for(var i=t.split("."),a=e.scope||this.jQuery||this.ender||this.$||this,s=0;s<i.length;s++){var l=i[s];if(s===i.length-1)if(void 0===a[l])n("installing implementation at: "+l),a[l]=o;else{n("Warning - extending package: "+l);var c=a[l];a[l]=o;var d=a[l];for(var u in n("preserving old scope ... "),c)c.hasOwnProperty(u)&&(n("will preserve: "+u),d[u]=c[u])}else void 0===a[l]?(n("initialising new: "+l),a[l]={}):n("using existing package: "+l);a=a[l]}},n("MeadCo root namespace "+t+" loaded."),{log:n,warn:function(e){console.warn("MeadCo :: "+e)},error:i,get version(){return t},get logEnabled(){return r},set logEnabled(e){r=e},get fetchEnabled(){return o},set fetchEnabled(e){o=e},createNS:function(t){var r=t.split("."),o=e.scope.MeadCo;"MeadCo"===r[0]&&(r=r.slice(1));for(var n=0;n<r.length;n++){var i=r[n];void 0===o[i]&&(o[i]={}),o=o[i]}return o},set scope(t){e.scope=t},makeApiEndPoint:function(e,t){var r=e.indexOf("/api");return-1===r?(e.lastIndexOf("/")!==e.length-1&&(e+="/"),e+="api/"+t):e=e.substring(0,r)+"/api/"+t,e},makeServiceEndPoint:function(e,t){var r=e.indexOf("/api");return-1===r?(e.lastIndexOf("/")!==e.length-1&&(e+="/"),e+=t):e=e.substring(0,r)+"/"+t,e},parseAjaxError:function(e,t,r,o){return function(e,t,r,o){return i("**warning: AJAX call failure in "+e+": ["+r+"], ["+o+"], ["+t.responseText+"], ["+t.statusText+"]"),""===o||"Internal Server Error"===o?o="error"!==r?t.responseText||r:"object"==typeof t.responseJSON&&"string"==typeof t.responseJSON.Message?t.responseJSON.Message:"string"==typeof t.responseText?t.responseText:"Server or network error":"object"!=typeof t.responseJSON&&"string"==typeof t.responseText&&t.responseText.length>0&&(o=t.responseText),i(" error parsed to --\x3e ["+o+"]"),o}(e,t,r,o)},parseFetchError:function(e,t){const r="string"==typeof t?t:t.message;return i("**warning: FETCH call failure in "+e+": "+r),r}}}(),r=this,o=null;if(void 0!==r[e]&&(o=r[e]),r[e]=t,null!==o){var n=r[e];for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])}t.scope=r}("MeadCo"),extendMeadCoNamespace("MeadCo.ScriptX.Print",(function(){const e="1.16.2.2",t="v1/printHtml",r="v1/printPdf",o="v1/printer";let n="";const i="ScriptX.Services//PrintPreview.1",a="[hold.clientside]",s="[wait.response]",l="[hold.ensureSpoolStatus]";var c={cookie:""};let d={};const u=this;let p=[];const f={serviceUrl:"",pendingUrl:"",failedUrl:"",verifiedUrl:"",orchestratorPort:0,orchestratorKey:"",portsToTry:10,verifying:!1,trustVerifiedConnection:!0,undoTrust:function(){this.trustVerifiedConnection||""===this.serviceUrl||(this.verifiedUrl=this.serviceUrl,this.pendingUrl=this.serviceUrl,this.serviceUrl="")},get url(){if(""!==this.verifiedUrl)return this.verifiedUrl;if(""===this.serviceUrl&&""!==this.pendingUrl){MeadCo.warn("[GET] servicesServer.url is not ready, performing synchronous search. Recommend code re-org to resolve the server earlier and asynchronously.");var e=this;this.verifyUrl(this.pendingUrl,!1,(function(){return e.serviceUrl}),(function(){return""}))}return this.serviceUrl},set url(e){MeadCo.log("servicesServer::setUrl: "+e),this.IsChangingServer(e)&&(MeadCo.log("note set as pending"),this.serviceUrl="",this.pendingUrl=e)},setUrlAsync:function(e,t,r){MeadCo.log("servicesServer::urlAsync: "+e),this.verifyUrl(e,!0,t,r)},verifyUrl:function(e,t,r,o){if(this.verifying&&t){MeadCo.warn("Verify called and verify in progress ....");var n=this,i=e;window.setTimeout((function(){n.verifyUrl(i,t,r,o)}),1e3)}else if(this.IsChangingServer(e)&&!this.IsFailedConnection(e)){var a;n=this,i=e,MeadCo.log("servicesServer::verifyurl: "+e+", async: "+t),"number"!=typeof this.orchestratorPort&&(this.orchestratorPort=parseInt(""+this.orchestratorPort)),this.orchestratorPort>0?(MeadCo.log("Using request to Orchestrator on port: "+this.orchestratorPort),n.verifying=!0,a="string"==typeof this.orchestratorKey&&this.orchestratorKey.length>0?"/api/v2?key="+this.orchestratorKey:"/api/v1",MeadCo.log("servicesServer::querying orchestrator: http://127.0.0.1:"+this.orchestratorPort+a),u.jQuery&&!MeadCo.fetchEnabled?u.jQuery.ajax("http://127.0.0.1:"+this.orchestratorPort+a,{method:"GET",dataType:"json",cache:!1,async:t}).done((function(e){MeadCo.log("orchestrator returned ScriptX.Services port: "+e.HttpPort);var a=new URL(i);a.port=e.HttpPort,i=a.protocol+"//"+a.host+a.pathname,n.test(i,0,t,(function(e){n.serviceUrl=e,n.pendingUrl="",n.verifying=!1,r(e,!0)}),(function(e){n.serviceUrl="",n.pendingUrl="",n.failedUrl=i,n.verifying=!1,"function"==typeof o&&o(e)}))})).fail((function(e,t,r){n.verifying=!1,n.serviceUrl="",n.pendingUrl="";const a=MeadCo.parseAjaxError("Failed to connect with Orchestrator: ",e,t,r);MeadCo.warn(a);try{new URL(i),n.failedUrl=i}catch(e){}"function"==typeof o&&o('ScriptX.Services (Orchestrator) could not be found at "'+i+'". Is it installed and running?')})):fetch("http://127.0.0.1:"+this.orchestratorPort+a).then((e=>{if(!e.ok)throw new Error(`HTTP Error: ${e.status}`);return e.json()})).then((e=>{MeadCo.log("orchestrator returned ScriptX.Services port: "+e.HttpPort);var a=new URL(i);a.port=e.HttpPort,i=a.protocol+"//"+a.host+a.pathname,n.test(i,0,t,(function(e){n.serviceUrl=e,n.pendingUrl="",n.verifying=!1,r(e,!0)}),(function(e){n.serviceUrl="",n.pendingUrl="",n.failedUrl=i,n.verifying=!1,"function"==typeof o&&o(e)}))})).catch((e=>{n.verifying=!1,n.serviceUrl="",n.pendingUrl="";try{new URL(i),n.failedUrl=i}catch(e){}"function"==typeof o&&o('ScriptX.Services (Orchestrator) could not be found at "'+i+'". Is it installed and running?')}))):(n.verifying=!0,n.test(i,n.portsToTry,t,(function(e){n.serviceUrl=e,n.pendingUrl="",n.verifying=!1,r(e,!1)}),(function(e){n.serviceUrl="",n.pendingUrl="",n.verifying=!1;try{new URL(i),n.failedUrl=i}catch(e){}"function"==typeof o&&o('ScriptX.Services could not be found at "'+i+'". Is it installed and running?')})))}else this.IsFailedConnection(e)?"function"==typeof o?o("ScriptX.Services connection to: "+e+" is either invalid or has already failed and will not be re-tried."):MeadCo.warn("ScriptX.Services connection to: "+e+" has already failed and will not be re-tried."):r(this.serviceUrl,this.orchestratorPort>0)},test:function(e,t,r,o,n){if(e.length>0){const i=this;let a;try{if(a=new URL(e),"http:"!==a.protocol&&"https:"!==a.protocol)return void n("Invalid protocol: "+e)}catch(t){return void n("Invalid URL: "+e)}MeadCo.log("Test server requested: "+e+", port: "+a.port);const s=MeadCo.makeApiEndPoint(a.href,"v1/licensing/ping");u.jQuery&&!MeadCo.fetchEnabled?(MeadCo.log(".ajax() get: "+s),u.jQuery.ajax(s,{method:"GET",dataType:"json",cache:!1,async:r}).done((function(e){const t=a.protocol+"//"+a.host+a.pathname;MeadCo.log("Test server succeed, resolve("+t+")"),o(t)})).fail((function(e,s,l){MeadCo.log("Test server failed: ["+l+"], "+t+", on: "+a.hostname),t>0&&("localhost"===a.hostname||"127.0.0.1"==a.hostname)?(a.port++,u.setTimeout(i.test(a.protocol+"//"+a.host+a.pathname,--t,r,o,n),1)):(l=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.servicesServer.test:",e,s,l),"function"==typeof n?(MeadCo.log("rejecting with: "+l),n(l)):MeadCo.warn("failed with no reject function"))}))):(MeadCo.log("fetch get: "+s),r?fetch(s).then((e=>{if(!e.ok)throw new Error(`HTTP Error: ${e.status}`);return e.json()})).then((e=>{const t=a.protocol+"//"+a.host+a.pathname;MeadCo.log("Test server succeed, resolve("+t+")"),o(t)})).catch((e=>{MeadCo.log("Test server failed: ["+e+"], "+t+", on: "+a.hostname),t>0&&("localhost"===a.hostname||"127.0.0.1"==a.hostname)?(a.port++,u.setTimeout(i.test(a.protocol+"//"+a.host+a.pathname,--t,r,o,n),1)):(errorThrown=MeadCo.parseFetchError("MeadCo.ScriptX.Print.servicesServer.test:",e),"function"==typeof n?(MeadCo.log("rejecting with: "+errorThrown),n(errorThrown)):MeadCo.warn("failed with no reject function"))})):(MeadCo.error("Synchronous Ajax calls requires jQuery"),"function"==typeof n&&n("Synchronous Ajax calls requires jQuery")))}},call:function(e,t,r,o,n,i,a){const s=this;if(""===this.serviceUrl&&""!==this.pendingUrl)this.verifyUrl(this.pendingUrl,n,(function(){""!==s.url?s.call(e,t,r,o,n,i,a):"function"==typeof a&&a("Server url verification failed to set url")}),a);else if(""!==this.serviceUrl){const l=MeadCo.makeApiEndPoint(this.serviceUrl,e),c=window.location.href;MeadCo.log("servicesServer.call() "+t+": "+l);let d={method:t,cache:!1,async:n,jsonp:!1,dataType:"json",contentType:"application/json"};if(d.headers=o?{Authorization:"Basic "+btoa(g+":"),"X-Meadroid-Path":c}:{"X-Meadroid-Path":c},this.IsEmptyPayload(r)||(MeadCo.log("payload defined."),d.data=JSON.stringify(r)),u.jQuery&&!MeadCo.fetchEnabled)u.jQuery.ajax(l,d).done((function(e){return"function"==typeof i&&i(e),e})).fail((function(r,o,n){if(n=MeadCo.parseAjaxError("MeadCo.ScriptX.Print:"+e+t,r,o,n),"function"!=typeof a)throw new Error(n);a(n)})).always((function(e,t,r){s.undoTrust()}));else if(n)d.headers=o?{Authorization:"Basic "+btoa(g+":"),"X-Meadroid-Path":c,"Content-type":"application/json"}:{"X-Meadroid-Path":c,"Content-type":"application/json"},fetch(l,{method:d.method,headers:d.headers,body:d.data,referrerPolicy:"origin-when-cross-origin",mode:"cors",credentials:"omit",cache:"no-store",redirect:"error",keepalive:!1}).then((r=>{if(s.undoTrust(),r.ok)return r.json();if(500==r.status||404==r.status)r.text().then((r=>{const o=MeadCo.parseFetchError("MeadCo.ScriptX.Print:"+e+t,r);if("function"!=typeof a)throw new Error(o);a(o)}));else{if("function"!=typeof a)throw new Error(r.statusText);a(r.statusText)}})).then((e=>{e&&"function"==typeof i&&i(e)})).catch((r=>{const o=MeadCo.parseFetchError("MeadCo.ScriptX.Print:"+e+t,r);if("function"!=typeof a)throw new Error(o);a(o)}));else{if("function"!=typeof a)throw new Error("Synchronous Ajax calls requires jQuery");a("Synchronous Ajax calls requires jQuery")}}else{if("function"!=typeof a)throw new Error("MeadCo.ScriptX.Print : server connection is not defined.");a("MeadCo.ScriptX.Print : server connection is not defined.")}return!0},IsChangingServer:function(e){if(""!==this.serviceUrl)try{var t=new URL(this.serviceUrl),r=new URL(e);return t.hostname!=r.hostname||t.port!=r.port&&0==this.orchestratorPort}catch(t){return MeadCo.error("Failed to construct URL(): "+t.message+", from: "+this.serviceUrl+", or: "+e),MeadCo.error("Many errors will ensue"),!1}return!0},IsEmptyPayload:e=>null===e||0===Object.keys(e).length&&e.constructor===Object,IsFailedConnection:function(e){if(this.failedUrl.length>0)try{var t=new URL(this.failedUrl),r=new URL(e);return t.hostname===r.hostname&&(MeadCo.warn("Attempt to use: "+e+" is noted as a failed connection and will not be retried"),!0)}catch(t){return MeadCo.error("Testing IsFailed unable to construct URL(): "+t.message+", from: "+this.failedUrl+", or: "+e),!0}return!1}};var g="",m=!1,v=!1,h=[],b=null,y={URL:1,HTML:2,INNERHTML:4,STRING:8},C=0,S=1,P=2,M=3,w=4,E={REPORT:1,THROW:2},F=E.REPORT,A={CLOUD:1,ONPREMISE:2,WINDOWSPC:3},x={NOTSTARTED:0,QUEUED:1,STARTING:2,DOWNLOADING:3,DOWNLOADED:4,PRINTING:5,COMPLETED:6,PAUSED:7,PRINTPDF:8,ERROR:-1,ABANDONED:-2};function T(e){p.push(e),MeadCo.log("ScriptX.Print queueJob: "+e.jobIdentifier+", name: "+e.jobName+", jobCount: "+p.length)}function k(){return MeadCo.log("ScriptX.Print jobCount: "+p.length),p.length}function N(e){let t=(r=e.jobIdentifier,p.find((e=>e.jobIdentifier===r)));var r;t?Object.keys(e).forEach((function(r){t[r]=e[r]})):MeadCo.warn("Unable to find job: "+e.jobIdentifier+" to update it")}function L(e){p=p.filter((t=>t.jobIdentifier!==e)),MeadCo.log(`ScriptX.Print removed job: ${e}, jobCount: ${p.length}`),0==p.length&&(H=0)}function D(e,t,r){"function"==typeof e.OnProgress&&e.OnProgress(t,r,e.UserData)}var I="";function U(e,r,o,s,l,u,p){var g;MeadCo.log("started MeadCo.ScriptX.Print.print.printHtmlAtServer() Type: "+e),e===y.URL&&MeadCo.log(".. request print url: "+r),g=""===n?{}:n===i?JSON.parse(JSON.stringify({printerName:n})):JSON.parse(JSON.stringify(d[n]));var m={ContentType:e,Content:r,Settings:JSON.parse(JSON.stringify(o)),Device:g,ProtectedContentAccess:c,OnProgress:u,UserData:s},v={jobIdentifier:Date.now(),printerName:m.Device.printerName,jobName:a};T(v);var h=I;I="";var b=p;return function(){return L(v.jobIdentifier),q(t,m,{fail:function(e){D(m,x.ERROR,e),MeadCo.ScriptX.Print.reportError(e),"function"==typeof l&&l("Server error")},queuedToFile:function(e){MeadCo.log("print is being queued to a file"),D(m,x.QUEUED),G(t,m,e.jobIdentifier,-1,(function(e){if(null!==e){MeadCo.log("download printed file is available"),D(m,x.COMPLETED);var r=MeadCo.makeApiEndPoint(f.url,t+"/download/"+e.jobIdentifier);h.length>0&&(r+="/"+h),b(r,e.jobIdentifier)}"function"==typeof l&&l(null===e?"Server error":null)}))},queuedToDevice:function(e){MeadCo.log("print was queued to device"),D(m,x.QUEUED),G(t,m,e.jobIdentifier,-1,(function(e){null!==e&&D(m,x.COMPLETED),"function"==typeof l&&l(null===e?"Server error":null)}))},softError:function(e){D(m,x.ERROR,e.message),MeadCo.ScriptX.Print.reportError(e.message),MeadCo.log("print has soft error"),L(e.jobIdentifier),"function"==typeof l&&(MeadCo.log("Call fnDone"),l(e.message))},ok:function(e){D(m,x.COMPLETED),MeadCo.log("printed ok, no further information"),L(e.jobIdentifier),"function"==typeof l&&l(null)}})}}var R=0,H=0,X=750,j=1e4;function O(e,t,r,o){"string"==typeof e&&e.length>0?(MeadCo.log("Print server requested: "+e+" with license: "+t),g="string"==typeof t&&t.length>0?t:g,n="",d={},p=[],m=!1,h=[],"function"==typeof r?f.setUrlAsync(e,r,o):f.url=e):(MeadCo.log("Print server retained in setServer: "+f.url+" may update with license: {"+t+"} (if provided)"),g="string"==typeof t&&t.length>0?t:g)}function q(e,t,r){const o={jobIdentifier:Date.now(),printerName:t.Device.printerName,jobName:s};return MeadCo.log("printAtServer using: "+e),T(o),Q(e+"/print","POST",t,!0,!0,(e=>{switch(MeadCo.log("Success response: "+e.status),e.printerName=t.Device.printerName,e.jobName="string"==typeof t.Settings.jobTitle&&t.Settings.jobTitle.length>0?t.Settings.jobTitle:"server job",T(e),L(o.jobIdentifier),e.status){case P:r.queuedToFile(e);break;case S:r.queuedToDevice(e);break;case M:case C:r.softError(e);break;case w:r.ok(e)}}),(e=>{L(o.jobIdentifier),"function"==typeof r.fail&&r.fail(e)}))}function B(e,t,r,o){return Q(e,"GET",null,!0,t,r,o)}function Q(e,t,r,o,n,i,a){return f.call(e,t,r,o,n,i,a)}function W(e,t,r,o,n,i){switch(MeadCo.log("processMonitorResponse::jobStatus: "+t.status),t.status){case x.COMPLETED:MeadCo.log("clear interval: "+r),window.clearInterval(r),L(o),i(t);break;case x.NOTSTARTED:case x.DOWNLOADED:case x.DOWNLOADING:case x.PRINTING:case x.QUEUED:case x.STARTING:case x.PAUSED:case x.PRINTPDF:D(e,t.status,t.message),N(t),n>0&&++counter*interval>n&&(window.clearInterval(r),MeadCo.ScriptX.Print.reportError("unknown failure while printing."));break;case x.ERROR:case x.ABANDONED:case x.CODEEXEPTION:MeadCo.log("error status in processMonitorResponse so clear interval: "+r),D(e,t.status,t.message),L(o),window.clearInterval(r),MeadCo.ScriptX.Print.reportError("The print failed with the error: "+t.message),i(null);break;default:D(e,t.status,t.message),MeadCo.log("unknown status in processMonitorResponse so clear interval: "+r),L(o),window.clearInterval(r),i(null)}}function G(e,t,r,o,n){MeadCo.log("monitorJob: "+r);let i=!1,a=window.setInterval((function(){i?MeadCo.log("** info : still waiting for last status request to complete"):(i=!0,B(e+"/status/"+r,!0,(e=>{W(t,e,a,r,o,n),i=!1}),(e=>{MeadCo.log("error: "+e+" in monitorJob so clear interval: "+a),D(t,x.ERROR,e),L(r),window.clearInterval(a),n(null),i=!1})))}),1e3);MeadCo.log("intervalId: "+a)}function V(e){if("string"==typeof e.printerName){if(e.isDefault)for(var t=0;t<d.length;t++)d[t].isDefault=!1;d[e.printerName]=e,e.isDefault&&0===n.length&&(n=e.printerName)}}function z(e){e.name=e.name.replace(/\\/g,"||"),MeadCo.log("Request get device info: "+e.name),B(t+"/deviceinfo/"+encodeURIComponent(e.name)+"/0",e.async,(function(t){m=!0,V(t),"function"==typeof e.done&&e.done(t)}),(function(t){"systemdefault"===e.name?(MeadCo.warn("request for systemdefault printer failed - please update to ScriptX.Services 2.11.1"),e.name="default",z(e)):(MeadCo.log("failed to getdevice: "+t),"function"==typeof e.fail&&e.fail(t))}))}function J(e,t,r){"string"==typeof e&&""!==e?void 0===d[e]?z({name:e,async:!0,done:function(r){"systemdefault"===e.toLowerCase()&&(e=r.printerName),t(d[e])},fail:function(e){r(e)}}):t(d[e]):r("a printer name is required")}function K(e,t){console.warn("Synchronous calls to add/remove printer connections are not recommeneded as this will lock the browser UI. Consider using the asynchronous versions when working with in ScriptX.Services");var r=MeadCo.ScriptX.Print.serviceDescription();r.serviceClass==A.WINDOWSPC&&r.serviceVersion.major>=2&&r.serviceVersion.minor>=19?Q(o+"/Connection/"+encodeURIComponent(t),e,null,!0,!1):MeadCo.error("ScriptX.Services for Windows PC 2.19 or later is required for add/remove PrinterConnection()")}function _(e,t,r,n){MeadCo.ScriptX.Print.serviceDescriptionAsync((function(i){i.serviceClass==A.WINDOWSPC&&i.serviceVersion.major>=2&&i.serviceVersion.minor>=19?Q(o+"/Connection/"+encodeURIComponent(t),e,null,!0,!0,r,n):(MeadCo.error("ScriptX.Services for Windows PC 2.19 or later is required for add/remove PrinterConnection()"),n("add/remove PrinterConnection is not supported"))}),n)}return MeadCo.log("MeadCo.ScriptX.Print "+e+" loaded."),{ContentType:y,PrintStatus:x,ErrorAction:E,CollateOptions:{DEFAULT:0,TRUE:1,FALSE:2},DuplexOptions:{DEFAULT:0,SIMPLEX:1,VERTICAL:2,HORIZONTAL:3},MeasurementUnits:{DEFAULT:0,INCHES:1,MM:2},ServiceClasses:A,get onErrorAction(){return F},set onErrorAction(e){F=e},get orchestrator(){return f.orchestratorPort},set orchestrator(e){f.orchestratorPort=""+e},get orchestratorKey(){return f.orchestratorKey},set orchestratorKey(e){f.orchestratorKey=e},get authorisationCookie(){return c.cookie},set authorisationCookie(e){c.cookie=e},get printerName(){return n},set printerName(e){e!==n&&e.name!==n&&("string"==typeof e?void 0===d[e]?u.jQuery&&!MeadCo.fetchEnabled?z({name:e,done:function(e){n=e.printerName},async:!1,fail:function(e){MeadCo.ScriptX.Print.reportError(e)}}):(MeadCo.error("Asynchronous processing of set printerName required, synchronous calls to obtain device details will fail until this completes."),J(e,(e=>{n=e.printerName}),(e=>{MeadCo.ScriptX.Print.reportError(e)})),""===f.serviceUrl?MeadCo.ScriptX.Print.reportError("MeadCo.ScriptX.Print : server connection is not defined."):MeadCo.ScriptX.Print.reportError("Not Found")):n=e:z(e))},setSystemDefaultPrinterAsync:function(e,r,o){if(void 0!==d.systemdefault&&d.systemdefault==e)return MeadCo.log("setSystemDefaultPrinterAsync() does NOT need to do anything"),void r();e=(e="system::"+e).replace(/\\/g,"||"),MeadCo.log("Request systemDefaultPrinterAsync: "+e),Q(t+"/CurrentPrinter/"+encodeURIComponent(e),"PUT",null,!0,!0,r,o)},get version(){return e},get serviceUrl(){return f.url},serviceVersion:function(){return this.serviceDescription().serviceVersion},serviceVersionAsync:function(e,t){this.serviceDescriptionAsync((function(t){e(t.serviceVersion)}),t)},get deviceSettings(){return""!==n?d[n]:{}},set deviceSettings(e){V(e)},deviceSettingsFor:function(e){return function(e){return"string"==typeof e&&""!==e?(void 0===d[e]&&z({name:e,async:!1,done:function(t){"systemdefault"===e.toLowerCase()&&(e=t.printerName)},fail:function(e){MeadCo.ScriptX.Print.reportError(e)}}),d[e]):{}}(e)},deviceSettingsForAsync:function(e,t,r){J(e,t,r)},useAttributes:function(){!function(){if(MeadCo.log("MeadCo.ScriptX.Print ... looking for auto connect, already found?: "+v),!v){var e=MeadCo.ScriptX.Print.HTML,t=MeadCo.ScriptX.Print,r=MeadCo.ScriptX.Print.Licensing;const o=document.querySelector("[data-meadco-subscription]");if(o){const n=o.dataset;MeadCo.log("Auto connect susbcription to: "+n.meadcoServer+", or "+n.meadcoPrinthtmlserver+", with subscription: "+n.meadcoSubscription+", sync: "+n.meadcoSyncinit+", usefetch: "+n.meadcoUsefetch);const i="false"!==(""+n.meadcoSyncinit).toLowerCase();if(i)MeadCo.fetchEnabled=!1;else{const e=""+n.meadcoUsefetch;e.length>0&&(MeadCo.fetchEnabled="true"===e.toLowerCase())}const a=n.meadcoServer;void 0===a&&(a=n.meadcoPrinthtmlserver),void 0===a?MeadCo.error("No server specified"):(void 0!==r&&r.connect(a,n.meadcoSubscription),i?(MeadCo.warn("Synchronous connection is deprecated.jQuery is required for synchronous behaviour.To update to asynchronous behaviour please use data - meadco - syncinit='false'. Note that this may require additional code changes. Please see: https://www.meadroid.com/Developers/KnowledgeBank/HowToGuides/ScriptXServices/ThenToNow/Stage6"),e.connect(a,n.meadcoSubscription)):(MeadCo.log("Async connectlite..."),t.connectLite(a,n.meadcoSubscription)),v=!0)}else{const o=document.querySelector("[data-meadco-license]");if(o)if(void 0===t||void 0===e||void 0===r)MeadCo.log("Not auto-connecting client license as print or printHtml or license API not present. Should be present on next attempt.");else{const n=o.dataset;MeadCo.log("Auto connect client license to: "+n.meadcoServer+", with license: "+n.meadcoLicense+", path: "+n.meadcoLicensePath+", revision: "+n.meadcoLicenseRevision+", sync: "+n.meadcoSyncinit+", useFetch: "+n.meadcoUsefetch+", orchestrator: "+n.meadcoOrchestrator+", orchestratorKey: "+n.meadcoOrchestratorKey+", trustVerifiedConnection: "+n.meadcoTrustVerifiedConnection);const i="false"!==(""+n.meadcoSyncinit).toLowerCase(),a="false"!==(""+n.meadcoReporterror).toLowerCase(),s="true"==(""+n.meadcoApplyLicense).toLowerCase(),l=n.meadcoServer;if(f.orchestratorPort=n.meadcoOrchestrator,f.orchestratorKey=n.meadcoOrchestratorKey,f.trustVerifiedConnection="false"!==(""+n.meadcoTrustVerifiedConnection).toLowerCase(),i)MeadCo.warn("Synchronous connection is deprecated. jQuery is required for synchronous behaviour. To update to asynchronous behaviour please use data-meadco-syncinit='false'. Note that this may require additional code changes. Please see: https://www.meadroid.com/Developers/KnowledgeBank/HowToGuides/ScriptXServices/ThenToNow/Stage6"),MeadCo.fetchEnabled=!1,r.connect(l,n.meadcoLicense),void 0!==n.meadcoLicensePath&&void 0!==n.meadcoLicenseRevision&&(r.apply(n.meadcoLicense,n.meadcoLicenseRevision,n.meadcoLicensePath),0!=r.result&&a&&MeadCo.ScriptX.Print.reportError(r.errorMessage)),e.connect(l,n.meadcoLicense);else{MeadCo.log("Async connectlite...");const e=""+n.meadcoUsefetch;e.length>0&&(MeadCo.fetchEnabled="true"===e.toLowerCase()),r.connectLite(l,n.meadcoLicense,n.meadcoLicenseRevision,n.meadcoLicensePath),t.connectLite(l,n.meadcoLicense),s&&r.applyAsync(n.meadcoLicense,n.meadcoLicenseRevision,n.meadcoLicensePath,(()=>{MeadCo.log("NOTE: license has been applied successfully from async processing of attribute with values")}),(e=>{MeadCo.error(`Failed to apply the license: ${e}, error is: ${r.errorMessage}`),a&&MeadCo.ScriptX.Print.reportError(r.errorMessage)}))}v=!0}}}}()},connect:function(e,t){!function(e,t){O(e,t),z({name:"systemdefault",async:!1}),B("",!0,(function(e){b=e}))}(e,t)},connectLite:function(e,t){O(e,t)},connectAsync:function(e,t,r,o){!function(e,t,r,o){O(e,t,(function(e){z({name:"systemdefault",done:r,async:!0,fail:o}),B("",!0,(function(e){b=e}))}),o)}(e,t,r,o)},connectTestAsync:function(e,t,r){f.verifyUrl(e,!0,t,r)},serviceDescription:function(){return b||B("",!1,(function(e){b=e}),(function(e){MeadCo.ScriptX.Print.reportError(e.message)})),b},serviceDescriptionAsync:function(e,t){b?e(b):B("",!0,(function(t){b=t,e(t)}),t)},waitableServiceDescription:function(){return new Promise(((e,t)=>{this.serviceDescriptionAsync(e,t)}))},connectDeviceAndPrinters:function(e,t){m=!0,V(e),h=t},get isConnected(){return m},get availablePrinterNames(){return h},addPrinterConnection:function(e){K("PUT",e)},removePrinterConnection:function(e){K("DELETE",e)},addPrinterConnectionAsync:function(e,t,r){_("PUT",e,t,r)},removePrinterConnectionAsync:function(e,t,r){_("DELETE",e,t,r)},getFromServer:function(e,r,o,n){B(t+e,r,o,n)},printHtml:function(e,t,r,o,n,i){if(!t||"string"==typeof t&&0===t.length)return MeadCo.ScriptX.Print.reportError("Request to print no content - access denied?"),"function"==typeof o&&o("Request to print no content"),!1;var a=Date.now();return a-H>j&&(R=0),H=a,setTimeout(U(e,t,r,i,o,n,(function(e){window.open(e,"_self")})),R),R+=X,!0},requestHtmlPreview:function(e,t,r,o,a){var s=n;n=i,U(e,t,r,{},o,(function(){}),a)(),n=s},printPdf:function(e,t,o,i,s){if(!e||"string"==typeof e&&0===e.length)return MeadCo.ScriptX.Print.reportError("The document to print must be given."),"function"==typeof o&&o("Request to print no content"),!1;const l=Date.now();return l-H>j&&(R=0),H=l,setTimeout(function(e,t,o,i,s){let l;MeadCo.log("started MeadCo.ScriptX.Print.print.printPdfAtServer() document: "+e+", printerName: "+n),l=""===n?{}:JSON.parse(JSON.stringify(d[n]));const u={Document:e,Description:t.jobDescription,Settings:JSON.parse(JSON.stringify(t)),Device:l,ProtectedContentAccess:c,OnProgress:i,UserData:s};u.Settings.jobTitle=t.jobDescription;const p={jobIdentifier:Date.now(),printerName:u.Device.printerName,jobName:a};T(p);var g=I;return I="",function(){return L(p.jobIdentifier),q(r,u,{fail:function(e){D(u,x.ERROR,e),MeadCo.ScriptX.Print.reportError(e),"function"==typeof o&&o("Server error")},queuedToFile:function(e){MeadCo.log("default handler on queued to file response"),D(u,x.QUEUED),G(r,u,e.jobIdentifier,-1,(function(e){if(null!==e){MeadCo.log("Will download printed file"),D(u,x.COMPLETED);let t=MeadCo.makeApiEndPoint(f.url,r+"/download/"+e.jobIdentifier);g.length>0&&(t+="/"+g),window.open(t,"_self")}"function"==typeof o&&o(null===e?"Server error":null)}))},queuedToDevice:function(e){MeadCo.log("print was queued to device"),D(u,x.QUEUED),G(r,u,e.jobIdentifier,-1,(function(e){null!==e&&D(u,x.COMPLETED),"function"==typeof o&&o(null===e?"Server error":null)}))},softError:function(e){D(u,x.ERROR,e.message),MeadCo.ScriptX.Print.reportError(e.message),MeadCo.log("printpdf call has soft error, remove job: "+e.jobIdentifier),L(e.jobIdentifier),"function"==typeof o&&(MeadCo.log("Call fnDone"),o("Server error"))},ok:function(e){D(u,x.COMPLETED),MeadCo.log("printed ok, no further information"),L(e.jobIdentifier),"function"==typeof o&&o(null)}})}}(e,t,o,i,s),R),R+=X,!0},printDirect:function(e,t,r){if(MeadCo.log("started MeadCo.ScriptX.Print.print.printDirectAtServer() Type: "+e+", printerName: "+n),e===y.URL)MeadCo.log(".. request print url: "+t);else if(e!==y.STRING)return MeadCo.ScriptX.Print.reportError("Bad content type for direct printing"),"function"==typeof r&&r("Bad content type for direct printing"),!1;return!t||"string"==typeof t&&0===t.length?(MeadCo.ScriptX.Print.reportError("Request to print no content - access denied?"),"function"==typeof r&&r("Request to print no content"),!1):""===n?(MeadCo.ScriptX.Print.reportError("Request to print but no current printer defined."),"function"==typeof r&&r("Request to print but no current printer defined."),!1):q("v1/printDirect",{ContentType:e,Content:t,PrinterName:n,Settings:{jobTitle:"Direct print"},Device:d[n]},{fail:function(e){MeadCo.ScriptX.Print.reportError(e),"function"==typeof r&&r("Server error")},softError:function(e){MeadCo.ScriptX.Print.reportError(e.message),MeadCo.log("print has soft error"),L(e.jobIdentifier),"function"==typeof r&&(MeadCo.log("Call fnDone"),r(e.message))},ok:function(e){MeadCo.log("printed ok, no further information"),L(e.jobIdentifier),"function"==typeof r&&r(null)}})},parseAjaxError:function(e,t,r,o){return MeadCo.parseAjaxError(e,t,r,o)},parseFetchError:function(e,t){return MeadCo.parseFetchError(e,t)},reportError:function(e){switch(MeadCo.error("ReportError: "+e),F){case E.REPORT:MeadCo.ScriptX.Print.reportServerError(e);break;case E.THROW:throw new Error(e)}},reportServerError:function(e){alert("There was an error in the printing service\n\n"+e)},reportFeatureNotImplemented:function(e){MeadCo.log("Call to not implemented: "+e),alert(e+"\n\nis not available.")},get queue(){return p},get activeJobs(){return this.queue.filter((e=>e.jobName!==a&&e.jobName!==s&&e.jobName!==l)).length},get clientSideJobs(){return this.queue.filter((e=>e.jobName==a||e.jobName==s||e.jobName==l)).length},get noJobsWaitingDelivery(){return this.queue.every((e=>e.jobName!==a&&e.jobName!==s&&e.jobName!==l))},ensureSpoolingStatus:function(){var e={jobIdentifier:Date.now(),printerName:"ensureJobsPrinter",jobName:l};return T(e),e},freeSpoolStatus:function(e){L(e.jobIdentifier)},get isSpooling(){return k()>0},waitForSpoolingComplete:function(e,t){if(MeadCo.log("Started WaitForSpoolingComplete("+e+")"),"function"!=typeof t)throw"WaitForSpoolingComplete requires a completion callback";var r=Date.now(),o=window.setInterval((function(){0===k()?(MeadCo.log("WaitForSpoolingComplete - complete"),window.clearInterval(o),t(!0)):e>=0&&Date.now()-r>e&&(MeadCo.log("WaitForSpoolingComplete - timeout"),window.clearInterval(o),t(0===k()))}),250)},waitForDeliveryComplete:function(e,t){if(MeadCo.log("Started waitForDeliveryComplete("+e+")"),"function"!=typeof t)throw"waitForDeliveryComplete requires a completion callback";const r=Date.now(),o=this,n=window.setInterval((()=>{o.noJobsWaitingDelivery?(MeadCo.log("waitForDeliveryComplete - complete"),window.clearInterval(n),t(!0)):e>=0&&Date.now()-r>e&&(MeadCo.log("waitForDeliveryComplete - timeout"),window.clearInterval(n),t(!1))}),250)},waitForDeliveryCompleteAsync:function(){const e=this;return new Promise((function(t,r){e.waitForDeliveryComplete(-1,t)}))},get queueTimeoutSpacing(){return X},set queueTimeoutSpacing(e){X=e},get queueGapResetTime(){return j},set queueGapResetTime(e){j=e},get jobFileName(){return I},set jobFileName(e){I=e},requestService:function(e,t,r,o,n,i,a){return Q(e,t,r,o,n,i,a)},getService:function(e,t,r){return Q(e,"GET",t,r,!1)},postService:function(e,t,r){return Q(e,"POST",t,r,!1)},getServiceAsync:function(e,t,r,o,n){return Q(e,"GET",t,r,!0,o,n)},postServiceAsync:function(e,t,r,o,n){return Q(e,"POST",t,r,!0,o,n)}}})),extendMeadCoNamespace("MeadCo.ScriptX.Print.HTML",(function(){var e,t,r="1.16.2.0",o={DEFAULT:0,LANDSCAPE:1,PORTRAIT:2},n={DEFAULT:0,ALL:1,ODD:2,EVEN:3},i=1,a=2,s={header:null,footer:null,headerFooterFont:null,viewScale:0,locale:navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language,timezoneOffset:0,shortDateFormat:"",longDateFormat:"",printBackgroundColorsAndImages:!1,page:{orientation:o.PORTRAIT,units:MeadCo.ScriptX.Print.MeasurementUnits.DEFAULT,margins:{left:"",top:"",bottom:"",right:""}},extraHeadersAndFooters:{},pageRange:"",printingPass:n.ALL,jobTitle:"",documentUrl:document.URL},l={set header(e){MeadCo.log("MeadCo.ScriptX.Print.HTML setting header: "+e),e&&0===e.length&&(e="%20"),s.header=e},get header(){return s.header&&"%20"!==s.header?s.header:""},set footer(e){e&&0===e.length&&(e="%20"),s.footer=e},get footer(){return s.footer&&"%20"!==s.footer?s.footer:""},set headerFooterFont(e){e&&0===e.length&&(e="%20"),s.headerFooterFont=e},get headerFooterFont(){return s.headerFooterFont&&"%20"!==s.headerFooterFont?s.headerFooterFont:""},get locale(){return s.locale},set viewScale(e){s.viewScale=e},get viewScale(){return s.viewScale},set locale(e){s.locale=e},set shortDateFormat(e){s.shortDateFormat=e},set longDateFormat(e){s.longDateFormat=e},set printBackgroundColorsAndImages(e){s.printBackgroundColorsAndImages=e?i:a},get printBackgroundColorsAndImages(){return s.printBackgroundColorsAndImages===i},extraHeadersAndFooters:{get allPagesHeader(){return s.extraHeadersAndFooters.allPagesHeader},set allPagesHeader(e){s.extraHeadersAndFooters.allPagesHeader=e},get allPagesFooter(){return s.extraHeadersAndFooters.allPagesFooter},set allPagesFooter(e){s.extraHeadersAndFooters.allPagesFooter=e},get firstPageHeader(){return s.extraHeadersAndFooters.firstPageHeader},set firstPageHeader(e){s.extraHeadersAndFooters.firstPageHeader=e},get firstPageFooter(){return s.extraHeadersAndFooters.firstPageFooter},set firstPageFooter(e){s.extraHeadersAndFooters.firstPageFooter=e},get extraFirstPageFooter(){return s.extraHeadersAndFooters.extraFirstPageFooter},set extraFirstPageFooter(e){s.extraHeadersAndFooters.extraFirstPageFooter=e},get allHeaderHeight(){return s.extraHeadersAndFooters.allHeaderHeight},set allHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.allHeaderHeight=e},get allFooterHeight(){return s.extraHeadersAndFooters.allFooterHeight},set allFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.allFooterHeight=e},get firstHeaderHeight(){return s.extraHeadersAndFooters.firstHeaderHeight},set firstHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.firstHeaderHeight=e},get firstFooterHeight(){return s.extraHeadersAndFooters.firstFooterHeight},set firstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.firstFooterHeight=e},get extraFirstFooterHeight(){return s.extraHeadersAndFooters.extraFirstFooterHeight},set extraFirstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.extraFirstFooterHeight=e}},page:{set orientation(e){s.page.orientation=e},get orientation(){return s.page.orientation},set units(e){s.page.units=e},get units(){return s.page.units},margins:{set left(e){s.page.margins.left=e},get left(){return s.page.margins.left},set top(e){s.page.margins.top=e},get top(){return s.page.margins.top},set bottom(e){s.page.margins.bottom=e},get bottom(){return s.page.margins.bottom},set right(e){s.page.margins.right=e},get right(){return s.page.margins.right}}},get pageRange(){return s.pageRange},set pageRange(e){s.pageRange=e},get printingPass(){return s.printingPass},set printingPass(e){if(!("number"==typeof e&&e>=n.DEFAULT&&e<=n.EVEN))throw"Invalid argument";s.printingPass=e}};function c(e){return null!==e?((s=e).locale=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language,s.timezoneOffset=(new Date).getTimezoneOffset(),s.documentUrl=document.URL,MeadCo.log("Settings cache updated, .locale: ["+s.locale+"], .offset: "+s.timezoneOffset),!0):(MeadCo.warn("Igoring attempt to updateSettingsWithServerDefaults with null"),!1)}function d(){var e=window.location.port?":"+window.location.port:"";return window.location.protocol+"//"+window.location.hostname+e+window.location.pathname}function u(e){!function(e){jQuery(":checked",e).each((function(){this.setAttribute("checked","checked")}));for(var t="text search number email datetime datetime-local date month week time tel url color range".split(" "),r=t.length,o=0;o<r;o++)jQuery("input[type="+t[o]+"]",e).each((function(){this.setAttribute("value",jQuery(this).val())}));jQuery("select",e).each((function(){var e=jQuery(this);jQuery("option",e).each((function(){e.val()===jQuery(this).val()&&this.setAttribute("selected","selected")}))})),jQuery("textarea",e).each((function(){this.innerHTML=jQuery(this).val()}))}(e);var t=e.clone();if(jQuery("script",t).remove(),jQuery("object",t).remove(),!jQuery("head>base",t).length){MeadCo.log("No base element, fabricating one to: "+d());var r=jQuery("<base>",{href:d()});jQuery("head",t).prepend(r)}return t.html()}function p(e){var t;(t=e.documentElement).querySelectorAll(":checked").forEach((e=>{e.setAttribute("checked","checked")})),"text search number email datetime datetime-local date month week time tel url color range".split(" ").forEach((e=>{t.querySelectorAll("input[type="+e+"]").forEach((e=>{e.setAttribute("value",e.value)}))})),t.querySelectorAll("select").forEach((e=>{e.querySelectorAll("option").forEach((t=>{t.removeAttribute("checked"),e.value===t.value?t.setAttribute("selected","selected"):t.removeAttribute("selected")}))})),t.querySelectorAll("textarea").forEach((e=>{e.innerHTML=e.value}));let r=e.documentElement.cloneNode(!0);if(r.querySelectorAll("object").forEach((e=>e.remove())),r.querySelectorAll("script").forEach((e=>e.remove())),null===r.querySelector("head>base")){let e=document.createElement("base");e.setAttribute("href",d()),r.querySelector("head").prepend(e)}return r.outerHTML}function f(){return this.jQuery&&!MeadCo.fetchEnabled?u(jQuery("html")):p(document)}function g(e){if(this.jQuery&&!MeadCo.fetchEnabled){var t=jQuery("#"+e);if(!t.length&&!(t=jQuery("iframe[name="+e+"]")).length)throw new Error("Unable to get frame content - frame does not exist");return u(t.contents().find("html"))}{let t=document.getElementById(e);if(null==t){if(t=window.frames[e],!t)throw new Error("Unable to get frame content - frame does not exist")}else t=t.contentWindow;return p(t.document)}}function m(e,t,r,o,n,i){var a=s;return a.jobTitle=r,MeadCo.ScriptX.Print.printHtml(e,t,a,o,n,i)}function v(r,o){MeadCo.ScriptX.Print.deviceSettingsForAsync("systemdefault",(n=>{t=n.printerName,e=MeadCo.ScriptX.Print.printerName,MeadCo.log("Starting preview html ... printer: "+e);var i=document.getElementById("scriptXServices-PreviewWaitScreen");if(null==i){(i=document.createElement("DIV")).innerHTML="&shy;<style>.loader { background-color: rgba(0, 0, 0, 0.25); overflow: hidden; width: 100%; height: 100%; position: fixed;top: 0; left: 0; display: flex;  align-items:center; align-content:center; justify-content: center; z-index: 10000; } .loader__element { border-radius: 100%; border: 5px solid #555; margin: 10px} .loader__element:nth-child(1) { animation: preloader .6s ease-in-out alternate infinite; } .loader__element:nth-child(2) { animation: preloader .6s ease-in-out alternate .2s infinite; } .loader__element:nth-child(3) { animation: preloader .6s ease-in-out alternate .4s infinite; } @keyframes preloader { 100% { transform: scale(2); } }</style>",document.body.appendChild(i.childNodes[1]),(i=document.createElement("DIV")).setAttribute("id","scriptXServices-PreviewWaitScreen"),i.className="loader";for(var a=0;a<3;a++){var l=document.createElement("SPAN");l.className="loader__element",i.appendChild(l)}document.body.appendChild(i)}else i.style.display="flex";MeadCo.ScriptX.Print.requestHtmlPreview(r,o,s,(function(e){MeadCo.log("Preview procesing completed: ",e),i.style.display="none"}),(function(r,o){var n=MeadCo.makeServiceEndPoint(MeadCo.ScriptX.Print.serviceUrl,"v1/Preview/"+o+"/"+encodeURIComponent(document.URL));MeadCo.log("Preview is available: "+n+", ... printer: "+e);var i=document.getElementById("scriptXServices-PreviewFrame");null==i&&((i=document.createElement("IFRAME")).setAttribute("id","scriptXServices-PreviewFrame"),i.style.width=0,i.style.height=0,i.style.display="none",i.style.visibility="hidden",document.body.appendChild(i),window.addEventListener("message",(function(r){MeadCo.log("message from: "+r+", ... printer: "+e),"preview-wired"===r.data&&(MeadCo.log("preview is wired ... printer: "+e),MeadCo.ScriptX.Print.setSystemDefaultPrinterAsync(e,(function(){MeadCo.log("system default printer set, request print preview"),i.contentWindow.postMessage("preview",MeadCo.ScriptX.Print.serviceUrl),window.setTimeout((function(){MeadCo.ScriptX.Print.setSystemDefaultPrinterAsync(t,(function(){}),(function(e){MeadCo.error("Preview failed to restore current printer after preview: "+e),MeadCo.ScriptX.Print.reportError(e)}))}),500)}),(function(e){MeadCo.error("Preview failed to set current printer for preview: "+e),MeadCo.ScriptX.Print.reportError(e)})))}))),i.setAttribute("src",n)}))}),(e=>{MeadCo.error(e)}))}return MeadCo.log("MeadCo.ScriptX.Print.HTML "+r+" loaded."),{PageMarginUnits:{DEFAULT:0,INCHES:1,MM:2},PageOrientation:o,PrintingPasses:n,settings:l,get documentContentToPrint(){return f()},frameContentToPrint:function(e){return g(e)},printDocument:function(e,t,r){return m(MeadCo.ScriptX.Print.ContentType.INNERHTML,f(),document.title,e,t,r)},printFrame:function(e,t,r,o){return m(MeadCo.ScriptX.Print.ContentType.INNERHTML,g(e),document.title,t,r,o)},previewDocument:function(){v(MeadCo.ScriptX.Print.ContentType.INNERHTML,f())},previewFrame:function(e){v(MeadCo.ScriptX.Print.ContentType.INNERHTML,g(e))},printFromUrl:function(e,t,r,o){return m(MeadCo.ScriptX.Print.ContentType.URL,e,e,t,r,o)},printHtml:function(e,t,r,o){return m(MeadCo.ScriptX.Print.ContentType.HTML,e,"HTML snippet",t,r,o)},connectLite:function(e,t){MeadCo.ScriptX.Print.connectLite(e,t)},connect:function(e,t,r){MeadCo.warn("Print.HTML SYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+s.page.units,!1,(function(e){MeadCo.log("got default html settings"),c(e.settings),null!==e.device&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters)}),r)},connectAsync:function(e,t,r,o){MeadCo.log("Print.HTML ASYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+s.page.units,!0,(function(e){MeadCo.log("got default html settings"),c(e.settings)?(null!==e.device&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters),r(2)):o("Server did not respond with valid settings")}),o)},get version(){return r}}})),extendMeadCoNamespace("MeadCo.ScriptX.Print.PDF",(function(){var e="1.16.2.2",t={DEFAULT:0,LANDSCAPE:1,PORTRAIT:2},r={DEFAULT:0,TRUE:1,FALSE:2},o={UNDEFINED:-1,NONE:0,FITTOPAPER:1,SHRINKLARGEPAGES:2},n={NORMAL:0,HIGH:1,LOSSLESS:2},i={jobDescription:"",pageRange:"",pageScaling:o.UNDEFINED,autoRotateCenter:r.DEFAULT,orientation:t.DEFAULT,monochrome:r.DEFAULT,normalise:r.DEFAULT,printQuality:n.NORMAL};return MeadCo.log("MeadCo.ScriptX.Print.PDF "+e+" loaded."),{PageOrientation:t,BooleanOption:r,PdfPageScaling:o,PdfPrintQuality:n,settings:i,resetSettings:function(){i.jobDescription="",i.pageRange="",i.pageScaling=o.UNDEFINED,i.autoRotateCenter=r.DEFAULT,i.orientation=t.DEFAULT,i.monochrome=r.DEFAULT,i.normalise=r.DEFAULT,i.printQuality=n.NORMAL},print:function(e,t,r,o){return function(e,t,r,o){return MeadCo.ScriptX.Print.printPdf(e,i,t,r,o)}(e,t,r,o)},connectLite:function(e,t){MeadCo.ScriptX.Print.connectLite(e,t)},connect:function(e,t){MeadCo.warn("Print.PDF SYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+settingsCache.page.units,!1,(function(e){MeadCo.log("got default html settings"),null!==e.device&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters)}))},connectAsync:function(e,t,r,o){MeadCo.log("Print.PDF ASYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults",!0,(function(e){MeadCo.log("got default html settings"),null!==e.device?(MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters),r(2)):o("Server did not respond with valid settings")}),o)},get version(){return e}}})),function(e,t,r){if(this[e]!==r||null!==document.getElementById(e)){if(MeadCo.log("ScriptX.Services ScriptX.factory emulation believes it may not be requred."),this[e]!==r&&MeadCo.log("this["+e+"] is defined"),null!==document.getElementById(e)&&MeadCo.log("document.getElementById("+e+") is defined"),this[e].object!==r)return void MeadCo.log("this["+e+"].object is defined -- not required!!!");MeadCo.log("this["+e+"].object is *not* defined")}MeadCo.log("ScriptX.Services ScriptX.factory emulation believes it is requred.");var o=function(){const e="1.16.2.2",t="8.3.0.0";let r="";const o=MeadCo.ScriptX.Print,n=MeadCo;let i=this;function a(e){n.log("factory emulation :: "+e)}return a("'factory' loaded "+e),{log:a,GetComponentVersion:function(n,s,l,c,d){a("factory.object.getcomponentversion: "+n);var u=e;switch(n.toLowerCase()){case"scriptx.factory":u=t;break;case"scriptx.factory.services":u=e;break;case"scriptx.services":if(""===r&&void 0!==o){var p=o.onErrorAction;o.onErrorAction=o.ErrorAction.THROW;try{var f=o.serviceDescription();if(null!==f)if("string"==typeof f.serviceVersion)r=f.serviceVersion;else{var g=f.serviceVersion;r=g.major+"."+g.minor+"."+g.build+"."+g.revision}}catch(t){r=e}o.onErrorAction=p}u=r;break;case"meadco.secmgr":try{u=i.secmgr.version}catch(e){u="0.0.0.0"}break;case"meadco.triprint":try{u=MeadCo.ScriptX.Print.HTML.version}catch(e){u="0.0.0.0"}}u=u.split("."),s[0]=u[0],l[0]=u[1],c[0]=u[2],d[0]=u[3]},ComponentVersionString:function(e){var t=new Object,r=new Object,o=new Object,n=new Object;return i.factory.GetComponentVersion(e,t,r,o,n),t[0]+"."+r[0]+"."+o[0]+"."+n[0]},get ScriptXVersion(){return t},get SecurityManagerVersion(){return t},IsUniqueIDAvailable:function(e){return!1},UniqueID:function(e){return 0},ResetUniqueID:function(e){return 0},baseURL:function(e){var t=document.createElement("a");return t.href=e,t.href},relativeURL:function(e){throw"MeadCo.ScriptX.Print :: relativeUrl is not implemented.\n\nPlease see https://github.com/medialize/URI.js for an alternative."},OnDocumentComplete:function(e,t){void 0===e.contentWindow?t():e.addEventListener("load",(function(e){t()}),{once:!0})},get rawPrinting(){var e="",t=MeadCo.ScriptX.Print;function r(r,o){var n=!1;if(void 0!==t){var a=factory.printing.printer;factory.printing.printer=e,r===t.ContentType.URL&&(o=i.factory.baseURL(o)),n=t.printDirect(r,o),factory.printing.printer=a}return n}return{get printer(){return e},set printer(t){var r=factory.printing.printer;if(factory.printing.printer=t,factory.printing.printer!==t)throw"Unknown printer";factory.printing.printer=r,e=t},printString:function(e){return void 0!==t&&r(t.ContentType.STRING,e)},printDocument:function(e){return void 0!==t&&r(t.ContentType.URL,e)}}},Shutdown:function(){return null},extendFactoryNamespace:function(e,t){var r=t();a("MeadCo factory extending namespace: "+e);for(var o=e.split("."),n=i,s=0;s<o.length;s++){var l=o[s];s===o.length-1?void 0===n[l]?(a("installing implementation at: "+l),n[l]=r):a("Warning - not overwriting package: "+l):void 0===n[l]?(a("initialising new: "+l),n[l]={}):a("using existing package: "+l),n=n[l]}},keyPressCtrlP:function(e){e.ctrlKey&&80==e.keyCode&&!e.shiftKey&&(e.preventDefault(),a("ctrl-p being handled."),i.print())}}}();this[e]=o}("factory"),"function"==typeof factory.extendFactoryNamespace&&factory.extendFactoryNamespace("factory.printing",(function(){const e=MeadCo.ScriptX.Print.HTML,t=MeadCo.ScriptX.Print.PDF,r=e.settings,o=MeadCo.ScriptX.Print,n=["html://","html4://","html5://"];let i=this,a="";function s(e,t,r){void 0===e&&(e=!0);const n=o.ensureSpoolingStatus();let i=!1,a=null;if(e){if(MeadCo.ScriptX.Print.UI){if(MeadCo.ScriptX.Print.UI.PrinterSettings((function(e){if(e){MeadCo.log("promptAndPrint requesting print ...");try{i=t(),r(i)}catch(e){a=e,MeadCo.error(e.message),r(!1)}}else r(!1);o.freeSpoolStatus(n)})),MeadCo.log("promptAndPrint exits ..."),null!=a)throw a.message;return i}MeadCo.warn("prompted print requested but no UI library loaded. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs")}try{i=t(),r(i)}catch(e){a=e,MeadCo.error(e.message),r(!1)}finally{o.freeSpoolStatus(n)}if(null!==a)throw a;return i}function l(t,r,o,a,l){var c,d,u=(c=t,"string"==typeof(d=n.find((function(e){return 0===c.indexOf(e)})))?c.substring(d.length):"");if(u.length>0){var p="<!doctype";u.substr(0,9).toLowerCase()===p&&(u=u.substring(u.indexOf(">")+1))}else t=i.factory.baseURL(t);return s(r,(function(){return MeadCo.log("printHtmlContent requesting print ..."),u.length>0?e.printHtml(u,null,a,l):e.printFromUrl(t,null,a,l)}),o)}function c(e,r,o,n,a){return void 0!==t?(e=i.factory.baseURL(e),s(r,(function(){return MeadCo.log("printPdfContent requesting print ..."),t.print(e,null,n,a)}),o)):(MeadCo.error("MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation."),o(!1),!1)}i.factory.log("factory.Printing loaded.");var d={get allPagesHeader(){return r.extraHeadersAndFooters.allPagesHeader},set allPagesHeader(e){r.extraHeadersAndFooters.allPagesHeader=e},get allPagesFooter(){return r.extraHeadersAndFooters.allPagesFooter},set allPagesFooter(e){r.extraHeadersAndFooters.allPagesFooter=e},get firstPageHeader(){return r.extraHeadersAndFooters.firstPageHeader},set firstPageHeader(e){r.extraHeadersAndFooters.firstPageHeader=e},get firstPageFooter(){return r.extraHeadersAndFooters.firstPageFooter},set firstPageFooter(e){r.extraHeadersAndFooters.firstPageFooter=e},get extraFirstPageFooter(){return r.extraHeadersAndFooters.extraFirstPageFooter},set extraFirstPageFooter(e){r.extraHeadersAndFooters.extraFirstPageFooter=e},get allHeaderHeight(){return r.extraHeadersAndFooters.allHeaderHeight},set allHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";r.extraHeadersAndFooters.allHeaderHeight=e},get allFooterHeight(){return r.extraHeadersAndFooters.allFooterHeight},set allFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";r.extraHeadersAndFooters.allFooterHeight=e},get firstHeaderHeight(){return r.extraHeadersAndFooters.firstHeaderHeight},set firstHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";r.extraHeadersAndFooters.firstHeaderHeight=e},get firstFooterHeight(){return r.extraHeadersAndFooters.firstFooterHeight},set firstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";r.extraHeadersAndFooters.firstFooterHeight=e},get extraFirstFooterHeight(){return r.extraHeadersAndFooters.extraFirstFooterHeight},set extraFirstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";r.extraHeadersAndFooters.extraFirstFooterHeight=e},get pageRange(){return r.pageRange},set pageRange(e){r.pageRange=e,void 0!==t&&(t.settings.pageRange=e)},get printingPass(){var t="";switch(r.printingPass){case e.PrintingPasses.DEFAULT:case e.PrintingPasses.ALL:t="all";break;case e.PrintingPasses.ODD:t="odd";break;case e.PrintingPasses.EVEN:t="even"}return t},set printingPass(t){var o=e.PrintingPasses.ALL;if("string"==typeof t)switch(t.toLowerCase()){case"odd":o=e.PrintingPasses.ODD;break;case"even":o=e.PrintingPasses.EVEN;break;case"odd&even":case"all":o=e.PrintingPasses.ALL}r.printingPass=o},get pdfPrintMode(){return void 0!==t?t.settings.printQuality:0},set pdfPrintMode(e){void 0!==t&&(t.settings.printQuality=e)}};return void 0!==o?(o.useAttributes(),"function"==typeof i.print&&(i.factory.log("overwriting outerScope.print"),i.print=function(){i.factory.log("window.print() called and being handled."),s(!0,(function(){return e.printDocument()}),(function(){}))}),null!=document.querySelector("[data-meadco-ctrlp='false']")||(i.factory.log("using addEventListener('keydown',factory.keyPressCtrlP) for Ctrl-P"),document.addEventListener("keydown",factory.keyPressCtrlP))):MeadCo.error("MeadCo.ScriptX.Print is not available to ScriptX.Services factory emulation."),{set header(e){i.factory.log("set factory.printing.header: "+e),r.header=e},get header(){return r.header},set footer(e){r.footer=e},get footer(){return r.footer},set headerFooterFont(e){r.headerFooterFont=e},get headerFooterFont(){return r.headerFooterFont},set orientation(t){switch(t.toLowerCase()){case"landscape":r.page.orientation=e.PageOrientation.LANDSCAPE;break;case"portrait":r.page.orientation=e.PageOrientation.PORTRAIT}},get orientation(){return r.page.orientation===e.PageOrientation.PORTRAIT?"portrait":"landscape"},set portrait(t){r.page.orientation=t?e.PageOrientation.PORTRAIT:e.PageOrientation.LANDSCAPE},get portrait(){return r.page.orientation===e.PageOrientation.PORTRAIT},set leftMargin(e){r.page.margins.left=e},get leftMargin(){return r.page.margins.left},set topMargin(e){r.page.margins.top=e},get topMargin(){return r.page.margins.top},set bottomMargin(e){r.page.margins.bottom=e},get bottomMargin(){return r.page.margins.bottom},set rightMargin(e){r.page.margins.right=e},get rightMargin(){return r.page.margins.right},set templateURL(e){},get templateURL(){return"MeadCo://default"},IsTemplateSupported:function(){return!0},PageSetup:function(e){"function"!=typeof e&&(MeadCo.warn("PageSetup API in ScriptX.Print Service is not synchronous, there is no return value."),e=function(e){MeadCo.log("PageSetupDlg: "+e)}),MeadCo.ScriptX.Print.UI?MeadCo.ScriptX.Print.UI.PageSetup(e):(MeadCo.error("PageSetup dialog in ScriptX.Services needs a dialog implementation. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs"),e(!1))},PrintSetup:function(e){"function"!=typeof e&&(MeadCo.warn("PrintSetup API in ScriptX.Print Service is not synchronous, there is no return value."),e=function(e){MeadCo.log("PrintSetupDlg: "+e)}),MeadCo.ScriptX.Print.UI?MeadCo.ScriptX.Print.UI.PrinterSettings(e):(MeadCo.error("PrintSettings dialog in ScriptX.Services needs a dialog implementation. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs"),e(!1))},Preview:function(t){if(t&&("object"!=typeof t||t.id)||(t=null),null!==t){var r="string"==typeof t?t:t.id;return e.previewFrame(r)}e.previewDocument()},Print:function(t,r,o){return o||(o=function(e){MeadCo.log("A print has started: "+e)}),r&&("object"!=typeof r||r.id)||(r=null),s(t,(function(){if(null!==r){var t="string"==typeof r?r:r.id;return e.printFrame(t)}return e.printDocument()}),o)},PrintHTML:function(e,t,r){return void 0===r&&(r=function(e){}),l(e,t,r)},PrintHTMLEx:function(e,t,r,o,n){return void 0===n&&(n=function(e){}),l(e,t,n,r,o)},PrintPDF:function(e,r,o,n,i,a){return void 0===a&&(a=function(e){}),void 0!==t?(t.resetSettings(),void 0!==e.pagescaling?t.settings.pageScaling=e.pagescaling:t.settings.pageScaling=o?t.PdfPageScaling.SHRINKLARGEPAGES:t.PdfPageScaling.UNDEFINED,void 0!==e.autorotatecenter?t.settings.autoRotateCenter=e.autorotatecenter?t.BooleanOption.TRUE:t.BooleanOption.FALSE:t.settings.autoRotateCenter=t.BooleanOption.DEFAULT,void 0!==e.orientation?t.settings.orientation=1===e.orientation?t.PageOrientation.PORTRAIT:t.PageOrientation.LANDSCAPE:t.settings.orientation=this.portrait?t.PageOrientation.PORTRAIT:t.PageOrientation.LANDSCAPE,void 0!==e.pages?t.settings.pageRange=e.pages:t.settings.pageRange=void 0!==n&&void 0!==i&&-1!==n&&-1!==i?n+"-"+i:"",void 0!==e.monochrome?t.settings.monochrome=e.monochrome?t.BooleanOption.TRUE:t.BooleanOption.FALSE:t.settings.monochrome=t.BooleanOption.DEFAULT,void 0!==e.normalise||void 0!==e.normalize?t.settings.normalise=e.normalise||e.normalize?t.BooleanOption.TRUE:t.BooleanOption.FALSE:t.settings.normalise=t.BooleanOption.DEFAULT,void 0!==e.printMode?t.settings.printQuality=e.printMode:void 0!==e.printQuality&&(t.settings.printQuality=e.printQuality),void 0!==e.jobname&&(t.settings.jobDescription=e.jobname),void 0!==e.jobName&&(t.settings.jobDescription=e.jobName),c(e.url,r,a)):(MeadCo.error("MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation."),a(!1),!1)},BatchPrintPDF:function(e,t){this.BatchPrintPDFEx(e,(function(){}),"BatchPrintPDF",t)},BatchPrintPDFEx:function(e,o,n,i){if(void 0===i&&(i=function(e){}),void 0!==t)return t.resetSettings(),t.settings.pageRange=d.pageRange,t.settings.pageScaling=-1===r.viewScale?t.PdfPageScaling.SHRINKLARGEPAGES:t.PdfPageScaling.UNDEFINED,t.settings.orientation=this.portrait?t.PageOrientation.PORTRAIT:t.PageOrientation.LANDSCAPE,t.settings.printQuality=d.pdfPrintMode,void c(e,!1,i,o,n);MeadCo.error("MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation."),i(!1)},set units(e){this.SetMarginMeasure(e)},get units(){return this.GetMarginMeasure()},set paperSize(e){o.deviceSettings.paperSizeName=e},get paperSize(){return o.deviceSettings.paperSizeName},set paperSource(e){o.deviceSettings.paperSourceName=e},get paperSource(){return o.deviceSettings.paperSourceName},set paperSource2(e){o.deviceSettings.paperSourceName=e},get paperSource2(){return o.deviceSettings.paperSourceName},get pageWidth(){return o.deviceSettings.paperPageSize.width},get pageHeight(){return o.deviceSettings.paperPageSize.height},set copies(e){o.deviceSettings.copies=e},get copies(){return o.deviceSettings.copies},set collate(e){o.deviceSettings.collate=!0===e||1===e?o.CollateOptions.TRUE:o.CollateOptions.FALSE},get collate(){return o.deviceSettings.collate===o.CollateOptions.TRUE},set duplex(e){o.deviceSettings.duplex=e},get duplex(){return o.deviceSettings.duplex},set duplex2(e){o.deviceSettings.duplex=e},get duplex2(){return o.deviceSettings.duplex},set onafterprint(e){o.reportFeatureNotImplemented("onafterprint",e)},set onbeforeprint(e){o.reportFeatureNotImplemented("onbeforeprint",e)},set onbeforeunload(e){a=e,window.addEventListener("beforeunload",(async t=>{MeadCo.log("beforeunload handler running"),MeadCo.ScriptX.Print.noJobsWaitingDelivery?MeadCo.log("no jobs are waiting client side"):(MeadCo.log("jobs are waiting client side, will prompt user (custom text is not supported by modern browsers)"),t.returnValue=e,t.preventDefault())}))},get onbeforeunload(){return a},set onpagesetup(e){o.reportFeatureNotImplemented("onpagesetup",e)},set onuserpagesetup(e){o.reportFeatureNotImplemented("onuserpagesetup",e)},set onuserprint(e){o.reportFeatureNotImplemented("onuserprint",e)},set onuserprintpreview(e){o.reportFeatureNotImplemented("onuserprintpreview",e)},DefaultPrinter:function(){return o.deviceSettingsFor("systemdefault").printerName},AddPrinterConnection:function(e){o.addPrinterConnection(e)},RemovePrinterConnection:function(e){o.removePrinterConnection(e)},AddPrinterConnectionAsync:function(e,t){o.addPrinterConnectionAsync(e,t,(function(e){o.reportError(e)}))},RemovePrinterConnectionAsync:function(e,t){o.removePrinterConnectionAsync(e,t,(function(e){o.reportError(e)}))},get CurrentPrinter(){return o.printerName},set CurrentPrinter(e){this.currentPrinter=e},get currentPrinter(){return o.printerName},set currentPrinter(e){if("string"==typeof e){var t=o.onErrorAction;o.onErrorAction=o.ErrorAction.THROW;try{o.printerName=e,o.onErrorAction=t}catch(e){throw o.onErrorAction=t,e}}},get printer(){return o.printerName},set printer(e){if("string"==typeof e){var t=o.onErrorAction;o.onErrorAction=o.ErrorAction.THROW;try{o.printerName=e,o.onErrorAction=t}catch(e){o.onErrorAction=t}}},set printToFileName(e){o.deviceSettings.printToFileName=e},get printBackground(){return r.printBackgroundColorsAndImages},set printBackground(e){r.printBackgroundColorsAndImages=e},get viewScale(){return r.viewScale},set viewScale(e){r.viewScale=e},set unprintableLeft(e){o.deviceSettings.unprintableMargins.left=e},get unprintableLeft(){return o.deviceSettings.unprintableMargins.left},set unprintableRight(e){o.deviceSettings.unprintableMargins.right=e},get unprintableRight(){return o.deviceSettings.unprintableMargins.right},set unprintableTop(e){o.deviceSettings.unprintableMargins.top=e},get unprintableTop(){return o.deviceSettings.unprintableMargins.top},set unprintableBottom(e){o.deviceSettings.unprintableMargins.bottom=e},get unprintableBottom(){return o.deviceSettings.unprintableMargins.bottom},EnumPrinters:function(e){var t=o.availablePrinterNames;if(t&&0!==t.length){if(e<t.length)return t[e]}else if(0===e)return this.CurrentPrinter;return""},EnumJobs:function(e,t,r){var n,i=o.queue,a=new Array;for(e=e.toLowerCase(),n=0;n<i.length;n++)i[n].printerName.toLowerCase()===e&&a.push(i[n]);return t<a.length?(r.name=a[t].jobName,a[t].status):0},GetJobsCount:function(e){var t,r=o.queue,n=0;for(e=e.toLowerCase(),t=0;t<r.length;t++)r[t].printerName.toLowerCase()===e&&n++;return n},printerControl:function(e){return{get Forms(){return o.deviceSettingsFor(e).forms},get Bins(){return o.deviceSettingsFor(e).bins},get forms(){return o.deviceSettingsFor(e).forms},get bins(){return o.deviceSettingsFor(e).bins},get name(){return e},get status(){return o.deviceSettingsFor(e).port},get port(){return o.deviceSettingsFor(e).port},get attributes(){return o.deviceSettingsFor(e).attributes},get serverName(){return o.deviceSettingsFor(e).serverName},get shareName(){return o.deviceSettingsFor(e).shareName},get location(){return o.deviceSettingsFor(e).location},get isLocal(){return o.deviceSettingsFor(e).isLocal},get isNetwork(){return o.deviceSettingsFor(e).isNetwork},get isShared(){return o.deviceSettingsFor(e).isShared},get Jobs(){o.reportFeatureNotImplemented("printerControl.Jobs")},Purge:function(){o.reportFeatureNotImplemented("printerControl.Purge()")},Pause:function(){o.reportFeatureNotImplemented("printerControl.Pause()")},Resume:function(){o.reportFeatureNotImplemented("printerControl.Resume()")}}},GetMarginMeasure:function(){return r.page.units===o.MeasurementUnits.INCHES?2:1},SetMarginMeasure:function(e){r.page.units=2===e?o.MeasurementUnits.INCHES:o.MeasurementUnits.MM},SetPrintScale:function(e){r.viewScale=e},IsSpooling:function(){return o.isSpooling},OwnQueue:function(){return null},SetPageRange:function(e,t,n){e&&o.reportFeatureNotImplemented("SetPageRange selection only"),r.pageRange=t+"-"+n},SetPreviewZoom:function(){o.reportFeatureNotImplemented("SetPreviewZoom")},Sleep:function(){o.reportFeatureNotImplemented("Sleep")},TotalPrintPages:function(){o.reportFeatureNotImplemented("TotalPrintPages")},WaitForSpoolingComplete:function(e,t){o.waitForSpoolingComplete(e,t)},enhancedFormatting:d,PolyfillInit:function(){return MeadCo.ScriptX.Print.isConnected||e.connect("","",(function(e){MeadCo.warn("Services server connection failed: "+e)})),MeadCo.ScriptX.Print.isConnected},PolyfillInitAsync:function(t,r){MeadCo.ScriptX.Print.isConnected?t(2):e.connectAsync("","",t,r)},get PolyfillAuthorisationCookie(){return MeadCo.ScriptX.Print.authorisationCookie},set PolyfillAuthorisationCookie(e){MeadCo.ScriptX.Print.authorisationCookie=e}}})),"function"==typeof factory.extendFactoryNamespace&&factory.extendFactoryNamespace("factory.object",(function(){return this.factory.log("factory.object loaded."),this.factory})),"function"==typeof factory.extendFactoryNamespace&&factory.extendFactoryNamespace("factory.object.js",(function(){return this.factory.log("factory.object.js loaded."),{FormatNumber:function(e){return isNaN(e)?0:"string"==typeof e?Number(e):e}}})),extendMeadCoNamespace("MeadCo.ScriptX.Print.Licensing",(function(){const e="1.16.2.0",t="v1/licensing";let r="",o=0,n="",i="No license applied";var a={};function s(e,t){var s=MeadCo.ScriptX.Print;void 0!==s&&"function"==typeof s.connectLite?s.connectLite(e,t):console.error("MeadCo.ScriptX.Print is not available"),r=t,a={},i="No license applied",o=0,n=""}function l(e,r){const o=MeadCo.ScriptX.Print;if(void 0===o||"function"!=typeof o.connectLite){var n="MeadCo.ScriptX.Licensing : MeadCo.ScriptX.Print API not available";if("function"==typeof r)return void r(n);throw new Error(n)}return a.length>0?("function"==typeof e&&e(a),a):(o.requestService(t,"GET",{},!0,"function"==typeof e,(function(t){i="",a={...a,...t},"function"!=typeof e||e(a)}),(function(e){i=e,"function"!=typeof r?MeadCo.warn("No reject function for: "+i):r(i)})),a)}function c(e,o,n,s,l){MeadCo.log("Apply license: "+e+",revision: "+o+", path: "+n);const c=MeadCo.ScriptX.Print;if(void 0===c||"function"!=typeof c.connectLite){var d="MeadCo.ScriptX.Licensing : MeadCo.ScriptX.Print API not available";if("function"==typeof l)return void l(d);MeadCo.warn("No reject function for: "+d)}const u=n.toLowerCase();"warehouse"!==u&&"securewarehouse"!==u&&(n=new URL(n,window.location.href).href,MeadCo.log("path updated to: "+n)),r=e;const p={Guid:e,Url:n,Revision:o};return c.requestService(t,"POST",p,!1,"function"==typeof s,(function(e){i="",a={...a,...e},"function"!=typeof s||s(a)}),(function(e){i=e,"function"!=typeof l||l(i)})),"function"!=typeof s?(MeadCo.log("returning applied (sync) license: "+a.company),a):0}return MeadCo.log("MeadCo.ScriptX.Print.Licensing "+e+" loaded."),{get version(){return e},connect:function(e,t){s(e,t)},connectLite:function(e,t,r,i){s(e,t),o=r,n=i},apply:function(e,t,r){return c(e,t,r)},applyAsync:function(e,t,r,o,n){c(e,t,r,o,n)},get result(){return""===i?0:5},get validLicense(){return void 0!==a.guid},get errorMessage(){return i},get detailOnError(){return i},get License(){return void 0!==a.guid?a:l(null,(function(e){throw new Error(e)}))},GetLicenseAsync:function(e,t){l(e,t)},PolyfillInit:function(){return void 0!==a.guid||""!==r&&(""===n||(c(r,o,n),void 0!==a.guid))},PolyfillInitAsync:function(e,t){void 0!==a.guid||""===n?e(a):c(r,o,n,e,t)}}})),function(e,t,r){if(this[e]!==r||null!==document.getElementById(e)){if(MeadCo.log("ScriptX.Services MeadCo Security Manager emulation believes it may not be required."),this[e]!==r&&MeadCo.log("this["+e+"] is defined"),null!==document.getElementById(e)&&MeadCo.log("document.getElementById("+e+") is defined"),this[e].object!==r)return void MeadCo.log("this["+e+"].object is defined -- not required!!!");MeadCo.log("this["+e+"].object is *not* defined")}MeadCo.log("ScriptX.Services MeadCo Security Manager emulation believes it is required.");var o=function(){const e=MeadCo,t=MeadCo.ScriptX.Print,r=MeadCo.ScriptX.Print.Licensing;function o(t){e.log("secmgr emulation :: "+t)}return this.extendSecMgrNamespace=function(e,t){const r=t();o("MeadCo security manager extending namespace2: "+e);const n=e.split(".");let i=this;for(let e=0;e<n.length;e++){const t=n[e];e===n.length-1?void 0===i[t]?(o("installing implementation at: "+t),i[t]=r):o("Warning - not overwriting package: "+t):void 0===i[t]?(o("initialising new: "+t),i[t]={}):o("using existing package: "+t),i=i[t]}},o("'secmgr' loaded."),"function"!=typeof r.GetLicenseAsync&&MeadCo.error("MeadCo.ScriptX.Print.Licensing not available"),"function"!=typeof t.useAttributes?MeadCo.warn("Attribute based licensing not available as MeadCo.ScriptX.Print is not available"):t.useAttributes(),{log:o,get version(){return"1.16.2.0"},get result(){return r.result},get validLicense(){return r.validLicense},get License(){return r.License},get errorMessage(){return r.errorMessage},GetLicenseAsync:function(e,t){r.GetLicenseAsync(e,t)},PolyfillInit:function(){return r.PolyfillInit()},PolyfillInitAsync:function(e,t){r.PolyfillInitAsync(e,t)}}}();this[e]=o}("secmgr"),"function"==typeof extendSecMgrNamespace&&extendSecMgrNamespace("secmgr.object",(function(){return this.secmgr.log("secmgr.object loaded."),this.secmgr})),function(e,t){"use strict";if(e){var r=e.createNS("MeadCo.ScriptX.Print.UI");r.version="1.16.2.0",e.log("MeadCo.ScriptX.Print.UI version is: "+r.version),r.PageSetup=function(e){if(!t.fn.modal&&!bootstrap.Modal)return console.error("MeadCo.ScriptX.Print.UI requires bootstrap Modal"),void e(!1);var r=!1,o="",n=(t.fn.modal.Constructor.VERSION||"").split(" ")[0].split(".")[0];if(t.fn.selectpicker&&"3"===n&&(o="selectpicker"),!t("#dlg-printoptions").length){var i;switch(console.log("UI.PageSetup bootstrap modal version: "+t.fn.modal.Constructor.VERSION+", major: "+n),n){case"3":i='<style>.modal-dialog legend { font-size: 1.2em; font-weight: bold; margin-bottom: 10px; } .modal-dialog fieldset { padding-bottom: 0px; } .modal-dialog .options-modal-body { padding-bottom: 0px !important; } .modal-dialog .checkbox2 {  padding-top: 0px !important; min-height: 0px !important; } .modal-dialog .radio2 { padding-top: 0px !important; min-height: 0px !important; } </style><div class="modal fade" id="dlg-printoptions"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">Page setup</h4></div><div class="modal-body form-horizontal options-modal-body"><fieldset><legend>Paper</legend><div class="form-group"><label class="col-md-4 control-label" for="fld-papersize">Size</label><div class="col-md-8"><select class="'+o+' form-control show-tick" id="fld-papersize"></select></div></div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="radio2"><label class="radio-inline"><input type="radio" value="2" id="fld-portrait" name="fld-orientation"> Portrait</label><label class="radio-inline"><input type="radio" value="1" id="fld-landscape" name="fld-orientation"> Landscape</label></div></div></div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-shrinktofit" id="fld-shrinktofit"> Shrink to fit</label></div></div></div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-printbackground" id="fld-printbackground"> Print background colour and images</label></div></div></div></fieldset><fieldset><legend>Margins</legend><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="radio2"><label class="radio-inline"><input type="radio" value="2" id="fld-millimetres" name="fld-measure"> Millimetres</label><label class="radio-inline"><input type="radio" value="1" id="fld-inches" name="fld-measure"> Inches</label></div></div></div><div class="form-group"><label class="control-label col-md-4">Left</label><div class="col-md-3"><input name="fld-marginL" id="fld-marginL" type="text" class="form-control text-right" data-rule="measure" value="1" /></div><label class="control-label col-md-2">Top</label><div class="col-md-3"><input name="fld-marginT" id="fld-marginT" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div><div class="form-group"><label class="control-label col-md-4">Right</label><div class="col-md-3"><input name="fld-marginR" id="fld-marginR" type="text" class="form-control text-right" data-rule="measure" value="1" /></div><label class="control-label col-md-2">Bottom</label><div class="col-md-3"><input name="fld-marginB" id="fld-marginB" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div></fieldset><fieldset><legend>Headers and footers</legend><div class="form-group"><label class="control-label col-md-4">Header</label><div class="col-md-8"><input type="text" name="fld-header" id="fld-header" class="form-control" style="max-width: none !important;" /></div></div><div class="form-group"><label class="control-label col-md-4">Footer</label><div class="col-md-8"><input type="text" name="fld-footer" id="fld-footer" class="form-control" style="max-width: none !important;" /></div></div></fieldset></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-saveoptions">OK</button><button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button></div></div>\x3c!-- /.modal-content --\x3e</div>\x3c!-- /.modal-dialog --\x3e</div>\x3c!-- /.modal --\x3e';break;case"4":i='<div class="modal fade" tabindex="-1" role="dialog" id="dlg-printoptions"><div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-lg" role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Page setup</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><div class="container-fluid"><fieldset><legend>Paper</legend><div class="form-group row"><label for="fld-papersize" class="col-md-4 col-form-label text-right col-form-label-sm">Size</label><div class="col-md-8"><select class="'+o+' form-control col-form-label-sm custom-select custom-select-sm" id="fld-papersize"></select></div></div><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-portrait" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Portrait</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-landscape" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Landscape</label></div></div></div><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-shrinktofit" id="fld-shrinktofit"><label class="form-check-label" for="fld-shrinktofit">Shrink to fit</label></div></div></div><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-printbackground" id="fld-printbackground"><label class="form-check-label" for="fld-printbackground">Print background colour and images</label></div></div></div></fieldset><fieldset><legend>Margins</legend><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-millimetres" name="fld-measure" /><label class="form-check-label" for="fld-millimetres">Millimetres</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-inches" name="fld-measure" /><label class="form-check-label" for="fld-inches">Inches</label></div></div></div><div class="form-group row"><label class="col-md-4 col-form-label text-right col-form-label-sm">Left</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginL" id="fld-marginL" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Top</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginT" id="fld-marginT" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div></div><div class="form-group row"><label class="col-md-4 col-form-label text-right col-form-label-sm">Right</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginR" id="fld-marginR" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Bottom</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginB" id="fld-marginB" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div></div></fieldset><fieldset><legend>Headers and footers</legend><div class="form-group row"><label for="fld-header" class="col-md-4 col-form-label text-right col-form-label-sm">Header</label><div class="col-md-8"><input type="text" name="fld-header" id="fld-header" class="form-control form-control-sm" /></div></div><div class="form-group row"><label for="fld-footer" class="col-md-4 col-form-label text-right col-form-label-sm">Footer</label><div class="col-md-8"><input type="text" name="fld-footer" id="fld-footer" class="form-control form-control-sm" /></div></div></fieldset></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-saveoptions">OK</button><button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button></div></div></div></div>';break;case"5":i='<div class="modal" tabindex="-1" id="dlg-printoptions"><div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-lg" role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Page setup</h5><button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button></div><div class="modal-body"><div class="bs-component"><fieldset><legend>Paper</legend><div class="row"><label for="fld-papersize" class="col-md-4 col-form-label text-right col-form-label-sm">Size</label><div class="col-md-8"><select class="'+o+' form-select form-select-sm" id="fld-papersize"></select></div></div><div class="row mt-2"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-portrait" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Portrait</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-landscape" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Landscape</label></div></div></div><div class="row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-shrinktofit" id="fld-shrinktofit"><label class="form-check-label" for="fld-shrinktofit">Shrink to fit</label></div></div></div><div class="row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-printbackground" id="fld-printbackground"><label class="form-check-label" for="fld-printbackground">Print background colour and images</label></div></div></div></fieldset><fieldset><legend>Margins</legend><div class="row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-millimetres" name="fld-measure" /><label class="form-check-label" for="fld-millimetres">Millimetres</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-inches" name="fld-measure" /><label class="form-check-label" for="fld-inches">Inches</label></div></div></div><div class="row mt-2"><label class="col-md-4 col-form-label text-right col-form-label-sm">Left</label><div class="col-md-3"><div class="input-group"><input name="fld-marginL" id="fld-marginL" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" data-rule="measure" value="1" /></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Top</label><div class="col-md-3"><div class="input-group"><input name="fld-marginT" id="fld-marginT" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" data-rule="measure" value="1" /></div></div></div><div class="row mt-2"><label class="col-md-4 col-form-label text-right col-form-label-sm">Right</label><div class="col-md-3"><div class="input-group"><input name="fld-marginR" id="fld-marginR" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" value="1" data-rule="measure"/></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Bottom</label><div class="col-md-3"><div class="input-group"><input name="fld-marginB" id="fld-marginB" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" value="1" data-rule="measure"/></div></div></div></fieldset><fieldset class="mt-2"><legend>Headers and footers</legend><div class="row"><label for="fld-header" class="col-md-4 col-form-label text-right col-form-label-sm">Header</label><div class="col-md-8"><input type="text" name="fld-header" id="fld-header" class="form-control form-control-sm" /></div></div><div class="row mt-2"><label for="fld-footer" class="col-md-4 col-form-label text-right col-form-label-sm">Footer</label><div class="col-md-8"><input type="text" name="fld-footer" id="fld-footer" class="form-control form-control-sm" /></div></div></fieldset></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-saveoptions">OK</button><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button></div></div></div></div>';break;default:return console.error("Unknown version of bootstrap: "+n),void e(!1)}t("body").append(i)}t('[name="fld-measure"]').off("change").on("change",(function(){const e="5"===n?"number":"text";switch(t(this).val()){case"2":t(`#dlg-printoptions input[type=${e}][data-rule=measure]`).each((function(){var e;(e=t(this)).val((2540*parseFloat(e.val())/100).toFixed(2))}));break;case"1":t(`#dlg-printoptions input[type=${e}][data-rule=measure]`).each((function(){var e;(e=t(this)).val((100*parseFloat(e.val())/2540).toFixed(2))}))}})),t("#btn-saveoptions").off("click").on("click",(function(e){e.preventDefault(),function(){var e=t("#dlg-printoptions"),r=MeadCo.ScriptX.Print.HTML.settings;e.length&&(r.page.orientation=e.find('[name="fld-orientation"]:checked').val(),r.printBackgroundColorsAndImages=e.find("#fld-printbackground").prop("checked"),r.viewScale=e.find("#fld-shrinktofit").prop("checked")?-1:100,r.page.units=parseInt(e.find('[name="fld-measure"]:checked').val()),r.page.margins.left=e.find("#fld-marginL").val(),r.page.margins.top=e.find("#fld-marginT").val(),r.page.margins.right=e.find("#fld-marginR").val(),r.page.margins.bottom=e.find("#fld-marginB").val(),r.header=e.find("#fld-header").val(),r.footer=e.find("#fld-footer").val(),MeadCo.ScriptX.Print.deviceSettings.paperSizeName=t("#fld-papersize").val())}(),r=!0,t("#dlg-printoptions").modal("hide")})),t("#dlg-printoptions").off("hidden.bs.modal").on("hidden.bs.modal",(function(){"function"==typeof e&&e(r)}));var a=t("#dlg-printoptions"),s=MeadCo.ScriptX.Print.HTML.settings;a.find('[name="fld-orientation"]').val([s.page.orientation]),a.find("#fld-printbackground").prop("checked",s.printBackgroundColorsAndImages),a.find("#fld-shrinktofit").prop("checked",-1==s.viewScale),a.find('[name="fld-measure"]').val([s.page.units]),a.find("#fld-marginL").val(s.page.margins.left),a.find("#fld-marginT").val(s.page.margins.top),a.find("#fld-marginR").val(s.page.margins.right),a.find("#fld-marginB").val(s.page.margins.bottom),a.find("#fld-header").val(s.header),a.find("#fld-footer").val(s.footer);var l=MeadCo.ScriptX.Print,c=t("#fld-papersize"),d=l.deviceSettingsFor(l.printerName).forms;for(var u in t("#fld-papersize > option").remove(),d)c.append("<option>"+d[u]+"</option>");c.hasClass("selectpicker")&&c.selectpicker("refresh"),c.val(MeadCo.ScriptX.Print.deviceSettings.paperSizeName),a.modal("show"),c.hasClass("selectpicker")&&c.selectpicker("refresh")},r.PrinterSettings=function(e){if(!t.fn.modal&&!bootstrap.Modal)return console.error("MeadCo.ScriptX.Print.UI requires bootstrap Modal"),void e(!1);var r=!1,i="",a=(t.fn.modal.Constructor.VERSION||"").split(" ")[0].split(".")[0];if(t.fn.selectpicker&&"3"===a&&(i="selectpicker"),!t("#dlg-printersettings").length){var s;switch(console.log("UI.PageSetup bootstrap modal version: "+t.fn.modal.Constructor.VERSION),a){case"3":s='<style>.modal-dialog legend { font-size: 1.2em; font-weight: bold; margin-bottom: 10px; } .modal-dialog fieldset { padding-bottom: 0px; } .modal-dialog .options-modal-body { padding-bottom: 0px !important; } .modal-dialog .checkbox2 {  padding-top: 0px !important; min-height: 0px !important; } .modal-dialog .radio2 { padding-top: 0px !important; min-height: 0px !important; } </style><div class="modal fade" id="dlg-printersettings"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">Print</h4></div><div class="modal-body form-horizontal options-modal-body"><div class="form-group"><label class="col-md-4 control-label" for="fld-printerselect">Printer</label><div class="col-md-8"><select class="'+i+' form-control show-tick" id="fld-printerselect"></select></div></div><div class="form-group"><label class="col-md-4 control-label" for="fld-papersource">Paper source</label><div class="col-md-8"><select class="'+i+' form-control show-tick" id="fld-papersource"></select></div></div><div class="form-group"><label class="control-label col-md-4">Copies</label><div class="col-md-3"><input name="fld-copies" id="fld-copies" type="text" class="form-control text-right" data-rule="quantity" value="1" /></div><div class="col-md-5"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-collate" id="fld-collate"> Collate</label></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-savesettings">Print</button><button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button></div></div>\x3c!-- /.modal-content --\x3e</div>\x3c!-- /.modal-dialog --\x3e</div>\x3c!-- /.modal --\x3e';break;case"4":s='<div class="modal fade" id="dlg-printersettings"><div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Print</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><div class="container-fluid"><div class="form-group row"><label for="fld-printerselect" class="col-md-4 col-form-label text-right col-form-label-sm">Printer</label><div class="col-md-8"><select class="'+i+' form-control col-form-label-sm custom-select custom-select-sm" id="fld-printerselect"></select></div></div><div class="form-group row"><label for="fld-papersource" class="col-md-4 col-form-label text-right col-form-label-sm">Paper source</label><div class="col-md-8"><select class="'+i+' form-control col-form-label-sm custom-select custom-select-sm" id="fld-papersource"></select></div></div><div class="form-group row align-items-center"><label for="fld-copies" class="col-md-4 col-form-label text-right col-form-label-sm">Copies</label><div class="col-md-3"><input name="fld-copies" id="fld-copies" type="text" class="form-control form-control-sm text-right" data-rule="quantity" value="1" /></div><div class="col-md-5"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-collate" id="fld-collate"><label class="form-check-label" for="fld-collate">Collate</label></div></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-savesettings">Print</button><button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button></div></div></div></div >';break;case"5":s='<div class="modal" id="dlg-printersettings"><div class="modal-dialog role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Print</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button></div><div class="modal-body"><div class="bs-component"><div class="row"><label for="fld-printerselect" class="col-md-4 form-label text-right col-form-label-sm">Printer</label><div class="col-md-8"><select class="'+i+' form-select form-select-sm" id="fld-printerselect"></select></div></div><div class="row mt-2"><label for="fld-papersource" class="col-md-4 form-label text-right col-form-label-sm">Paper source</label><div class="col-md-8"><select class="'+i+' form-select form-select-sm" id="fld-papersource"></select></div></div><div class="row g-3" style="margin-top:-8px"><label for="fld-copies" class="col-md-4 form-label text-right col-form-label-sm">Copies</label><div class="col-md-3"><input name="fld-copies" id="fld-copies" type="number" min="1" max="5" step="1" class="form-control form-control-sm text-right" data-rule="quantity" value="1" /></div><div class="col-md-5"><div class="form-check" style="margin-top: 4px"><input class="form-check-input" type="checkbox" name="fld-collate" id="fld-collate"><label class="form-check-label" for="fld-collate">Collate</label></div></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-savesettings">Print</button><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button></div></div></div></div >';break;default:return console.error("Unknown version of bootstrap: "+a),void e(!1)}t("body").append(s),t("#dlg-printersettings #fld-printerselect").change((function(e){o(t(this).val())}))}t("#btn-savesettings").off("click").on("click",(function(e){e.preventDefault(),function(){var e=t("#dlg-printersettings"),r=MeadCo.ScriptX.Print;if(e.length){var o=r.onErrorAction;r.onErrorAction=r.ErrorAction.THROW;try{r.printerName=t("#fld-printerselect").val(),r.onErrorAction=o}catch(e){r.onErrorAction=o}var n=r.deviceSettings;n.paperSourceName=t("#fld-papersource").val(),n.collate=e.find("#fld-collate").prop("checked")?r.CollateOptions.TRUE:r.CollateOptions.FALSE,n.copies=e.find("#fld-copies").val()}}(),r=!0,t("#dlg-printersettings").modal("hide")})),t("#dlg-printersettings").off("hidden.bs.modal").on("hidden.bs.modal",(function(){"function"==typeof e&&e(r)})),function(){var e=MeadCo.ScriptX.Print,r=t("#fld-printerselect"),n=e.availablePrinterNames;t("#fld-printerselect > option").remove();for(var i=0;i<n.length;i++)r.append("<option>"+n[i]);r.val(e.printerName),r.hasClass("selectpicker")?r.selectpicker("refresh"):o(e.printerName)}(),function(){var e=MeadCo.ScriptX.Print,r=e.deviceSettings;n();var o=t("#dlg-printersettings");o.find("#fld-collate").prop("checked",r.collate===e.CollateOptions.TRUE),o.find("#fld-copies").val(r.copies)}(),"5"===a?new bootstrap.Modal(document.getElementById("dlg-printersettings"),{backdrop:"static",keyboard:!1,show:!1}).show():t("#dlg-printersettings").modal("show"),"selectpicker"===i&&t("#dlg-printersettings .selectpicker").selectpicker("refresh")}}function o(e){var t=MeadCo.ScriptX.Print,r=t.printerName,o=t.deviceSettings.paperSourceName,i=t.onErrorAction;t.onErrorAction=t.ErrorAction.THROW;try{t.printerName=e,n()}catch(e){alert("Sorry, an error has occurred:\n\n"+e.message)}try{t.printerName=r,t.deviceSettings.paperSourceName=o}catch(e){alert("Sorry, an error has occurred restoring current printer settings:\n\n"+e.message)}t.onErrorAction=i}function n(){var e=MeadCo.ScriptX.Print;e.deviceSettingsForAsync(e.printerName,(e=>{var r=e.bins,o=t("#fld-papersource");t("#fld-papersource > option").remove();for(var n=0;n<r.length;n++)o.append("<option>"+r[n]);o.val(e.paperSourceName),o.hasClass("selectpicker")&&o.selectpicker("refresh")}),(e=>{MeadCo.ScriptX.Print.reportError(e)}))}}(window.MeadCo=window.MeadCo||null,jQuery);
//# sourceMappingURL=meadco-scriptxservicesUI.min.js.map