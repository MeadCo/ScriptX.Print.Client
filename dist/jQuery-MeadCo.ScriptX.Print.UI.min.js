!function(l,e,o){"use strict";if(l){var a=l.createNS("MeadCo.ScriptX.Print.UI");a.version="1.15.2.0",l.log("MeadCo.ScriptX.Print.UI version is: "+a.version),a.PageSetup=function(l){if(!e.fn.modal&&!bootstrap.Modal)return console.error("MeadCo.ScriptX.Print.UI requires bootstrap Modal"),void l(!1);var o=!1,a="",t=(e.fn.modal.Constructor.VERSION||"").split(" ")[0].split(".")[0];if(e.fn.selectpicker&&"3"===t&&(a="selectpicker"),!e("#dlg-printoptions").length){var i;switch(console.log("UI.PageSetup bootstrap modal version: "+e.fn.modal.Constructor.VERSION+", major: "+t),t){case"3":i='<style>.modal-dialog legend { font-size: 1.2em; font-weight: bold; margin-bottom: 10px; } .modal-dialog fieldset { padding-bottom: 0px; } .modal-dialog .options-modal-body { padding-bottom: 0px !important; } .modal-dialog .checkbox2 {  padding-top: 0px !important; min-height: 0px !important; } .modal-dialog .radio2 { padding-top: 0px !important; min-height: 0px !important; } </style><div class="modal fade" id="dlg-printoptions"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">Page setup</h4></div><div class="modal-body form-horizontal options-modal-body"><fieldset><legend>Paper</legend><div class="form-group"><label class="col-md-4 control-label" for="fld-papersize">Size</label><div class="col-md-8"><select class="'+a+' form-control show-tick" id="fld-papersize"></select></div></div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="radio2"><label class="radio-inline"><input type="radio" value="2" id="fld-portrait" name="fld-orientation"> Portrait</label><label class="radio-inline"><input type="radio" value="1" id="fld-landscape" name="fld-orientation"> Landscape</label></div></div></div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-shrinktofit" id="fld-shrinktofit"> Shrink to fit</label></div></div></div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-printbackground" id="fld-printbackground"> Print background colour and images</label></div></div></div></fieldset><fieldset><legend>Margins</legend><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="radio2"><label class="radio-inline"><input type="radio" value="2" id="fld-millimetres" name="fld-measure"> Millimetres</label><label class="radio-inline"><input type="radio" value="1" id="fld-inches" name="fld-measure"> Inches</label></div></div></div><div class="form-group"><label class="control-label col-md-4">Left</label><div class="col-md-3"><input name="fld-marginL" id="fld-marginL" type="text" class="form-control text-right" data-rule="measure" value="1" /></div><label class="control-label col-md-2">Top</label><div class="col-md-3"><input name="fld-marginT" id="fld-marginT" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div><div class="form-group"><label class="control-label col-md-4">Right</label><div class="col-md-3"><input name="fld-marginR" id="fld-marginR" type="text" class="form-control text-right" data-rule="measure" value="1" /></div><label class="control-label col-md-2">Bottom</label><div class="col-md-3"><input name="fld-marginB" id="fld-marginB" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div></fieldset><fieldset><legend>Headers and footers</legend><div class="form-group"><label class="control-label col-md-4">Header</label><div class="col-md-8"><input type="text" name="fld-header" id="fld-header" class="form-control" style="max-width: none !important;" /></div></div><div class="form-group"><label class="control-label col-md-4">Footer</label><div class="col-md-8"><input type="text" name="fld-footer" id="fld-footer" class="form-control" style="max-width: none !important;" /></div></div></fieldset></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-saveoptions">OK</button><button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button></div></div>\x3c!-- /.modal-content --\x3e</div>\x3c!-- /.modal-dialog --\x3e</div>\x3c!-- /.modal --\x3e';break;case"4":i='<div class="modal fade" tabindex="-1" role="dialog" id="dlg-printoptions"><div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-lg" role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Page setup</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><div class="container-fluid"><fieldset><legend>Paper</legend><div class="form-group row"><label for="fld-papersize" class="col-md-4 col-form-label text-right col-form-label-sm">Size</label><div class="col-md-8"><select class="'+a+' form-control col-form-label-sm custom-select custom-select-sm" id="fld-papersize"></select></div></div><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-portrait" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Portrait</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-landscape" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Landscape</label></div></div></div><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-shrinktofit" id="fld-shrinktofit"><label class="form-check-label" for="fld-shrinktofit">Shrink to fit</label></div></div></div><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-printbackground" id="fld-printbackground"><label class="form-check-label" for="fld-printbackground">Print background colour and images</label></div></div></div></fieldset><fieldset><legend>Margins</legend><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-millimetres" name="fld-measure" /><label class="form-check-label" for="fld-millimetres">Millimetres</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-inches" name="fld-measure" /><label class="form-check-label" for="fld-inches">Inches</label></div></div></div><div class="form-group row"><label class="col-md-4 col-form-label text-right col-form-label-sm">Left</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginL" id="fld-marginL" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Top</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginT" id="fld-marginT" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div></div><div class="form-group row"><label class="col-md-4 col-form-label text-right col-form-label-sm">Right</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginR" id="fld-marginR" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Bottom</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginB" id="fld-marginB" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div></div></fieldset><fieldset><legend>Headers and footers</legend><div class="form-group row"><label for="fld-header" class="col-md-4 col-form-label text-right col-form-label-sm">Header</label><div class="col-md-8"><input type="text" name="fld-header" id="fld-header" class="form-control form-control-sm" /></div></div><div class="form-group row"><label for="fld-footer" class="col-md-4 col-form-label text-right col-form-label-sm">Footer</label><div class="col-md-8"><input type="text" name="fld-footer" id="fld-footer" class="form-control form-control-sm" /></div></div></fieldset></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-saveoptions">OK</button><button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button></div></div></div></div>';break;case"5":i='<div class="modal" tabindex="-1" id="dlg-printoptions"><div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-lg" role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Page setup</h5><button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button></div><div class="modal-body"><div class="bs-component"><fieldset><legend>Paper</legend><div class="row"><label for="fld-papersize" class="col-md-4 col-form-label text-right col-form-label-sm">Size</label><div class="col-md-8"><select class="'+a+' form-select form-select-sm" id="fld-papersize"></select></div></div><div class="row mt-2"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-portrait" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Portrait</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-landscape" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Landscape</label></div></div></div><div class="row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-shrinktofit" id="fld-shrinktofit"><label class="form-check-label" for="fld-shrinktofit">Shrink to fit</label></div></div></div><div class="row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-printbackground" id="fld-printbackground"><label class="form-check-label" for="fld-printbackground">Print background colour and images</label></div></div></div></fieldset><fieldset><legend>Margins</legend><div class="row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-millimetres" name="fld-measure" /><label class="form-check-label" for="fld-millimetres">Millimetres</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-inches" name="fld-measure" /><label class="form-check-label" for="fld-inches">Inches</label></div></div></div><div class="row mt-2"><label class="col-md-4 col-form-label text-right col-form-label-sm">Left</label><div class="col-md-3"><div class="input-group"><input name="fld-marginL" id="fld-marginL" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" data-rule="measure" value="1" /></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Top</label><div class="col-md-3"><div class="input-group"><input name="fld-marginT" id="fld-marginT" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" data-rule="measure" value="1" /></div></div></div><div class="row mt-2"><label class="col-md-4 col-form-label text-right col-form-label-sm">Right</label><div class="col-md-3"><div class="input-group"><input name="fld-marginR" id="fld-marginR" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" value="1" data-rule="measure"/></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Bottom</label><div class="col-md-3"><div class="input-group"><input name="fld-marginB" id="fld-marginB" type="number" min="0" max="30" step="0.1" class="form-control text-right form-control-sm" value="1" data-rule="measure"/></div></div></div></fieldset><fieldset class="mt-2"><legend>Headers and footers</legend><div class="row"><label for="fld-header" class="col-md-4 col-form-label text-right col-form-label-sm">Header</label><div class="col-md-8"><input type="text" name="fld-header" id="fld-header" class="form-control form-control-sm" /></div></div><div class="row mt-2"><label for="fld-footer" class="col-md-4 col-form-label text-right col-form-label-sm">Footer</label><div class="col-md-8"><input type="text" name="fld-footer" id="fld-footer" class="form-control form-control-sm" /></div></div></fieldset></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-saveoptions">OK</button><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button></div></div></div></div>';break;default:return console.error("Unknown version of bootstrap: "+t),void l(!1)}e("body").append(i)}e('[name="fld-measure"]').off("change").on("change",(function(){const l="5"===t?"number":"text";switch(e(this).val()){case"2":e(`#dlg-printoptions input[type=${l}][data-rule=measure]`).each((function(){var l;(l=e(this)).val((2540*parseFloat(l.val())/100).toFixed(2))}));break;case"1":e(`#dlg-printoptions input[type=${l}][data-rule=measure]`).each((function(){var l;(l=e(this)).val((100*parseFloat(l.val())/2540).toFixed(2))}))}})),e("#btn-saveoptions").off("click").on("click",(function(l){l.preventDefault(),function(){var l=e("#dlg-printoptions"),o=MeadCo.ScriptX.Print.HTML.settings;l.length&&(o.page.orientation=l.find('[name="fld-orientation"]:checked').val(),o.printBackgroundColorsAndImages=l.find("#fld-printbackground").prop("checked"),o.viewScale=l.find("#fld-shrinktofit").prop("checked")?-1:100,o.page.units=parseInt(l.find('[name="fld-measure"]:checked').val()),o.page.margins.left=l.find("#fld-marginL").val(),o.page.margins.top=l.find("#fld-marginT").val(),o.page.margins.right=l.find("#fld-marginR").val(),o.page.margins.bottom=l.find("#fld-marginB").val(),o.header=l.find("#fld-header").val(),o.footer=l.find("#fld-footer").val(),MeadCo.ScriptX.Print.deviceSettings.paperSizeName=e("#fld-papersize").val())}(),o=!0,e("#dlg-printoptions").modal("hide")})),e("#dlg-printoptions").off("hidden.bs.modal").on("hidden.bs.modal",(function(){"function"==typeof l&&l(o)}));var d=e("#dlg-printoptions"),s=MeadCo.ScriptX.Print.HTML.settings;d.find('[name="fld-orientation"]').val([s.page.orientation]),d.find("#fld-printbackground").prop("checked",s.printBackgroundColorsAndImages),d.find("#fld-shrinktofit").prop("checked",-1==s.viewScale),d.find('[name="fld-measure"]').val([s.page.units]),d.find("#fld-marginL").val(s.page.margins.left),d.find("#fld-marginT").val(s.page.margins.top),d.find("#fld-marginR").val(s.page.margins.right),d.find("#fld-marginB").val(s.page.margins.bottom),d.find("#fld-header").val(s.header),d.find("#fld-footer").val(s.footer);var r=MeadCo.ScriptX.Print,c=e("#fld-papersize"),n=r.deviceSettingsFor(r.printerName).forms;for(var m in e("#fld-papersize > option").remove(),n)c.append("<option>"+n[m]+"</option>");c.hasClass("selectpicker")&&c.selectpicker("refresh"),c.val(MeadCo.ScriptX.Print.deviceSettings.paperSizeName),d.modal("show"),c.hasClass("selectpicker")&&c.selectpicker("refresh")},a.PrinterSettings=function(l){if(!e.fn.modal&&!bootstrap.Modal)return console.error("MeadCo.ScriptX.Print.UI requires bootstrap Modal"),void l(!1);var o=!1,a="",d=(e.fn.modal.Constructor.VERSION||"").split(" ")[0].split(".")[0];if(e.fn.selectpicker&&"3"===d&&(a="selectpicker"),!e("#dlg-printersettings").length){var s;switch(console.log("UI.PageSetup bootstrap modal version: "+e.fn.modal.Constructor.VERSION),d){case"3":s='<style>.modal-dialog legend { font-size: 1.2em; font-weight: bold; margin-bottom: 10px; } .modal-dialog fieldset { padding-bottom: 0px; } .modal-dialog .options-modal-body { padding-bottom: 0px !important; } .modal-dialog .checkbox2 {  padding-top: 0px !important; min-height: 0px !important; } .modal-dialog .radio2 { padding-top: 0px !important; min-height: 0px !important; } </style><div class="modal fade" id="dlg-printersettings"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">Print</h4></div><div class="modal-body form-horizontal options-modal-body"><div class="form-group"><label class="col-md-4 control-label" for="fld-printerselect">Printer</label><div class="col-md-8"><select class="'+a+' form-control show-tick" id="fld-printerselect"></select></div></div><div class="form-group"><label class="col-md-4 control-label" for="fld-papersource">Paper source</label><div class="col-md-8"><select class="'+a+' form-control show-tick" id="fld-papersource"></select></div></div><div class="form-group"><label class="control-label col-md-4">Copies</label><div class="col-md-3"><input name="fld-copies" id="fld-copies" type="text" class="form-control text-right" data-rule="quantity" value="1" /></div><div class="col-md-5"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-collate" id="fld-collate"> Collate</label></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-savesettings">Print</button><button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button></div></div>\x3c!-- /.modal-content --\x3e</div>\x3c!-- /.modal-dialog --\x3e</div>\x3c!-- /.modal --\x3e';break;case"4":s='<div class="modal fade" id="dlg-printersettings"><div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Print</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><div class="container-fluid"><div class="form-group row"><label for="fld-printerselect" class="col-md-4 col-form-label text-right col-form-label-sm">Printer</label><div class="col-md-8"><select class="'+a+' form-control col-form-label-sm custom-select custom-select-sm" id="fld-printerselect"></select></div></div><div class="form-group row"><label for="fld-papersource" class="col-md-4 col-form-label text-right col-form-label-sm">Paper source</label><div class="col-md-8"><select class="'+a+' form-control col-form-label-sm custom-select custom-select-sm" id="fld-papersource"></select></div></div><div class="form-group row align-items-center"><label for="fld-copies" class="col-md-4 col-form-label text-right col-form-label-sm">Copies</label><div class="col-md-3"><input name="fld-copies" id="fld-copies" type="text" class="form-control form-control-sm text-right" data-rule="quantity" value="1" /></div><div class="col-md-5"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-collate" id="fld-collate"><label class="form-check-label" for="fld-collate">Collate</label></div></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-savesettings">Print</button><button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button></div></div></div></div >';break;case"5":s='<div class="modal" id="dlg-printersettings"><div class="modal-dialog role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Print</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button></div><div class="modal-body"><div class="bs-component"><div class="row"><label for="fld-printerselect" class="col-md-4 form-label text-right col-form-label-sm">Printer</label><div class="col-md-8"><select class="'+a+' form-select form-select-sm" id="fld-printerselect"></select></div></div><div class="row mt-2"><label for="fld-papersource" class="col-md-4 form-label text-right col-form-label-sm">Paper source</label><div class="col-md-8"><select class="'+a+' form-select form-select-sm" id="fld-papersource"></select></div></div><div class="row g-3" style="margin-top:-8px"><label for="fld-copies" class="col-md-4 form-label text-right col-form-label-sm">Copies</label><div class="col-md-3"><input name="fld-copies" id="fld-copies" type="number" min="1" max="5" step="1" class="form-control form-control-sm text-right" data-rule="quantity" value="1" /></div><div class="col-md-5"><div class="form-check" style="margin-top: 4px"><input class="form-check-input" type="checkbox" name="fld-collate" id="fld-collate"><label class="form-check-label" for="fld-collate">Collate</label></div></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-savesettings">Print</button><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button></div></div></div></div >';break;default:return console.error("Unknown version of bootstrap: "+d),void l(!1)}e("body").append(s),e("#dlg-printersettings #fld-printerselect").change((function(l){t(e(this).val())}))}if(e("#btn-savesettings").off("click").on("click",(function(l){l.preventDefault(),function(){var l=e("#dlg-printersettings"),o=MeadCo.ScriptX.Print;if(l.length){var a=o.onErrorAction;o.onErrorAction=o.ErrorAction.THROW;try{o.printerName=e("#fld-printerselect").val(),o.onErrorAction=a}catch(l){o.onErrorAction=a}var t=o.deviceSettings;t.paperSourceName=e("#fld-papersource").val(),t.collate=l.find("#fld-collate").prop("checked")?o.CollateOptions.TRUE:o.CollateOptions.FALSE,t.copies=l.find("#fld-copies").val()}}(),o=!0,e("#dlg-printersettings").modal("hide")})),e("#dlg-printersettings").off("hidden.bs.modal").on("hidden.bs.modal",(function(){"function"==typeof l&&l(o)})),function(){var l=MeadCo.ScriptX.Print,o=e("#fld-printerselect"),a=l.availablePrinterNames;e("#fld-printerselect > option").remove();for(var i=0;i<a.length;i++)o.append("<option>"+a[i]);o.val(l.printerName),o.hasClass("selectpicker")?o.selectpicker("refresh"):t(l.printerName)}(),function(){var l=MeadCo.ScriptX.Print,o=l.deviceSettings;i();var a=e("#dlg-printersettings");a.find("#fld-collate").prop("checked",o.collate===l.CollateOptions.TRUE),a.find("#fld-copies").val(o.copies)}(),"5"===d){new bootstrap.Modal(document.getElementById("dlg-printersettings"),{backdrop:"static",keyboard:!1,show:!1}).show()}else e("#dlg-printersettings").modal("show");"selectpicker"===a&&e("#dlg-printersettings .selectpicker").selectpicker("refresh")}}function t(l){var e=MeadCo.ScriptX.Print,o=e.printerName,a=e.deviceSettings.paperSourceName,t=e.onErrorAction;e.onErrorAction=e.ErrorAction.THROW;try{e.printerName=l,i()}catch(l){alert("Sorry, an error has occurred:\n\n"+l.message)}try{e.printerName=o,e.deviceSettings.paperSourceName=a}catch(l){alert("Sorry, an error has occurred restoring current printer settings:\n\n"+l.message)}e.onErrorAction=t}function i(){var l=MeadCo.ScriptX.Print;l.deviceSettingsForAsync(l.printerName,(l=>{var o=l.bins,a=e("#fld-papersource");e("#fld-papersource > option").remove();for(var t=0;t<o.length;t++)a.append("<option>"+o[t]);a.val(l.paperSourceName),a.hasClass("selectpicker")&&a.selectpicker("refresh")}),(l=>{MeadCo.ScriptX.Print.reportError(l)}))}}(window.MeadCo=window.MeadCo||null,jQuery);
//# sourceMappingURL=jQuery-MeadCo.ScriptX.Print.UI.min.js.map
