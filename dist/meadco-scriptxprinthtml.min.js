extendMeadCoNamespace("MeadCo.ScriptX.Print.HTML",(function(){var e,t,r="1.16.1.0",n={DEFAULT:0,INCHES:1,MM:2},o={DEFAULT:0,LANDSCAPE:1,PORTRAIT:2},a={DEFAULT:0,ALL:1,ODD:2,EVEN:3},i={DEFAULT:0,TRUE:1,FALSE:2},s={header:null,footer:null,headerFooterFont:null,viewScale:0,locale:navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language,timezoneOffset:0,shortDateFormat:"",longDateFormat:"",printBackgroundColorsAndImages:!1,page:{orientation:o.PORTRAIT,units:MeadCo.ScriptX.Print.MeasurementUnits.DEFAULT,margins:{left:"",top:"",bottom:"",right:""}},extraHeadersAndFooters:{},pageRange:"",printingPass:a.ALL,jobTitle:"",documentUrl:document.URL},l={set header(e){MeadCo.log("MeadCo.ScriptX.Print.HTML setting header: "+e),e&&0===e.length&&(e="%20"),s.header=e},get header(){return s.header&&"%20"!==s.header?s.header:""},set footer(e){e&&0===e.length&&(e="%20"),s.footer=e},get footer(){return s.footer&&"%20"!==s.footer?s.footer:""},set headerFooterFont(e){e&&0===e.length&&(e="%20"),s.headerFooterFont=e},get headerFooterFont(){return s.headerFooterFont&&"%20"!==s.headerFooterFont?s.headerFooterFont:""},get locale(){return s.locale},set viewScale(e){s.viewScale=e},get viewScale(){return s.viewScale},set locale(e){s.locale=e},set shortDateFormat(e){s.shortDateFormat=e},set longDateFormat(e){s.longDateFormat=e},set printBackgroundColorsAndImages(e){s.printBackgroundColorsAndImages=e?i.TRUE:i.FALSE},get printBackgroundColorsAndImages(){return s.printBackgroundColorsAndImages===i.TRUE},extraHeadersAndFooters:{get allPagesHeader(){return s.extraHeadersAndFooters.allPagesHeader},set allPagesHeader(e){s.extraHeadersAndFooters.allPagesHeader=e},get allPagesFooter(){return s.extraHeadersAndFooters.allPagesFooter},set allPagesFooter(e){s.extraHeadersAndFooters.allPagesFooter=e},get firstPageHeader(){return s.extraHeadersAndFooters.firstPageHeader},set firstPageHeader(e){s.extraHeadersAndFooters.firstPageHeader=e},get firstPageFooter(){return s.extraHeadersAndFooters.firstPageFooter},set firstPageFooter(e){s.extraHeadersAndFooters.firstPageFooter=e},get extraFirstPageFooter(){return s.extraHeadersAndFooters.extraFirstPageFooter},set extraFirstPageFooter(e){s.extraHeadersAndFooters.extraFirstPageFooter=e},get allHeaderHeight(){return s.extraHeadersAndFooters.allHeaderHeight},set allHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.allHeaderHeight=e},get allFooterHeight(){return s.extraHeadersAndFooters.allFooterHeight},set allFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.allFooterHeight=e},get firstHeaderHeight(){return s.extraHeadersAndFooters.firstHeaderHeight},set firstHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.firstHeaderHeight=e},get firstFooterHeight(){return s.extraHeadersAndFooters.firstFooterHeight},set firstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.firstFooterHeight=e},get extraFirstFooterHeight(){return s.extraHeadersAndFooters.extraFirstFooterHeight},set extraFirstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.extraFirstFooterHeight=e}},page:{set orientation(e){s.page.orientation=e},get orientation(){return s.page.orientation},set units(e){s.page.units=e},get units(){return s.page.units},margins:{set left(e){s.page.margins.left=e},get left(){return s.page.margins.left},set top(e){s.page.margins.top=e},get top(){return s.page.margins.top},set bottom(e){s.page.margins.bottom=e},get bottom(){return s.page.margins.bottom},set right(e){s.page.margins.right=e},get right(){return s.page.margins.right}}},get pageRange(){return s.pageRange},set pageRange(e){s.pageRange=e},get printingPass(){return s.printingPass},set printingPass(e){if(!("number"==typeof e&&e>=a.DEFAULT&&e<=a.EVEN))throw"Invalid argument";s.printingPass=e}};function d(e){return null!==e?((s=e).locale=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language,s.timezoneOffset=(new Date).getTimezoneOffset(),s.documentUrl=document.URL,MeadCo.log("Settings cache updated, .locale: ["+s.locale+"], .offset: "+s.timezoneOffset),!0):(MeadCo.warn("Igoring attempt to updateSettingsWithServerDefaults with null"),!1)}function c(){var e=window.location.port?":"+window.location.port:"";return window.location.protocol+"//"+window.location.hostname+e+window.location.pathname}function u(e){jQuery(":checked",e).each((function(){this.setAttribute("checked","checked")}));for(var t="text search number email datetime datetime-local date month week time tel url color range".split(" "),r=t.length,n=0;n<r;n++)jQuery("input[type="+t[n]+"]",e).each((function(){this.setAttribute("value",jQuery(this).val())}));jQuery("select",e).each((function(){var e=jQuery(this);jQuery("option",e).each((function(){e.val()===jQuery(this).val()&&this.setAttribute("selected","selected")}))})),jQuery("textarea",e).each((function(){this.innerHTML=jQuery(this).val()}))}function g(e){e.querySelectorAll(":checked").forEach((e=>{e.setAttribute("checked","checked")})),"text search number email datetime datetime-local date month week time tel url color range".split(" ").forEach((t=>{e.querySelectorAll("input[type="+t+"]").forEach((e=>{e.setAttribute("value",e.value)}))})),e.querySelectorAll("select").forEach((e=>{e.querySelectorAll("option").forEach((t=>{t.removeAttribute("checked"),e.value===t.value?t.setAttribute("selected","selected"):t.removeAttribute("selected")}))})),e.querySelectorAll("textarea").forEach((e=>{e.innerHTML=e.value}))}function m(e){u(e);var t=e.clone();if(jQuery("script",t).remove(),jQuery("object",t).remove(),!jQuery("head>base",t).length){MeadCo.log("No base element, fabricating one to: "+c());var r=jQuery("<base>",{href:c()});jQuery("head",t).prepend(r)}return t.html()}function p(e){g(e.documentElement);let t=e.documentElement.cloneNode(!0);if(t.querySelectorAll("object").forEach((e=>e.remove())),t.querySelectorAll("script").forEach((e=>e.remove())),null===t.querySelector("head>base")){let e=document.createElement("base");e.setAttribute("href",c()),t.querySelector("head").prepend(e)}return t.outerHTML}function f(){return this.jQuery&&!MeadCo.fetchEnabled?m(jQuery("html")):p(document)}function h(e){if(this.jQuery&&!MeadCo.fetchEnabled){var t=jQuery("#"+e);if(!t.length&&!(t=jQuery("iframe[name="+e+"]")).length)throw new Error("Unable to get frame content - frame does not exist");return m(t.contents().find("html"))}{let t=document.getElementById(e);if(null==t){if(t=window.frames[e],!t)throw new Error("Unable to get frame content - frame does not exist")}else t=t.contentWindow;return p(t.document)}}function v(e,t,r,n,o,a){var i=s;return i.jobTitle=r,MeadCo.ScriptX.Print.printHtml(e,t,i,n,o,a)}function F(r,n){MeadCo.ScriptX.Print.deviceSettingsForAsync("systemdefault",(o=>{t=o.printerName,e=MeadCo.ScriptX.Print.printerName,MeadCo.log("Starting preview html ... printer: "+e);var a=document.getElementById("scriptXServices-PreviewWaitScreen");if(null==a){(a=document.createElement("DIV")).innerHTML="&shy;<style>.loader { background-color: rgba(0, 0, 0, 0.25); overflow: hidden; width: 100%; height: 100%; position: fixed;top: 0; left: 0; display: flex;  align-items:center; align-content:center; justify-content: center; z-index: 10000; } .loader__element { border-radius: 100%; border: 5px solid #555; margin: 10px} .loader__element:nth-child(1) { animation: preloader .6s ease-in-out alternate infinite; } .loader__element:nth-child(2) { animation: preloader .6s ease-in-out alternate .2s infinite; } .loader__element:nth-child(3) { animation: preloader .6s ease-in-out alternate .4s infinite; } @keyframes preloader { 100% { transform: scale(2); } }</style>",document.body.appendChild(a.childNodes[1]),(a=document.createElement("DIV")).setAttribute("id","scriptXServices-PreviewWaitScreen"),a.className="loader";for(var i=0;i<3;i++){var l=document.createElement("SPAN");l.className="loader__element",a.appendChild(l)}document.body.appendChild(a)}else a.style.display="flex";MeadCo.ScriptX.Print.requestHtmlPreview(r,n,s,(function(e){MeadCo.log("Preview procesing completed: ",e),a.style.display="none"}),(function(r,n){var o=MeadCo.makeServiceEndPoint(MeadCo.ScriptX.Print.serviceUrl,"v1/Preview/"+n+"/"+encodeURIComponent(document.URL));MeadCo.log("Preview is available: "+o+", ... printer: "+e);var a=document.getElementById("scriptXServices-PreviewFrame");null==a&&((a=document.createElement("IFRAME")).setAttribute("id","scriptXServices-PreviewFrame"),a.style.width=0,a.style.height=0,a.style.display="none",a.style.visibility="hidden",document.body.appendChild(a),window.addEventListener("message",(function(r){MeadCo.log("message from: "+r+", ... printer: "+e),"preview-wired"===r.data&&(MeadCo.log("preview is wired ... printer: "+e),MeadCo.ScriptX.Print.setSystemDefaultPrinterAsync(e,(function(){MeadCo.log("system default printer set, request print preview"),a.contentWindow.postMessage("preview",MeadCo.ScriptX.Print.serviceUrl),window.setTimeout((function(){MeadCo.ScriptX.Print.setSystemDefaultPrinterAsync(t,(function(){}),(function(e){MeadCo.error("Preview failed to restore current printer after preview: "+e),MeadCo.ScriptX.Print.reportError(e)}))}),500)}),(function(e){MeadCo.error("Preview failed to set current printer for preview: "+e),MeadCo.ScriptX.Print.reportError(e)})))}))),a.setAttribute("src",o)}))}),(e=>{MeadCo.error(e)}))}return MeadCo.log("MeadCo.ScriptX.Print.HTML "+r+" loaded."),{PageMarginUnits:n,PageOrientation:o,PrintingPasses:a,settings:l,get documentContentToPrint(){return f()},frameContentToPrint:function(e){return h(e)},printDocument:function(e,t,r){return v(MeadCo.ScriptX.Print.ContentType.INNERHTML,f(),document.title,e,t,r)},printFrame:function(e,t,r,n){return v(MeadCo.ScriptX.Print.ContentType.INNERHTML,h(e),document.title,t,r,n)},previewDocument:function(){F(MeadCo.ScriptX.Print.ContentType.INNERHTML,f())},previewFrame:function(e){F(MeadCo.ScriptX.Print.ContentType.INNERHTML,h(e))},printFromUrl:function(e,t,r,n){return v(MeadCo.ScriptX.Print.ContentType.URL,e,e,t,r,n)},printHtml:function(e,t,r,n){return v(MeadCo.ScriptX.Print.ContentType.HTML,e,"HTML snippet",t,r,n)},connectLite:function(e,t){MeadCo.ScriptX.Print.connectLite(e,t)},connect:function(e,t,r){MeadCo.warn("Print.HTML SYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+s.page.units,!1,(function(e){MeadCo.log("got default html settings"),d(e.settings),null!==e.device&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters)}),r)},connectAsync:function(e,t,r,n){MeadCo.log("Print.HTML ASYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+s.page.units,!0,(function(e){MeadCo.log("got default html settings"),d(e.settings)?(null!==e.device&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters),r(2)):n("Server did not respond with valid settings")}),n)},get version(){return r}}}));
//# sourceMappingURL=meadco-scriptxprinthtml.min.js.map
