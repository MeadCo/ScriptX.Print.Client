!function(e,r){var n=function(){var d=this,r="undefined"!=typeof MeadCo&&void 0!==MeadCo.logEnable&&MeadCo.logEnable,g=function(e){r&&console.log("MeadCo :: "+e)},i=function(e){console.error("MeadCo :: "+e)};return d.extendMeadCoNamespace=function(e,r){var n=r();g("MeadCo root extending namespace: "+e);for(var o=e.split("."),t=d.scope||this.jQuery||this.ender||this.$||this,s=0;s<o.length;s++){var a=o[s];if(s===o.length-1)if(void 0===t[a])g("installing implementation at: "+a),t[a]=n;else{g("Warning - extending package: "+a);var i=t[a];t[a]=n;var p=t[a];for(var l in g("preserving old scope ... "),i)i.hasOwnProperty(l)&&(g("will preserve: "+l),p[l]=i[l])}else void 0===t[a]?(g("initialising new: "+a),t[a]={}):g("using existing package: "+a);t=t[a]}},g("MeadCo root namespace loaded."),{log:g,warn:function(e){console.warn("MeadCo :: "+e)},error:i,get version(){return"1.7.2.0"},get logEnabled(){return r},set logEnabled(e){r=e},createNS:function(e){var r=e.split("."),n=d.scope.MeadCo;"MeadCo"===r[0]&&(r=r.slice(1));for(var o=0;o<r.length;o++){var t=r[o];void 0===n[t]&&(n[t]={}),n=n[t]}return n},set scope(e){d.scope=e},makeApiEndPoint:function(e,r){var n=e.indexOf("/api");return-1===n?(e.lastIndexOf("/")!==e.length-1&&(e+="/"),e+="api/"+r):e=e.substr(0,n)+"/api/"+r,e},parseAjaxError:function(e,r,n,o){return i("**warning: AJAX call failure in "+e+": ["+(s=n)+"], ["+(a=o)+"], ["+(t=r).responseText+"], ["+t.statusText+"]"),""===a||"Internal Server Error"===a?a="error"!==s?t.responseText||s:"object"==typeof t.responseJSON&&"string"==typeof t.responseJSON.Message?t.responseJSON.Message:"string"==typeof t.responseText?t.responseText:"Server or network error":"object"!=typeof t.responseJSON&&"string"==typeof t.responseText&&0<t.responseText.length&&(a=t.responseText),i(" error parsed to --\x3e ["+a+"]"),a;var t,s,a}}}(),o=this,t=null;if(void 0!==o[e]&&(t=o[e]),o[e]=n,null!==t){var s=o[e];for(var a in t)t.hasOwnProperty(a)&&(s[a]=t[a])}n.scope=o}("MeadCo");
extendMeadCoNamespace("MeadCo.ScriptX.Print",function(){var e="1.7.2.2",d="v1/printHtml",s="v1/printPdf",t="v1/printDirect",l="",u={},i=this,f=[],p="",C="",o=!1,g=!1,r=[],a=null,v={URL:1,HTML:2,INNERHTML:4,STRING:8},c={UNKNOWN:0,QUEUEDTODEVICE:1,QUEUEDTOFILE:2,SOFTERROR:3,OK:4},n={REPORT:1,THROW:2},m=n.REPORT,M={NOTSTARTED:0,QUEUED:1,STARTING:2,DOWNLOADING:3,DOWNLOADED:4,PRINTING:5,COMPLETED:6,PAUSED:7,PRINTPDF:8,ERROR:-1,ABANDONED:-2};function E(e){f.push(e),MeadCo.log("ScriptX.Print queueJob, jobCount: "+f.length)}function S(){return MeadCo.log("ScriptX.Print jobCount: "+f.length),f.length}function y(e){var n;for(n=0;n<f.length;n++)if(f[n].jobIdentifier===e)return f.splice(n,1),void MeadCo.log("ScriptX.Print remove job, jobCount: "+f.length);console.warn("Unable to find job: "+e+" to remove it")}function P(e,n,o){"function"==typeof e.OnProgress&&e.OnProgress(n,o,e.UserData)}function h(e,n){0<e.length&&(MeadCo.log("Print server requested: "+e+" => "+MeadCo.makeApiEndPoint(e,d)+" with license: "+n),p=MeadCo.makeApiEndPoint(e,d),C=n,l="",u={},o=!(f=[]),r=[])}function j(e,n,t){if(p.length<=0)throw new Error("MeadCo.ScriptX.Print : print server URL is not set or is invalid");var r={jobIdentifier:Date.now(),printerName:n.Device.printerName,jobName:"Job starting"};if(i.jQuery)return MeadCo.log(".ajax() post to: "+e),E(r),i.jQuery.ajax(e+"/print",{data:JSON.stringify(n),dataType:"json",contentType:"application/json",method:"POST",headers:{Authorization:"Basic "+btoa(C+":")}}).done(function(e){switch(MeadCo.log("Success response: "+e.status),e.printerName=n.Device.printerName,e.jobName=n.Settings.jobTitle,E(e),y(r.jobIdentifier),e.status){case c.QUEUEDTOFILE:t.queuedToFile(e);break;case c.QUEUEDTODEVICE:t.queuedToDevice(e);break;case c.SOFTERROR:case c.UNKNOWN:t.softError(e);break;case c.OK:t.ok(e)}}).fail(function(e,n,o){y(r.jobIdentifier),"function"==typeof t.fail&&t.fail(e,n,o)}),!0;if("function"!=typeof t.fail)throw new Error("MeadCo.ScriptX.Print : no known ajax helper available");t.fail("MeadCo.ScriptX.Print : no known ajax helper available")}function b(e,n,o,t){if(i.jQuery)if(""!==p){var r=MeadCo.makeApiEndPoint(p,e);MeadCo.log(".ajax() get: "+r),i.jQuery.ajax(r,{method:"GET",dataType:"json",cache:!1,async:n,headers:{Authorization:"Basic "+btoa(C+":")}}).done(function(e){o(e)}).fail(function(e,n,o){o=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.getFromServer:",e,n,o),"function"==typeof t&&t(o)})}else{if("function"!=typeof t)throw new Error("MeadCo.ScriptX.Print : server connection is not defined.");t("MeadCo.ScriptX.Print : server connection is not defined.")}else{if("function"!=typeof t)throw new Error("MeadCo.ScriptX.Print : no known ajax helper available");t("MeadCo.ScriptX.Print : no known ajax helper available")}}function D(e,t,r,n,i){MeadCo.log("monitorJob: "+r);var o=0,a=!1,c=window.setInterval(function(){a?MeadCo.log("** info : still waiting for last status request to complete"):(MeadCo.log("Going to request status with .ajax"),a=!0,jQuery.ajax(e+"/status/"+r,{dataType:"json",method:"GET",cache:!1,headers:{Authorization:"Basic "+btoa(C+":")}}).done(function(e){switch(MeadCo.log("jobStatus: "+e.status),e.status){case M.COMPLETED:MeadCo.log("clear interval: "+c),window.clearInterval(c),y(r),i(e);break;case M.NOTSTARTED:case M.DOWNLOADED:case M.DOWNLOADING:case M.PRINTING:case M.QUEUED:case M.STARTING:case M.PAUSED:case M.PRINTPDF:P(t,e.status,e.message),function(n){var o;for(o=0;o<f.length;o++)if(f[o].jobIdentifier===n.jobIdentifier)return Object.keys(n).forEach(function(e){f[o][e]=n[e]});console.warn("Unable to find job: "+n.jobIdentifier+" to update it")}(e),0<n&&1e3*++o>n&&(window.clearInterval(c),MeadCo.ScriptX.Print.reportError("unknown failure while printing.")),a=!1;break;case M.ERROR:case M.ABANDONED:MeadCo.log("error status in monitorJob so clear interval: "+c),P(t,e.status,e.message),y(r),window.clearInterval(c),MeadCo.ScriptX.Print.reportError("The print failed with the error: "+e.message),i(null);break;default:P(t,e.status,e.message),MeadCo.log("unknown status in monitorJob so clear interval: "+c),y(r),window.clearInterval(c),i(null)}}).fail(function(e,n,o){o=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.monitorJob:",e,n,o),MeadCo.log("error: "+o+" in monitorJob so clear interval: "+c),P(t,M.ERROR,o),y(r),window.clearInterval(c),i(null)}))},1e3);MeadCo.log("intervalId: "+c)}function w(e){if("string"==typeof e.printerName){if(e.isDefault)for(var n=0;n<u.length;n++)u[n].isDefault=!1;(u[e.printerName]=e).isDefault&&0===l.length&&(l=e.printerName)}}function T(t,e){t.name=t.name.replace(/\\/g,"||"),MeadCo.log("Request get device info: "+t.name);var r=1<arguments.length?e:C;if(i.jQuery){var n=p+"/deviceinfo/"+encodeURIComponent(t.name)+"/0";MeadCo.log(".ajax() get: "+n),i.jQuery.ajax(n,{dataType:"json",method:"GET",cache:!1,async:t.async,headers:{Authorization:"Basic "+btoa(r+":")}}).done(function(e){o=!0,w(e),"function"==typeof t.done&&t.done(e)}).fail(function(e,n,o){"systemdefault"===t.name?(console.warn("request for systemdefault printer failed - please update to ScriptX.Services 2.11.1"),t.name="default",t.async=!1,T(t,r)):(o=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.getDeviceSettings:",e,n,o),MeadCo.log("failed to getdevice: "+o),"function"==typeof t.fail&&t.fail(o))})}else{if("function"!=typeof t.fail)throw new Error("MeadCo.ScriptX.Print : no known ajax helper available");t.fail("MeadCo.ScriptX.Print : no known ajax helper available")}}return i.jQuery||MeadCo.log("**** warning :: no jQuery *******"),MeadCo.log("MeadCo.ScriptX.Print "+e+" loaded."),{ContentType:v,PrintStatus:M,ErrorAction:n,CollateOptions:{DEFAULT:0,TRUE:1,FALSE:2},DuplexOptions:{DEFAULT:0,SIMPLEX:1,VERTICAL:2,HORIZONTAL:3},MeasurementUnits:{DEFAULT:0,INCHES:1,MM:2},ServiceClasses:{CLOUD:1,ONPREMISE:2,WINDOWSPC:3},get onErrorAction(){return m},set onErrorAction(e){m=e},get printerName(){return l},set printerName(e){e!==l&&e.name!==l&&("string"==typeof e?void 0===u[e]?T({name:e,done:function(e){l=e.printerName},async:!1,fail:function(e){MeadCo.ScriptX.Print.reportError(e)}}):l=e:T(e))},get version(){return e},serviceVersion:function(){return this.cachedServiceDescription.ServiceVersion},serviceVersionAsync:function(n,e){this.serviceDescriptionAsync(function(e){n(e.serviceVersion)},e)},get deviceSettings(){return""!==l?u[l]:{}},set deviceSettings(e){w(e)},deviceSettingsFor:function(e){return"string"!=typeof(n=e)||""===n?{}:(void 0===u[n]&&T({name:n,async:!1,done:function(e){"systemdefault"===n.toLowerCase()&&(n=e.printerName)},fail:function(e){MeadCo.ScriptX.Print.reportError(e)}}),u[n]);var n},useAttributes:function(){!function(){if(MeadCo.log("MeadCo.ScriptX.Print ... looking for auto connect, already found?: "+g),this.jQuery&&!g){var i=MeadCo.ScriptX.Print.HTML,a=MeadCo.ScriptX.Print,c=MeadCo.ScriptX.Print.Licensing;jQuery("[data-meadco-subscription]").each(function(){if(void 0===a||void 0===i)console.warn("Unable to auto-connect subscription - print or printHtml API not present (yet?)");else if(!g){var e=jQuery(this),n=e.data();MeadCo.log("Auto connect susbcription to: "+n.meadcoServer+", or "+n.meadcoPrinthtmlserver+", with subscription: "+n.meadcoSubscription+", sync: "+n.meadcoSyncinit);var o="false"!==(""+n.meadcoSyncinit).toLowerCase(),t=n.meadcoServer;void 0===t&&(t=n.meadcoPrinthtmlserver),void 0===t?console.error("No server specified"):(void 0!==c&&c.connect(t,n.meadcoSubscription),o?(console.warn("Synchronous connection is deprecated, please use data-meadco-syncinit='false'"),i.connect(t,n.meadcoSubscription)):(MeadCo.log("Async connectlite..."),a.connectLite(t,n.meadcoSubscription)),g=!0)}return!1}),jQuery("[data-meadco-license]").each(function(){if(void 0===a||void 0===i||void 0===c)console.warn("Unable to auto-connect client license - print or printHtml or license API not present (yet?)");else if(!g){var e=jQuery(this),n=e.data();MeadCo.log("Auto connect client license to: "+n.meadcoServer+", with license: "+n.meadcoLicense+", path: "+n.meadcoLicensePath+", revision: "+n.meadcoLicenseRevision+", sync: "+n.meadcoSyncinit);var o="false"!==(""+n.meadcoSyncinit).toLowerCase(),t="false"!==(""+n.meadcoReporterror).toLowerCase(),r=n.meadcoServer;o?(console.warn("Synchronous connection is deprecated, please use data-meadco-syncinit='false'"),c.connect(r,n.meadcoLicense),void 0!==n.meadcoLicensePath&&void 0!==n.meadcoLicenseRevision&&(c.apply(n.meadcoLicense,n.meadcoLicenseRevision,n.meadcoLicensePath),0!=c.result&&t&&MeadCo.ScriptX.Print.reportError(c.errorMessage)),i.connect(r,n.meadcoLicense)):(MeadCo.log("Async connectlite..."),c.connectLite(r,n.meadcoLicense,n.meadcoLicenseRevision,n.meadcoLicensePath),a.connectLite(r,n.meadcoLicense)),g=!0}return!1})}}()},connect:function(e,n){h(e,n),T({name:"systemdefault",async:!1}),b("",!0,function(e){a=e})},connectLite:function(e,n){2===arguments.length&&null!==e&&null!==n&&0<e.length&&0<n.length&&h(e,n)},connectAsync:function(e,n,o,t){var r,i;r=o,i=t,h(e,n),T({name:"systemdefault",done:r,async:!0,fail:i}),b("",!0,function(e){a=e})},connectTestAsync:function(e,n,o){!function(e,n,t){if(0<e.length){var o="v1/licensing";if(MeadCo.log("Test server requested: "+e+" => "+MeadCo.makeApiEndPoint(e,o)),e=MeadCo.makeApiEndPoint(e,o),i.jQuery){var r=e+"/ping";MeadCo.log(".ajax() get: "+r),i.jQuery.ajax(r,{method:"GET",dataType:"json",cache:!1,async:!0}).done(function(e){n(e)}).fail(function(e,n,o){o=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.testServerConnection:",e,n,o),"function"==typeof t&&t(o)})}else MeadCo.error("jQuery is required by ScriptX.Services")}}(e,n,o)},serviceDescription:function(){return a||b("",!1,function(e){a=e},function(e){MeadCo.ScriptX.Print.reportError(e.message)}),a},serviceDescriptionAsync:function(n,e){a?n(a):b("",!0,function(e){n(a=e)},e)},connectDeviceAndPrinters:function(e,n){o=!0,w(e),r=n},get isConnected(){return o},get availablePrinterNames(){return r},getFromServer:function(e,n,o,t){b(d+e,n,o,t)},printHtml:function(e,n,o,r,t,i){var a;if(MeadCo.log("started MeadCo.ScriptX.Print.print.printHtmlAtServer() Type: "+e+", printerName: "+l),e===v.URL&&MeadCo.log(".. request print url: "+n),!n||"string"==typeof n&&0===n.length)return MeadCo.ScriptX.Print.reportError("Request to print no content - access denied?"),"function"==typeof r&&r("Request to print no content"),!1;a=""===l?{}:u[l];var c={ContentType:e,Content:n,Settings:o,Device:a,OnProgress:t,UserData:i},s=MeadCo.makeApiEndPoint(p,d);return j(s,c,{fail:function(e,n,o){var t=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.printHtmlAtServer",e,n,o);P(c,M.ERROR,t),MeadCo.ScriptX.Print.reportError(t),"function"==typeof r&&r("Server error")},queuedToFile:function(e){MeadCo.log("default handler on queued to file response"),P(c,M.QUEUED),D(s,c,e.jobIdentifier,-1,function(e){null!==e&&(MeadCo.log("Will download printed file"),P(c,M.COMPLETED),window.open(p+"/download/"+e.jobIdentifier,"_self")),"function"==typeof r&&r(null===e?"Server error":null)})},queuedToDevice:function(e){MeadCo.log("print was queued to device"),P(c,M.QUEUED),D(s,c,e.jobIdentifier,-1,function(e){null!==e&&P(c,M.COMPLETED),"function"==typeof r&&r(null===e?"Server error":null)})},softError:function(e){P(c,M.ERROR,e.message),MeadCo.ScriptX.Print.reportError(e.message),MeadCo.log("print has soft error"),y(e.jobIdentifier),"function"==typeof r&&(MeadCo.log("Call fnDone"),r(e.message))},ok:function(e){P(c,M.COMPLETED),MeadCo.log("printed ok, no further information"),y(e.jobIdentifier),"function"==typeof r&&r(null)}})},printPdf:function(e,n,r,o,t){var i;if(MeadCo.log("started MeadCo.ScriptX.Print.print.printPdfAtServer() document: "+e+", printerName: "+l),!e||"string"==typeof e&&0===e.length)return MeadCo.ScriptX.Print.reportError("The document to print must be given."),"function"==typeof r&&r("Request to print no content"),!1;i=""===l?{}:u[l];var a={Document:e,Description:n.jobDescription,Settings:n,Device:i,OnProgress:o,UserData:t};a.Settings.jobTitle=n.jobDescription;var c=MeadCo.makeApiEndPoint(p,s);return j(c,a,{fail:function(e,n,o){var t=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.printPdfAtServer",e,n,o);P(a,M.ERROR,t),MeadCo.ScriptX.Print.reportError(t),"function"==typeof r&&r("Server error")},queuedToFile:function(e){MeadCo.log("default handler on queued to file response"),P(a,M.QUEUED),D(c,a,e.jobIdentifier,-1,function(e){null!==e&&(MeadCo.log("Will download printed file"),P(a,M.COMPLETED),window.open(p+"/download/"+e.jobIdentifier,"_self")),"function"==typeof r&&r(null===e?"Server error":null)})},queuedToDevice:function(e){MeadCo.log("print was queued to device"),P(a,M.QUEUED),D(c,a,e.jobIdentifier,-1,function(e){null!==e&&P(a,M.COMPLETED),"function"==typeof r&&r(null===e?"Server error":null)})},softError:function(e){P(a,M.ERROR,e.message),MeadCo.ScriptX.Print.reportError(e.message),MeadCo.log("printpdf call has soft error, remove job: "+e.jobIdentifier),y(e.jobIdentifier),"function"==typeof r&&(MeadCo.log("Call fnDone"),r("Server error"))},ok:function(e){P(a,M.COMPLETED),MeadCo.log("printed ok, no further information"),y(e.jobIdentifier),"function"==typeof r&&r(null)}})},printDirect:function(e,n,r){if(MeadCo.log("started MeadCo.ScriptX.Print.print.printDirectAtServer() Type: "+e+", printerName: "+l),e===v.URL)MeadCo.log(".. request print url: "+n);else if(e!==v.STRING)return MeadCo.ScriptX.Print.reportError("Bad content type for direct printing"),"function"==typeof r&&r("Bad content type for direct printing"),!1;if(!n||"string"==typeof n&&0===n.length)return MeadCo.ScriptX.Print.reportError("Request to print no content - access denied?"),"function"==typeof r&&r("Request to print no content"),!1;if(""===l)return MeadCo.ScriptX.Print.reportError("Request to print but no current printer defined."),"function"==typeof r&&r("Request to print but no current printer defined."),!1;var o={ContentType:e,Content:n,PrinterName:l,Settings:{jobTitle:"Direct print"},Device:u[l]};return j(MeadCo.makeApiEndPoint(p,t),o,{fail:function(e,n,o){var t=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.printDirectAtServer",e,n,o);MeadCo.ScriptX.Print.reportError(t),"function"==typeof r&&r("Server error")},softError:function(e){MeadCo.ScriptX.Print.reportError(e.message),MeadCo.log("print has soft error"),y(e.jobIdentifier),"function"==typeof r&&(MeadCo.log("Call fnDone"),r(e.message))},ok:function(e){MeadCo.log("printed ok, no further information"),y(e.jobIdentifier),"function"==typeof r&&r(null)}})},parseAjaxError:function(e,n,o,t){return MeadCo.parseAjaxError(e,n,o,t)},reportError:function(e){switch(MeadCo.error("ReportError: "+e),m){case n.REPORT:MeadCo.ScriptX.Print.reportServerError(e);break;case n.THROW:throw new Error(e)}},reportServerError:function(e){alert("There was an error in the printing service\n\n"+e)},reportFeatureNotImplemented:function(e){MeadCo.log("Call to not implemented: "+e),alert(e+"\n\nis not available.")},get queue(){return f},get activeJobs(){return S()},ensureSpoolingStatus:function(){var e={jobIdentifier:Date.now(),printerName:"ensureJobsPrinter",jobName:"null Job"};return E(e),e},freeSpoolStatus:function(e){y(e.jobIdentifier)},get isSpooling(){return 0<S()},waitForSpoolingComplete:function(e,n){if(MeadCo.log("Started WaitForSpoolingComplete("+e+")"),"function"!=typeof n)throw"WaitForSpoolingComplete requires a completion callback";var o=Date.now(),t=window.setInterval(function(){0===S()?(MeadCo.log("WaitForSpoolingComplete - complete"),window.clearInterval(t),n(!0)):0<=e&&Date.now()-o>e&&(MeadCo.log("WaitForSpoolingComplete - timeout"),window.clearInterval(t),n(0===S()))},250)}}});
extendMeadCoNamespace("MeadCo.ScriptX.Print.HTML",function(){var e="1.7.2.2",t={DEFAULT:0,LANDSCAPE:1,PORTRAIT:2},r={ALL:1,ODD:2,EVEN:3},n={DEFAULT:0,TRUE:1,FALSE:2},s={header:null,footer:null,headerFooterFont:null,viewScale:0,locale:navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language,timezoneOffset:0,shortDateFormat:"",longDateFormat:"",printBackgroundColorsAndImages:!1,page:{orientation:t.PORTRAIT,units:MeadCo.ScriptX.Print.MeasurementUnits.DEFAULT,margins:{left:"",top:"",bottom:"",right:""}},extraHeadersAndFooters:{},pageRange:"",printingPass:r.ALL,jobTitle:"",documentUrl:document.URL},o={set header(e){MeadCo.log("MeadCo.ScriptX.Print.HTML setting header: "+e),e&&0===e.length&&(e="%20"),s.header=e},get header(){return s.header&&"%20"!==s.header?s.header:""},set footer(e){e&&0===e.length&&(e="%20"),s.footer=e},get footer(){return s.footer&&"%20"!==s.footer?s.footer:""},set headerFooterFont(e){e&&0===e.length&&(e="%20"),s.headerFooterFont=e},get headerFooterFont(){return s.headerFooterFont&&"%20"!==s.headerFooterFont?s.headerFooterFont:""},get locale(){return s.locale},set viewScale(e){s.viewScale=e},get viewScale(){return s.viewScale},set locale(e){s.locale=e},set shortDateFormat(e){s.shortDateFormat=e},set longDateFormat(e){s.longDateFormat=e},set printBackgroundColorsAndImages(e){s.printBackgroundColorsAndImages=e?n.TRUE:n.FALSE},get printBackgroundColorsAndImages(){return s.printBackgroundColorsAndImages===n.TRUE},extraHeadersAndFooters:{get allPagesHeader(){return s.extraHeadersAndFooters.allPagesHeader},set allPagesHeader(e){s.extraHeadersAndFooters.allPagesHeader=e},get allPagesFooter(){return s.extraHeadersAndFooters.allPagesFooter},set allPagesFooter(e){s.extraHeadersAndFooters.allPagesFooter=e},get firstPageHeader(){return s.extraHeadersAndFooters.firstPageHeader},set firstPageHeader(e){s.extraHeadersAndFooters.firstPageHeader=e},get firstPageFooter(){return s.extraHeadersAndFooters.firstPageFooter},set firstPageFooter(e){s.extraHeadersAndFooters.firstPageFooter=e},get extraFirstPageFooter(){return s.extraHeadersAndFooters.extraFirstPageFooter},set extraFirstPageFooter(e){s.extraHeadersAndFooters.extraFirstPageFooter=e},get allHeaderHeight(){return s.extraHeadersAndFooters.allHeaderHeight},set allHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.allHeaderHeight=e},get allFooterHeight(){return s.extraHeadersAndFooters.allFooterHeight},set allFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.allFooterHeight=e},get firstHeaderHeight(){return s.extraHeadersAndFooters.firstHeaderHeight},set firstHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.firstHeaderHeight=e},get firstFooterHeight(){return s.extraHeadersAndFooters.firstFooterHeight},set firstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.firstFooterHeight=e},get extraFirstFooterHeight(){return s.extraHeadersAndFooters.extraFirstFooterHeight},set extraFirstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";s.extraHeadersAndFooters.extraFirstFooterHeight=e}},page:{set orientation(e){s.page.orientation=e},get orientation(){return s.page.orientation},set units(e){s.page.units=e},get units(){return s.page.units},margins:{set left(e){s.page.margins.left=e},get left(){return s.page.margins.left},set top(e){s.page.margins.top=e},get top(){return s.page.margins.top},set bottom(e){s.page.margins.bottom=e},get bottom(){return s.page.margins.bottom},set right(e){s.page.margins.right=e},get right(){return s.page.margins.right}}},get pageRange(){return s.pageRange},set pageRange(e){s.pageRange=e},get printingPass(){return s.printingPass},set printingPass(e){if(!("number"==typeof e&&r.ALL<=e&&e<=r.ODDANDEVEN))throw"Invalid argument";s.printingPass=e}};function a(e){return null!==e?((s=e).locale=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language,s.timezoneOffset=(new Date).getTimezoneOffset(),s.documentUrl=document.URL,MeadCo.log("Settings cache updated, .locale: ["+s.locale+"], .offset: "+s.timezoneOffset),!0):(MeadCo.warn("Igoring attempt to updateSettingsWithServerDefaults with null"),!1)}function i(){var e=window.location.port?":"+window.location.port:"";return window.location.protocol+"//"+window.location.hostname+e+window.location.pathname}function g(e){!function(e){jQuery(":checked",e).each(function(){this.setAttribute("checked","checked")});for(var t="text search number email datetime datetime-local date month week time tel url color range".split(" "),r=t.length,n=0;n<r;n++)jQuery("input[type="+t[n]+"]",e).each(function(){this.setAttribute("value",jQuery(this).val())});jQuery("select",e).each(function(){var e=jQuery(this);jQuery("option",e).each(function(){e.val()===jQuery(this).val()&&this.setAttribute("selected","selected")})}),jQuery("textarea",e).each(function(){this.innerHTML=jQuery(this).val()})}(e);var t=e.clone();if(jQuery("script",t).remove(),jQuery("object",t).remove(),!jQuery("head>base",t).length){MeadCo.log("No base element, fabricating one to: "+i());var r=jQuery("<base>",{href:i()});jQuery("head",t).prepend(r)}return t.html()}function l(){if(this.jQuery)return g(jQuery("html"));throw new Error("No supported html snapshot helper available (jQuery is required)")}function d(e){if(this.jQuery){var t=jQuery("#"+e);if(!t.length&&!(t=jQuery("iframe[name="+e+"]")).length)throw new Error("Unable to get frame content - frame does not exist");return g(t.contents().find("html"))}throw new Error("No supported framed html snapshot helper available (jQuery is required)")}function u(e,t,r,n,o,a){var i=s;return i.jobTitle=r,MeadCo.ScriptX.Print.printHtml(e,t,i,n,o,a)}return MeadCo.log("MeadCo.ScriptX.Print.HTML "+e+" loaded."),this.jQuery||MeadCo.log("**** warning :: no jQuery"),{PageMarginUnits:{DEFAULT:0,INCHES:1,MM:2},PageOrientation:t,PrintingPasses:r,settings:o,get documentContentToPrint(){return l()},frameContentToPrint:function(e){return d(e)},printDocument:function(e,t,r){return u(MeadCo.ScriptX.Print.ContentType.INNERHTML,l(),document.title,e,t,r)},printFrame:function(e,t,r,n){return u(MeadCo.ScriptX.Print.ContentType.INNERHTML,d(e),document.title,t,r,n)},printFromUrl:function(e,t,r,n){return u(MeadCo.ScriptX.Print.ContentType.URL,e,e,t,r,n)},printHtml:function(e,t,r,n){return u(MeadCo.ScriptX.Print.ContentType.HTML,e,"HTML snippet",t,r,n)},connectLite:function(e,t){MeadCo.ScriptX.Print.connectLite(e,t)},connect:function(e,t,r){MeadCo.warn("Print.HTML SYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+s.page.units,!1,function(e){MeadCo.log("got default html settings"),a(e.settings),null!==e.device&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters)},r)},connectAsync:function(e,t,r,n){MeadCo.log("Print.HTML ASYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+s.page.units,!0,function(e){MeadCo.log("got default html settings"),a(e.settings)?(null!==e.device&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters),r(2)):n("Server did not respond with valid settings")},n)},get version(){return e}}});
extendMeadCoNamespace("MeadCo.ScriptX.Print.PDF",function(){var e="1.7.2.0",t={DEFAULT:0,LANDSCAPE:1,PORTRAIT:2},n={DEFAULT:0,TRUE:1,FALSE:2},i={UNDEFINED:-1,NONE:0,FITTOPAPER:1,SHRINKLARGEPAGES:2},o={NORMAL:0,HIGH:1,LOSSLESS:2},d={jobDescription:"",pageRange:"",pageScaling:i.UNDEFINED,autoRotateCenter:n.DEFAULT,orientation:t.DEFAULT,monochrome:n.DEFAULT,normalise:n.DEFAULT,printQuality:o.NORMAL};return MeadCo.log("MeadCo.ScriptX.Print.PDF "+e+" loaded."),this.jQuery||MeadCo.log("**** warning :: no jQuery"),{PageOrientation:t,BooleanOption:n,PdfPageScaling:i,PdfPrintQuality:o,settings:d,resetSettings:function(){d.jobDescription="",d.pageRange="",d.pageScaling=i.UNDEFINED,d.autoRotateCenter=n.DEFAULT,d.orientation=t.DEFAULT,d.monochrome=n.DEFAULT,d.normalise=n.DEFAULT,d.printQuality=o.NORMAL},print:function(e,t,n,i){return o=e,r=t,a=n,c=i,MeadCo.ScriptX.Print.printPdf(o,d,r,a,c);var o,r,a,c},connectLite:function(e,t){MeadCo.ScriptX.Print.connectLite(e,t)},connect:function(e,t){MeadCo.warn("Print.PDF SYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults/?units="+settingsCache.page.units,!1,function(e){MeadCo.log("got default html settings"),null!==e.device&&MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters)})},connectAsync:function(e,t,n,i){MeadCo.log("Print.PDF ASYNC connection request"),MeadCo.ScriptX.Print.connectLite(e,t),MeadCo.ScriptX.Print.getFromServer("/htmlPrintDefaults",!0,function(e){MeadCo.log("got default html settings"),null!==e.device?(MeadCo.ScriptX.Print.connectDeviceAndPrinters(e.device,e.availablePrinters),n()):i("Server did not respond with valid settings")},i)},get version(){return e}}});
!function(e,t,r){if(this[e]!==r||null!==document.getElementById(e)){if(MeadCo.log("ScriptX.Services ScriptX.factory emulation believes it may not be requred."),this[e]!==r&&MeadCo.log("this["+e+"] is defined"),null!==document.getElementById(e)&&MeadCo.log("document.getElementById("+e+") is defined"),this[e].object!==r)return MeadCo.log("this["+e+"].object is defined -- not required!!!");MeadCo.log("this["+e+"].object is *not* defined")}MeadCo.log("ScriptX.Services ScriptX.factory emulation believes it is requred.");var n=function(){var c="1.7.2.2",u="8.3.0.0",p="",d=MeadCo.ScriptX.Print,t=MeadCo,l=this;function f(e){t.log("factory emulation :: "+e)}return f("'factory' loaded "+c),{log:f,GetComponentVersion:function(e,t,r,n,i){f("factory.object.getcomponentversion: "+e);var o=c;switch(e.toLowerCase()){case"scriptx.factory":o=u;break;case"scriptx.factory.services":o=c;break;case"scriptx.services":if(""===p&&void 0!==d){var a=d.onErrorAction;d.onErrorAction=d.ErrorAction.THROW;try{var s=d.serviceDescription();if(null!==s){var g=s.serviceVersion;p=g.major+"."+g.minor+"."+g.build+"."+g.revision}}catch(e){p=c}d.onErrorAction=a}o=p;break;case"meadco.secmgr":try{o=l.secmgr.version}catch(e){o="0.0.0.0"}break;case"meadco.triprint":try{o=MeadCo.ScriptX.Print.HTML.version}catch(e){o="0.0.0.0"}}o=o.split("."),t[0]=o[0],r[0]=o[1],n[0]=o[2],i[0]=o[3]},ComponentVersionString:function(e){var t=new Object,r=new Object,n=new Object,i=new Object;return l.factory.GetComponentVersion(e,t,r,n,i),t[0]+"."+r[0]+"."+n[0]+"."+i[0]},get ScriptXVersion(){return u},get SecurityManagerVersion(){return u},IsUniqueIDAvailable:function(e){return!1},UniqueID:function(e){return 0},ResetUniqueID:function(e){return 0},baseURL:function(e){var t=document.createElement("a");return t.href=e,t.href},relativeURL:function(e){throw"MeadCo.ScriptX.Print :: relativeUrl is not implemented.\n\nPlease see https://github.com/medialize/URI.js for an alternative."},OnDocumentComplete:function(e,t){void 0===e.contentWindow?t():e.addEventListener("load",function(e){t()},{once:!0})},get rawPrinting(){var i="",o=MeadCo.ScriptX.Print;function t(e,t){var r=!1;if(void 0!==o){var n=factory.printing.printer;factory.printing.printer=i,e===o.ContentType.URL&&(t=l.factory.baseURL(t)),r=o.printDirect(e,t),factory.printing.printer=n}return r}return{get printer(){return i},set printer(e){var t=factory.printing.printer;if(factory.printing.printer=e,factory.printing.printer!==e)throw"Unknown printer";factory.printing.printer=t,i=e},printString:function(e){return void 0!==o&&t(o.ContentType.STRING,e)},printDocument:function(e){return void 0!==o&&t(o.ContentType.URL,e)}}},Shutdown:function(){return null},extendFactoryNamespace:function(e,t){var r=t();f("MeadCo factory extending namespace: "+e);for(var n=e.split("."),i=l,o=0;o<n.length;o++){var a=n[o];o===n.length-1?void 0===i[a]?(f("installing implementation at: "+a),i[a]=r):f("Warning - not overwriting package: "+a):void 0===i[a]?(f("initialising new: "+a),i[a]={}):f("using existing package: "+a),i=i[a]}},keyPressCtrlP:function(e){e.ctrlKey&&80==e.keyCode&&!e.shiftKey&&(e.preventDefault(),f("ctrl-p being handled."),l.print())}}}();this[e]=n}("factory"),"function"==typeof factory.extendFactoryNamespace&&factory.extendFactoryNamespace("factory.printing",function(){var s=MeadCo.ScriptX.Print.HTML,a=MeadCo.ScriptX.Print.PDF,i=s.settings,g=MeadCo.ScriptX.Print,c=this;function u(e,t,r){void 0===e&&(e=!0);var n=g.ensureSpoolingStatus(),i=!1,o=null;if(e){if(MeadCo.ScriptX.Print.UI){if(MeadCo.ScriptX.Print.UI.PrinterSettings(function(e){if(e){MeadCo.log("promptAndPrint requesting print ...");try{i=t(),r(i)}catch(e){o=e}}else r(!1);g.freeSpoolStatus(n)}),null!==o)throw o;return MeadCo.log("promptAndPrint exits ..."),i}MeadCo.warn("prompted print requested but no UI library loaded. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs")}try{i=t(),r(i)}catch(e){o=e}finally{g.freeSpoolStatus(n)}if(null!==o)throw o;return i}function o(e,t,r,n,i){var o="";if(0===e.indexOf("html://")){o=e.substring(7);var a="<!doctype";o.substr(0,a.length).toLowerCase()===a&&(o=o.substring(o.indexOf(">")+1))}else e=c.factory.baseURL(e);return u(t,function(){return MeadCo.log("printHtmlContent requesting print ..."),0<o.length?s.printHtml(o,null,n,i):s.printFromUrl(e,null,n,i)},r)}function p(e,t,r,n,i){return void 0!==a?(e=c.factory.baseURL(e),u(t,function(){return MeadCo.log("printPdfContent requesting print ..."),a.print(e,null,n,i)},r)):(MeadCo.error("MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation."),r(!1),!1)}c.factory.log("factory.Printing loaded.");var d={get allPagesHeader(){return i.extraHeadersAndFooters.allPagesHeader},set allPagesHeader(e){i.extraHeadersAndFooters.allPagesHeader=e},get allPagesFooter(){return i.extraHeadersAndFooters.allPagesFooter},set allPagesFooter(e){i.extraHeadersAndFooters.allPagesFooter=e},get firstPageHeader(){return i.extraHeadersAndFooters.firstPageHeader},set firstPageHeader(e){i.extraHeadersAndFooters.firstPageHeader=e},get firstPageFooter(){return i.extraHeadersAndFooters.firstPageFooter},set firstPageFooter(e){i.extraHeadersAndFooters.firstPageFooter=e},get extraFirstPageFooter(){return i.extraHeadersAndFooters.extraFirstPageFooter},set extraFirstPageFooter(e){i.extraHeadersAndFooters.extraFirstPageFooter=e},get allHeaderHeight(){return i.extraHeadersAndFooters.allHeaderHeight},set allHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";i.extraHeadersAndFooters.allHeaderHeight=e},get allFooterHeight(){return i.extraHeadersAndFooters.allFooterHeight},set allFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";i.extraHeadersAndFooters.allFooterHeight=e},get firstHeaderHeight(){return i.extraHeadersAndFooters.firstHeaderHeight},set firstHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";i.extraHeadersAndFooters.firstHeaderHeight=e},get firstFooterHeight(){return i.extraHeadersAndFooters.firstFooterHeight},set firstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";i.extraHeadersAndFooters.firstFooterHeight=e},get extraFirstFooterHeight(){return i.extraHeadersAndFooters.extraFirstFooterHeight},set extraFirstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";i.extraHeadersAndFooters.extraFirstFooterHeight=e},get pageRange(){return i.pageRange},set pageRange(e){i.pageRange=e,void 0!==a&&(a.settings.pageRange=e)},get printingPass(){var e="";switch(i.printingPass){case s.PrintingPasses.ALL:e="all";break;case s.PrintingPasses.ODD:e="odd";break;case s.PrintingPasses.EVEN:e="even";break;case s.PrintingPasses.ODDANDEVEN:e="odd&even"}return e},set printingPass(e){var t=s.PrintingPasses.ALL;if("string"==typeof e)switch(e.toLowerCase()){case"odd":t=s.PrintingPasses.ODD;break;case"even":t=s.PrintingPasses.EVEN;break;case"odd&even":t=s.PrintingPasses.ODDANDEVEN}i.printingPass=t},get pdfPrintMode(){return void 0!==a?a.settings.printQuality:0},set pdfPrintMode(e){void 0!==a&&(a.settings.printQuality=e)}};if(void 0!==g){g.useAttributes(),"function"==typeof c.print&&(c.factory.log("overwriting module.print"),c.print=function(){c.factory.log("window.print() called and being handled."),u(!0,function(){return s.printDocument()},function(){})});var e=null!=document.querySelector("[data-meadco-ctrlp='false']");e||(c.factory.log("using addEventListener('keydown',factory.keyPressCtrlP) for Ctrl-P"),document.addEventListener("keydown",factory.keyPressCtrlP))}else MeadCo.error("MeadCo.ScriptX.Print is not available to ScriptX.Services factory emulation.");return{set header(e){c.factory.log("set factory.printing.header: "+e),i.header=e},get header(){return i.header},set footer(e){i.footer=e},get footer(){return i.footer},set headerFooterFont(e){i.headerFooterFont=e},get headerFooterFont(){return i.headerFooterFont},set orientation(e){switch(e.toLowerCase()){case"landscape":i.page.orientation=s.PageOrientation.LANDSCAPE;break;case"portrait":i.page.orientation=s.PageOrientation.PORTRAIT}},get orientation(){return i.page.orientation===s.PageOrientation.PORTRAIT?"portrait":"landscape"},set portrait(e){i.page.orientation=e?s.PageOrientation.PORTRAIT:s.PageOrientation.LANDSCAPE},get portrait(){return i.page.orientation===s.PageOrientation.PORTRAIT},set leftMargin(e){i.page.margins.left=e},get leftMargin(){return i.page.margins.left},set topMargin(e){i.page.margins.top=e},get topMargin(){return i.page.margins.top},set bottomMargin(e){i.page.margins.bottom=e},get bottomMargin(){return i.page.margins.bottom},set rightMargin(e){i.page.margins.right=e},get rightMargin(){return i.page.margins.right},set templateURL(e){},get templateURL(){return"MeadCo://default"},IsTemplateSupported:function(){return!0},PageSetup:function(e){"function"!=typeof e&&(MeadCo.warn("PageSetup API in ScriptX.Print Service is not synchronous, there is no return value."),e=function(e){MeadCo.log("PageSetupDlg: "+e)}),MeadCo.ScriptX.Print.UI?MeadCo.ScriptX.Print.UI.PageSetup(e):(MeadCo.error("PageSetup dialog in ScriptX.Services needs a dialog implementation. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs"),e(!1))},PrintSetup:function(e){"function"!=typeof e&&(MeadCo.warn("PrintSetup API in ScriptX.Print Service is not synchronous, there is no return value."),e=function(e){MeadCo.log("PrintSetupDlg: "+e)}),MeadCo.ScriptX.Print.UI?MeadCo.ScriptX.Print.UI.PrinterSettings(e):(MeadCo.error("PrintSettings dialog in ScriptX.Services needs a dialog implementation. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs"),e(!1))},Preview:function(e){g.reportFeatureNotImplemented("Preview",e)},Print:function(e,t,r){return r||(r=function(e){MeadCo.log("A print has started")}),t&&("object"!=typeof t||t.id)||(t=null),u(e,function(){if(null===t)return s.printDocument();var e="string"==typeof t?t:t.id;return s.printFrame(e)},r)},PrintHTML:function(e,t,r){return void 0===r&&(r=function(e){}),o(e,t,r)},PrintHTMLEx:function(e,t,r,n,i){return void 0===i&&(i=function(e){}),o(e,t,i,r,n)},PrintPDF:function(e,t,r,n,i,o){return void 0===o&&(o=function(e){}),void 0!==a?(a.resetSettings(),void 0!==e.pagescaling?a.settings.pageScaling=e.pagescaling:a.settings.pageScaling=r?a.PdfPageScaling.SHRINKLARGEPAGES:a.PdfPageScaling.UNDEFINED,void 0!==e.autorotatecenter?a.settings.autoRotateCenter=e.autorotatecenter?a.BooleanOption.TRUE:a.BooleanOption.FALSE:a.settings.autoRotateCenter=a.BooleanOption.DEFAULT,void 0!==e.orientation?a.settings.orientation=1===e.orientation?a.PageOrientation.PORTRAIT:a.PageOrientation.LANDSCAPE:a.settings.orientation=this.portrait?a.PageOrientation.PORTRAIT:a.PageOrientation.LANDSCAPE,void 0!==e.pages?a.settings.pageRange=e.pages:a.settings.pageRange=void 0!==n&&void 0!==i&&-1!==n&&-1!==i?n+"-"+i:"",void 0!==e.monochrome?a.settings.monochrome=e.monochrome?a.BooleanOption.TRUE:a.BooleanOption.FALSE:a.settings.monochrome=a.BooleanOption.DEFAULT,void 0!==e.normalise||void 0!==e.normalize?a.settings.normalise=e.normalise||e.normalize?a.BooleanOption.TRUE:a.BooleanOption.FALSE:a.settings.normalise=a.BooleanOption.DEFAULT,void 0!==e.printMode?a.settings.printQuality=e.printMode:void 0!==e.printQuality&&(a.settings.printQuality=e.printQuality),void 0!==e.jobname&&(a.settings.jobDescription=e.jobname),void 0!==e.jobName&&(a.settings.jobDescription=e.jobName),p(e.url,t,o)):(MeadCo.error("MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation."),o(!1),!1)},BatchPrintPDF:function(e,t){this.BatchPrintPDFEx(e,function(){},"BatchPrintPDF",t)},BatchPrintPDFEx:function(e,t,r,n){if(void 0===n&&(n=function(e){}),void 0!==a)return a.resetSettings(),a.settings.pageRange=d.pageRange,a.settings.pageScaling=-1===i.viewScale?a.PdfPageScaling.SHRINKLARGEPAGES:a.PdfPageScaling.UNDEFINED,a.settings.orientation=this.portrait?a.PageOrientation.PORTRAIT:a.PageOrientation.LANDSCAPE,a.settings.printQuality=d.pdfPrintMode,void p(e,!1,n,t,r);MeadCo.error("MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation."),n(!1)},set units(e){this.SetMarginMeasure(e)},get units(){return this.GetMarginMeasure()},set paperSize(e){g.deviceSettings.paperSizeName=e},get paperSize(){return g.deviceSettings.paperSizeName},set paperSource(e){g.deviceSettings.paperSourceName=e},get paperSource(){return g.deviceSettings.paperSourceName},set paperSource2(e){g.deviceSettings.paperSourceName=e},get paperSource2(){return g.deviceSettings.paperSourceName},get pageWidth(){return g.deviceSettings.paperPageSize.width},get pageHeight(){return g.deviceSettings.paperPageSize.height},set copies(e){g.deviceSettings.copies=e},get copies(){return g.deviceSettings.copies},set collate(e){g.deviceSettings.collate=!0===e||1===e?g.CollateOptions.TRUE:g.CollateOptions.FALSE},get collate(){return g.deviceSettings.collate===g.CollateOptions.TRUE},set duplex(e){g.deviceSettings.duplex=e},get duplex(){return g.deviceSettings.duplex},set duplex2(e){g.deviceSettings.duplex=e},get duplex2(){return g.deviceSettings.duplex},set onbeforeprint(e){g.reportFeatureNotImplemented("onbeforeprint",e)},set onafterprint(e){g.reportFeatureNotImplemented("onafterprint",e)},set onuserprintpreview(e){g.reportFeatureNotImplemented("onuserprintpreview",e)},DefaultPrinter:function(){return g.deviceSettingsFor("systemdefault").printerName},get CurrentPrinter(){return g.printerName},set CurrentPrinter(e){this.currentPrinter=e},get currentPrinter(){return g.printerName},set currentPrinter(e){if("string"==typeof e){var t=g.onErrorAction;g.onErrorAction=g.ErrorAction.THROW;try{g.printerName=e,g.onErrorAction=t}catch(e){throw g.onErrorAction=t,e}}},get printer(){return g.printerName},set printer(e){if("string"==typeof e){var t=g.onErrorAction;g.onErrorAction=g.ErrorAction.THROW;try{g.printerName=e,g.onErrorAction=t}catch(e){g.onErrorAction=t}}},set printToFileName(e){g.deviceSettings.printToFileName=e},get printBackground(){return i.printBackgroundColorsAndImages},set printBackground(e){i.printBackgroundColorsAndImages=e},get viewScale(){return i.viewScale},set viewScale(e){i.viewScale=e},set unprintableLeft(e){g.deviceSettings.unprintableMargins.left=e},get unprintableLeft(){return g.deviceSettings.unprintableMargins.left},set unprintableRight(e){g.deviceSettings.unprintableMargins.right=e},get unprintableRight(){return g.deviceSettings.unprintableMargins.right},set unprintableTop(e){g.deviceSettings.unprintableMargins.top=e},get unprintableTop(){return g.deviceSettings.unprintableMargins.top},set unprintableBottom(e){g.deviceSettings.unprintableMargins.bottom=e},get unprintableBottom(){return g.deviceSettings.unprintableMargins.bottom},EnumPrinters:function(e){var t=g.availablePrinterNames;if(t&&0!==t.length){if(e<t.length)return t[e]}else if(0===e)return this.CurrentPrinter;return""},EnumJobs:function(e,t,r){var n,i=g.queue,o=new Array;for(e=e.toLowerCase(),n=0;n<i.length;n++)i[n].printerName.toLowerCase()===e&&o.push(i[n]);return t<o.length?(r.name=o[t].jobName,o[t].status):0},GetJobsCount:function(e){var t,r=g.queue,n=0;for(e=e.toLowerCase(),t=0;t<r.length;t++)r[t].printerName.toLowerCase()===e&&n++;return n},printerControl:function(e){return{get Forms(){return g.deviceSettingsFor(e).forms},get Bins(){return g.deviceSettingsFor(e).bins},get forms(){return g.deviceSettingsFor(e).forms},get bins(){return g.deviceSettingsFor(e).bins},get name(){return e},get status(){return g.deviceSettingsFor(e).port},get port(){return g.deviceSettingsFor(e).port},get attributes(){return g.deviceSettingsFor(e).attributes},get serverName(){return g.deviceSettingsFor(e).serverName},get shareName(){return g.deviceSettingsFor(e).shareName},get location(){return g.deviceSettingsFor(e).location},get isLocal(){return g.deviceSettingsFor(e).isLocal},get isNetwork(){return g.deviceSettingsFor(e).isNetwork},get isShared(){return g.deviceSettingsFor(e).isShared},get Jobs(){g.reportFeatureNotImplemented("printerControl.Jobs")},Purge:function(){g.reportFeatureNotImplemented("printerControl.Purge()")},Pause:function(){g.reportFeatureNotImplemented("printerControl.Pause()")},Resume:function(){g.reportFeatureNotImplemented("printerControl.Resume()")}}},GetMarginMeasure:function(){return i.page.units===g.MeasurementUnits.INCHES?2:1},SetMarginMeasure:function(e){i.page.units=2===e?g.MeasurementUnits.INCHES:g.MeasurementUnits.MM},SetPrintScale:function(e){i.viewScale=e},IsSpooling:function(){return g.isSpooling},OwnQueue:function(){return null},SetPageRange:function(e,t,r){e&&g.reportFeatureNotImplemented("SetPageRange selection only"),i.pageRange=t+"-"+r},SetPreviewZoom:function(){g.reportFeatureNotImplemented("SetPreviewZoom")},Sleep:function(){g.reportFeatureNotImplemented("Sleep")},TotalPrintPages:function(){g.reportFeatureNotImplemented("TotalPrintPages")},WaitForSpoolingComplete:function(e,t){g.waitForSpoolingComplete(e,t)},enhancedFormatting:d,PolyfillInit:function(){return MeadCo.ScriptX.Print.isConnected||s.connect("","",function(e){MeadCo.warn("Services server connection failed: "+e)}),MeadCo.ScriptX.Print.isConnected},PolyfillInitAsync:function(e,t){MeadCo.ScriptX.Print.isConnected?e(2):s.connectAsync("","",e,t)}}}),"function"==typeof factory.extendFactoryNamespace&&factory.extendFactoryNamespace("factory.object",function(){return this.factory.log("factory.object loaded."),this.factory}),"function"==typeof factory.extendFactoryNamespace&&factory.extendFactoryNamespace("factory.object.js",function(){return this.factory.log("factory.object.js loaded."),{FormatNumber:function(e){return isNaN(e)?0:"string"==typeof e?Number(e):e}}});
!function(e,m,l){"use strict";var o=MeadCo.createNS("MeadCo.ScriptX.Print.UI");function i(){var e=MeadCo.ScriptX.Print,l=e.deviceSettingsFor(e.printerName).bins,o=m("#fld-papersource");m("#fld-papersource > option").remove();for(var t=0;t<l.length;t++)o.append("<option>"+l[t]);o.val(e.deviceSettings.paperSourceName),o.hasClass("selectpicker")&&o.selectpicker("refresh")}function p(e){e.val((2540*parseFloat(e.val())/100).toFixed(2))}function f(e){e.val((100*parseFloat(e.val())/2540).toFixed(2))}o.version="1.7.2.0",o.PageSetup=function(e){if(!m.fn.modal)return console.error("MeadCo.ScriptX.Print.UI requires bootstrap Modal"),void e(!1);var t=!1,l="",o=(m.fn.modal.Constructor.VERSION||"").split(" ")[0].split(".")[0];if(m.fn.selectpicker&&"3"===o&&(l="selectpicker"),!m("#dlg-printoptions").length){var a;switch(console.log("UI.PageSetup bootstrap modal version: "+m.fn.modal.Constructor.VERSION),o){case"3":a='<style>.modal-dialog legend { font-size: 1.2em; font-weight: bold; margin-bottom: 10px; } .modal-dialog fieldset { padding-bottom: 0px; } .modal-dialog .options-modal-body { padding-bottom: 0px !important; } .modal-dialog .checkbox2 {  padding-top: 0px !important; min-height: 0px !important; } .modal-dialog .radio2 { padding-top: 0px !important; min-height: 0px !important; } </style><div class="modal fade" id="dlg-printoptions"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">Page setup</h4></div><div class="modal-body form-horizontal options-modal-body"><fieldset><legend>Paper</legend><div class="form-group"><label class="col-md-4 control-label" for="fld-papersize">Size</label><div class="col-md-8"><select class="'+l+' form-control show-tick" id="fld-papersize"></select></div></div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="radio2"><label class="radio-inline"><input type="radio" value="2" id="fld-portrait" name="fld-orientation"> Portrait</label><label class="radio-inline"><input type="radio" value="1" id="fld-landscape" name="fld-orientation"> Landscape</label></div></div></div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-shrinktofit" id="fld-shrinktofit"> Shrink to fit</label></div></div></div><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-printbackground" id="fld-printbackground"> Print background colour and images</label></div></div></div></fieldset><fieldset><legend>Margins</legend><div class="form-group"><div class="col-md-offset-4 col-md-8"><div class="radio2"><label class="radio-inline"><input type="radio" value="2" id="fld-millimetres" name="fld-measure"> Millimetres</label><label class="radio-inline"><input type="radio" value="1" id="fld-inches" name="fld-measure"> Inches</label></div></div></div><div class="form-group"><label class="control-label col-md-4">Left</label><div class="col-md-3"><input name="fld-marginL" id="fld-marginL" type="text" class="form-control text-right" data-rule="measure" value="1" /></div><label class="control-label col-md-2">Top</label><div class="col-md-3"><input name="fld-marginT" id="fld-marginT" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div><div class="form-group"><label class="control-label col-md-4">Right</label><div class="col-md-3"><input name="fld-marginR" id="fld-marginR" type="text" class="form-control text-right" data-rule="measure" value="1" /></div><label class="control-label col-md-2">Bottom</label><div class="col-md-3"><input name="fld-marginB" id="fld-marginB" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div></fieldset><fieldset><legend>Headers and footers</legend><div class="form-group"><label class="control-label col-md-4">Header</label><div class="col-md-8"><input type="text" name="fld-header" id="fld-header" class="form-control" style="max-width: none !important;" /></div></div><div class="form-group"><label class="control-label col-md-4">Footer</label><div class="col-md-8"><input type="text" name="fld-footer" id="fld-footer" class="form-control" style="max-width: none !important;" /></div></div></fieldset></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-saveoptions">OK</button><button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button></div></div>\x3c!-- /.modal-content --\x3e</div>\x3c!-- /.modal-dialog --\x3e</div>\x3c!-- /.modal --\x3e';break;case"4":a='<div class="modal fade" tabindex="-1" role="dialog" id="dlg-printoptions"><div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-lg" role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Page setup</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><div class="container-fluid"><fieldset><legend>Paper</legend><div class="form-group row"><label for="fld-papersize" class="col-md-4 col-form-label text-right col-form-label-sm">Size</label><div class="col-md-8"><select class="'+l+' form-control col-form-label-sm custom-select custom-select-sm" id="fld-papersize"></select></div></div><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-portrait" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Portrait</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-landscape" name="fld-orientation" /><label class="form-check-label" for="fld-portrait">Landscape</label></div></div></div><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-shrinktofit" id="fld-shrinktofit"><label class="form-check-label" for="fld-shrinktofit">Shrink to fit</label></div></div></div><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-printbackground" id="fld-printbackground"><label class="form-check-label" for="fld-printbackground">Print background colour and images</label></div></div></div></fieldset><fieldset><legend>Margins</legend><div class="form-group row"><div class="col-md-8 offset-md-4"><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="2" id="fld-millimetres" name="fld-measure" /><label class="form-check-label" for="fld-millimetres">Millimetres</label></div><div class="form-check form-check-inline"><input class="form-check-input" type="radio" value="1" id="fld-inches" name="fld-measure" /><label class="form-check-label" for="fld-inches">Inches</label></div></div></div><div class="form-group row"><label class="col-md-4 col-form-label text-right col-form-label-sm">Left</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginL" id="fld-marginL" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Top</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginT" id="fld-marginT" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div></div><div class="form-group row"><label class="col-md-4 col-form-label text-right col-form-label-sm">Right</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginR" id="fld-marginR" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div><label class="col-md-2 col-form-label text-right col-form-label-sm">Bottom</label><div class="col-md-3"><div class="input-group spinner" data-trigger="spinner"><input name="fld-marginB" id="fld-marginB" type="text" class="form-control text-right" data-rule="measure" value="1" /></div></div></div></fieldset><fieldset><legend>Headers and footers</legend><div class="form-group row"><label for="fld-header" class="col-md-4 col-form-label text-right col-form-label-sm">Header</label><div class="col-md-8"><input type="text" name="fld-header" id="fld-header" class="form-control form-control-sm" /></div></div><div class="form-group row"><label for="fld-footer" class="col-md-4 col-form-label text-right col-form-label-sm">Footer</label><div class="col-md-8"><input type="text" name="fld-footer" id="fld-footer" class="form-control form-control-sm" /></div></div></fieldset></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-saveoptions">OK</button><button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button></div></div></div></div>';break;default:return console.error("Unknown version of bootstrap: "+o),void e(!1)}m("body").append(a)}m('[name="fld-measure"]').off("change").on("change",function(){switch(m(this).val()){case"2":m("#dlg-printoptions input[type=text][data-rule=measure]").each(function(){p(m(this))});break;case"1":m("#dlg-printoptions input[type=text][data-rule=measure]").each(function(){f(m(this))})}}),m("#btn-saveoptions").off("click").on("click",function(e){var l,o;e.preventDefault(),l=m("#dlg-printoptions"),o=MeadCo.ScriptX.Print.HTML.settings,l.length&&(o.page.orientation=l.find('[name="fld-orientation"]:checked').val(),o.printBackgroundColorsAndImages=l.find("#fld-printbackground").prop("checked"),o.viewScale=l.find("#fld-shrinktofit").prop("checked")?-1:100,o.page.units=parseInt(l.find('[name="fld-measure"]:checked').val()),o.page.margins.left=l.find("#fld-marginL").val(),o.page.margins.top=l.find("#fld-marginT").val(),o.page.margins.right=l.find("#fld-marginR").val(),o.page.margins.bottom=l.find("#fld-marginB").val(),o.header=l.find("#fld-header").val(),o.footer=l.find("#fld-footer").val(),MeadCo.ScriptX.Print.deviceSettings.paperSizeName=m("#fld-papersize").val()),t=!0,m("#dlg-printoptions").modal("hide")}),m("#dlg-printoptions").off("hidden.bs.modal").on("hidden.bs.modal",function(){"function"==typeof e&&e(t)});var i=m("#dlg-printoptions"),d=MeadCo.ScriptX.Print.HTML.settings;i.find('[name="fld-orientation"]').val([d.page.orientation]),i.find("#fld-printbackground").prop("checked",d.printBackgroundColorsAndImages),i.find("#fld-shrinktofit").prop("checked",-1==d.viewScale),i.find('[name="fld-measure"]').val([d.page.units]),i.find("#fld-marginL").val(d.page.margins.left),i.find("#fld-marginT").val(d.page.margins.top),i.find("#fld-marginR").val(d.page.margins.right),i.find("#fld-marginB").val(d.page.margins.bottom),i.find("#fld-header").val(d.header),i.find("#fld-footer").val(d.footer);var r=MeadCo.ScriptX.Print,s=m("#fld-papersize"),n=r.deviceSettingsFor(r.printerName).forms;for(var c in m("#fld-papersize > option").remove(),n)s.append("<option>"+n[c]+"</option>");s.hasClass("selectpicker")&&s.selectpicker("refresh"),s.val(MeadCo.ScriptX.Print.deviceSettings.paperSizeName),i.modal("show"),s.hasClass("selectpicker")&&s.selectpicker("refresh")},o.PrinterSettings=function(e){if(!m.fn.modal)return console.error("MeadCo.ScriptX.Print.UI requires bootstrap Modal"),void e(!1);var l=!1,o="",t=(m.fn.modal.Constructor.VERSION||"").split(" ")[0].split(".")[0];if(m.fn.selectpicker&&"3"===t&&(o="selectpicker"),!m("#dlg-printersettings").length){var a;switch(console.log("UI.PageSetup bootstrap modal version: "+m.fn.modal.Constructor.VERSION),t){case"3":a='<style>.modal-dialog legend { font-size: 1.2em; font-weight: bold; margin-bottom: 10px; } .modal-dialog fieldset { padding-bottom: 0px; } .modal-dialog .options-modal-body { padding-bottom: 0px !important; } .modal-dialog .checkbox2 {  padding-top: 0px !important; min-height: 0px !important; } .modal-dialog .radio2 { padding-top: 0px !important; min-height: 0px !important; } </style><div class="modal fade" id="dlg-printersettings"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">Print</h4></div><div class="modal-body form-horizontal options-modal-body"><div class="form-group"><label class="col-md-4 control-label" for="fld-printerselect">Printer</label><div class="col-md-8"><select class="'+o+' form-control show-tick" id="fld-printerselect"></select></div></div><div class="form-group"><label class="col-md-4 control-label" for="fld-papersource">Paper source</label><div class="col-md-8"><select class="'+o+' form-control show-tick" id="fld-papersource"></select></div></div><div class="form-group"><label class="control-label col-md-4">Copies</label><div class="col-md-3"><input name="fld-copies" id="fld-copies" type="text" class="form-control text-right" data-rule="quantity" value="1" /></div><div class="col-md-5"><div class="checkbox2"><label class="checkbox-inline"><input type="checkbox" name="fld-collate" id="fld-collate"> Collate</label></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-savesettings">Print</button><button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button></div></div>\x3c!-- /.modal-content --\x3e</div>\x3c!-- /.modal-dialog --\x3e</div>\x3c!-- /.modal --\x3e';break;case"4":a='<div class="modal fade" id="dlg-printersettings"><div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role = "document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Print</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><div class="container-fluid"><div class="form-group row"><label for="fld-printerselect" class="col-md-4 col-form-label text-right col-form-label-sm">Printer</label><div class="col-md-8"><select class="'+o+' form-control col-form-label-sm custom-select custom-select-sm" id="fld-printerselect"></select></div></div><div class="form-group row"><label for="fld-papersource" class="col-md-4 col-form-label text-right col-form-label-sm">Paper source</label><div class="col-md-8"><select class="'+o+' form-control col-form-label-sm custom-select custom-select-sm" id="fld-papersource"></select></div></div><div class="form-group row align-items-center"><label for="fld-copies" class="col-md-4 col-form-label text-right col-form-label-sm">Copies</label><div class="col-md-3"><input name="fld-copies" id="fld-copies" type="text" class="form-control form-control-sm text-right" data-rule="quantity" value="1" /></div><div class="col-md-5"><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" name="fld-collate" id="fld-collate"><label class="form-check-label" for="fld-collate">Collate</label></div></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btn-savesettings">Print</button><button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button></div></div></div></div >';break;default:return console.error("Unknown version of bootstrap: "+t),void e(!1)}m("body").append(a),m('[name="fld-measure"]').on("change",function(){switch(m(this).val()){case"2":m("#dlg-printersettings input[type=text][data-rule=currency]").each(function(){p(m(this))});break;case"1":m("#dlg-printersettings input[type=text][data-rule=currency]").each(function(){f(m(this))})}}),m("#dlg-printersettings #fld-printerselect").change(function(e){!function(e){var l=MeadCo.ScriptX.Print,o=l.printerName,t=l.deviceSettings.paperSourceName,a=l.onErrorAction;l.onErrorAction=l.ErrorAction.THROW;try{l.printerName=e,i()}catch(e){alert("Sorry, an error has occurred:\n\n"+e.message)}try{l.printerName=o,l.deviceSettings.paperSourceName=t}catch(e){alert("Sorry, an error has occurred restoring current printer settings:\n\n"+e.message)}l.onErrorAction=a}(m(this).val())})}m("#btn-savesettings").off("click").on("click",function(e){e.preventDefault(),function(){var e=m("#dlg-printersettings"),l=MeadCo.ScriptX.Print;if(e.length){var o=l.onErrorAction;l.onErrorAction=l.ErrorAction.THROW;try{l.printerName=m("#fld-printerselect").val(),l.onErrorAction=o}catch(e){l.onErrorAction=o}var t=l.deviceSettings;t.paperSourceName=m("#fld-papersource").val(),t.collate=e.find("#fld-collate").prop("checked")?l.CollateOptions.TRUE:l.CollateOptions.FALSE,t.copies=e.find("#fld-copies").val()}}(),l=!0,m("#dlg-printersettings").modal("hide")}),m("#dlg-printersettings").off("hidden.bs.modal").on("hidden.bs.modal",function(){"function"==typeof e&&e(l)}),function(){var e=MeadCo.ScriptX.Print,l=m("#fld-printerselect"),o=e.availablePrinterNames;m("#fld-printerselect > option").remove();for(var t=0;t<o.length;t++)l.append("<option>"+o[t]);l.val(e.printerName),l.hasClass("selectpicker")&&l.selectpicker("refresh")}(),function(){var e=MeadCo.ScriptX.Print,l=e.deviceSettings;i();var o=m("#dlg-printersettings");o.find("#fld-collate").prop("checked",e.deviceSettings.collate===e.CollateOptions.TRUE),o.find("#fld-copies").val(l.copies)}(),m("#dlg-printersettings").modal("show"),"selectpicker"===o&&m("#dlg-printersettings .selectpicker").selectpicker("refresh")}}(window.MeadCo=window.MeadCo||{},jQuery);