!function(e,t,r){if(this[e]!==r||null!==document.getElementById(e)){if(MeadCo.log("ScriptX.Services ScriptX.factory emulation believes it may not be requred."),this[e]!==r&&MeadCo.log("this["+e+"] is defined"),null!==document.getElementById(e)&&MeadCo.log("document.getElementById("+e+") is defined"),this[e].object!==r)return void MeadCo.log("this["+e+"].object is defined -- not required!!!");MeadCo.log("this["+e+"].object is *not* defined")}MeadCo.log("ScriptX.Services ScriptX.factory emulation believes it is requred.");var n=function(){const e="1.15.2.2",t="8.3.0.0";let r="";const n=MeadCo.ScriptX.Print,i=MeadCo;let o=this;function a(e){i.log("factory emulation :: "+e)}return a("'factory' loaded "+e),{log:a,GetComponentVersion:function(i,s,c,g,u){a("factory.object.getcomponentversion: "+i);var p=e;switch(i.toLowerCase()){case"scriptx.factory":p=t;break;case"scriptx.factory.services":p=e;break;case"scriptx.services":if(""===r&&void 0!==n){var d=n.onErrorAction;n.onErrorAction=n.ErrorAction.THROW;try{var l=n.serviceDescription();if(null!==l)if("string"==typeof l.serviceVersion)r=l.serviceVersion;else{var f=l.serviceVersion;r=f.major+"."+f.minor+"."+f.build+"."+f.revision}}catch(t){r=e}n.onErrorAction=d}p=r;break;case"meadco.secmgr":try{p=o.secmgr.version}catch(e){p="0.0.0.0"}break;case"meadco.triprint":try{p=MeadCo.ScriptX.Print.HTML.version}catch(e){p="0.0.0.0"}}p=p.split("."),s[0]=p[0],c[0]=p[1],g[0]=p[2],u[0]=p[3]},ComponentVersionString:function(e){var t=new Object,r=new Object,n=new Object,i=new Object;return o.factory.GetComponentVersion(e,t,r,n,i),t[0]+"."+r[0]+"."+n[0]+"."+i[0]},get ScriptXVersion(){return t},get SecurityManagerVersion(){return t},IsUniqueIDAvailable:function(e){return!1},UniqueID:function(e){return 0},ResetUniqueID:function(e){return 0},baseURL:function(e){var t=document.createElement("a");return t.href=e,t.href},relativeURL:function(e){throw"MeadCo.ScriptX.Print :: relativeUrl is not implemented.\n\nPlease see https://github.com/medialize/URI.js for an alternative."},OnDocumentComplete:function(e,t){void 0===e.contentWindow?t():e.addEventListener("load",(function(e){t()}),{once:!0})},get rawPrinting(){var e="",t=MeadCo.ScriptX.Print;function r(r,n){var i=!1;if(void 0!==t){var a=factory.printing.printer;factory.printing.printer=e,r===t.ContentType.URL&&(n=o.factory.baseURL(n)),i=t.printDirect(r,n),factory.printing.printer=a}return i}return{get printer(){return e},set printer(t){var r=factory.printing.printer;if(factory.printing.printer=t,factory.printing.printer!==t)throw"Unknown printer";factory.printing.printer=r,e=t},printString:function(e){return void 0!==t&&r(t.ContentType.STRING,e)},printDocument:function(e){return void 0!==t&&r(t.ContentType.URL,e)}}},Shutdown:function(){return null},extendFactoryNamespace:function(e,t){var r=t();a("MeadCo factory extending namespace: "+e);for(var n=e.split("."),i=o,s=0;s<n.length;s++){var c=n[s];s===n.length-1?void 0===i[c]?(a("installing implementation at: "+c),i[c]=r):a("Warning - not overwriting package: "+c):void 0===i[c]?(a("initialising new: "+c),i[c]={}):a("using existing package: "+c),i=i[c]}},keyPressCtrlP:function(e){e.ctrlKey&&80==e.keyCode&&!e.shiftKey&&(e.preventDefault(),a("ctrl-p being handled."),o.print())}}}();this[e]=n}("factory"),"function"==typeof factory.extendFactoryNamespace&&factory.extendFactoryNamespace("factory.printing",(function(){const e=MeadCo.ScriptX.Print.HTML,t=MeadCo.ScriptX.Print.PDF,r=e.settings,n=MeadCo.ScriptX.Print,i=["html://","html4://","html5://"];let o=this,a="";function s(e,t,r){void 0===e&&(e=!0);const i=n.ensureSpoolingStatus();let o=!1,a=null;if(e){if(MeadCo.ScriptX.Print.UI){if(MeadCo.ScriptX.Print.UI.PrinterSettings((function(e){if(e){MeadCo.log("promptAndPrint requesting print ...");try{o=t(),r(o)}catch(e){a=e,MeadCo.error(e.message),r(!1)}}else r(!1);n.freeSpoolStatus(i)})),MeadCo.log("promptAndPrint exits ..."),null!=a)throw a;return o}MeadCo.warn("prompted print requested but no UI library loaded. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs")}try{o=t(),r(o)}catch(e){a=e,MeadCo.error(e.message),r(!1)}finally{n.freeSpoolStatus(i)}if(null!==a)throw a;return o}function c(e){var t=i.find((function(t){return 0===e.indexOf(t)}));return"string"==typeof t?e.substring(t.length):""}function g(t,r,n,i,a){var g=c(t);if(g.length>0){var u="<!doctype";g.substr(0,u.length).toLowerCase()===u&&(g=g.substring(g.indexOf(">")+1))}else t=o.factory.baseURL(t);return s(r,(function(){return MeadCo.log("printHtmlContent requesting print ..."),g.length>0?e.printHtml(g,null,i,a):e.printFromUrl(t,null,i,a)}),n)}function u(e,r,n,i,a){return void 0!==t?(e=o.factory.baseURL(e),s(r,(function(){return MeadCo.log("printPdfContent requesting print ..."),t.print(e,null,i,a)}),n)):(MeadCo.error("MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation."),n(!1),!1)}o.factory.log("factory.Printing loaded.");var p={get allPagesHeader(){return r.extraHeadersAndFooters.allPagesHeader},set allPagesHeader(e){r.extraHeadersAndFooters.allPagesHeader=e},get allPagesFooter(){return r.extraHeadersAndFooters.allPagesFooter},set allPagesFooter(e){r.extraHeadersAndFooters.allPagesFooter=e},get firstPageHeader(){return r.extraHeadersAndFooters.firstPageHeader},set firstPageHeader(e){r.extraHeadersAndFooters.firstPageHeader=e},get firstPageFooter(){return r.extraHeadersAndFooters.firstPageFooter},set firstPageFooter(e){r.extraHeadersAndFooters.firstPageFooter=e},get extraFirstPageFooter(){return r.extraHeadersAndFooters.extraFirstPageFooter},set extraFirstPageFooter(e){r.extraHeadersAndFooters.extraFirstPageFooter=e},get allHeaderHeight(){return r.extraHeadersAndFooters.allHeaderHeight},set allHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";r.extraHeadersAndFooters.allHeaderHeight=e},get allFooterHeight(){return r.extraHeadersAndFooters.allFooterHeight},set allFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";r.extraHeadersAndFooters.allFooterHeight=e},get firstHeaderHeight(){return r.extraHeadersAndFooters.firstHeaderHeight},set firstHeaderHeight(e){if("number"!=typeof e)throw"Invalid argument";r.extraHeadersAndFooters.firstHeaderHeight=e},get firstFooterHeight(){return r.extraHeadersAndFooters.firstFooterHeight},set firstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";r.extraHeadersAndFooters.firstFooterHeight=e},get extraFirstFooterHeight(){return r.extraHeadersAndFooters.extraFirstFooterHeight},set extraFirstFooterHeight(e){if("number"!=typeof e)throw"Invalid argument";r.extraHeadersAndFooters.extraFirstFooterHeight=e},get pageRange(){return r.pageRange},set pageRange(e){r.pageRange=e,void 0!==t&&(t.settings.pageRange=e)},get printingPass(){var t="";switch(r.printingPass){case e.PrintingPasses.DEFAULT:case e.PrintingPasses.ALL:t="all";break;case e.PrintingPasses.ODD:t="odd";break;case e.PrintingPasses.EVEN:t="even"}return t},set printingPass(t){var n=e.PrintingPasses.ALL;if("string"==typeof t)switch(t.toLowerCase()){case"odd":n=e.PrintingPasses.ODD;break;case"even":n=e.PrintingPasses.EVEN;break;case"odd&even":case"all":n=e.PrintingPasses.ALL}r.printingPass=n},get pdfPrintMode(){return void 0!==t?t.settings.printQuality:0},set pdfPrintMode(e){void 0!==t&&(t.settings.printQuality=e)}};return void 0!==n?(n.useAttributes(),"function"==typeof o.print&&(o.factory.log("overwriting outerScope.print"),o.print=function(){o.factory.log("window.print() called and being handled."),s(!0,(function(){return e.printDocument()}),(function(){}))}),null!=document.querySelector("[data-meadco-ctrlp='false']")||(o.factory.log("using addEventListener('keydown',factory.keyPressCtrlP) for Ctrl-P"),document.addEventListener("keydown",factory.keyPressCtrlP))):MeadCo.error("MeadCo.ScriptX.Print is not available to ScriptX.Services factory emulation."),{set header(e){o.factory.log("set factory.printing.header: "+e),r.header=e},get header(){return r.header},set footer(e){r.footer=e},get footer(){return r.footer},set headerFooterFont(e){r.headerFooterFont=e},get headerFooterFont(){return r.headerFooterFont},set orientation(t){switch(t.toLowerCase()){case"landscape":r.page.orientation=e.PageOrientation.LANDSCAPE;break;case"portrait":r.page.orientation=e.PageOrientation.PORTRAIT}},get orientation(){return r.page.orientation===e.PageOrientation.PORTRAIT?"portrait":"landscape"},set portrait(t){r.page.orientation=t?e.PageOrientation.PORTRAIT:e.PageOrientation.LANDSCAPE},get portrait(){return r.page.orientation===e.PageOrientation.PORTRAIT},set leftMargin(e){r.page.margins.left=e},get leftMargin(){return r.page.margins.left},set topMargin(e){r.page.margins.top=e},get topMargin(){return r.page.margins.top},set bottomMargin(e){r.page.margins.bottom=e},get bottomMargin(){return r.page.margins.bottom},set rightMargin(e){r.page.margins.right=e},get rightMargin(){return r.page.margins.right},set templateURL(e){},get templateURL(){return"MeadCo://default"},IsTemplateSupported:function(){return!0},PageSetup:function(e){"function"!=typeof e&&(MeadCo.warn("PageSetup API in ScriptX.Print Service is not synchronous, there is no return value."),e=function(e){MeadCo.log("PageSetupDlg: "+e)}),MeadCo.ScriptX.Print.UI?MeadCo.ScriptX.Print.UI.PageSetup(e):(MeadCo.error("PageSetup dialog in ScriptX.Services needs a dialog implementation. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs"),e(!1))},PrintSetup:function(e){"function"!=typeof e&&(MeadCo.warn("PrintSetup API in ScriptX.Print Service is not synchronous, there is no return value."),e=function(e){MeadCo.log("PrintSetupDlg: "+e)}),MeadCo.ScriptX.Print.UI?MeadCo.ScriptX.Print.UI.PrinterSettings(e):(MeadCo.error("PrintSettings dialog in ScriptX.Services needs a dialog implementation. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs"),e(!1))},Preview:function(t){if(t&&("object"!=typeof t||t.id)||(t=null),null!==t){var r="string"==typeof t?t:t.id;return e.previewFrame(r)}e.previewDocument()},Print:function(t,r,n){return n||(n=function(e){MeadCo.log("A print has started: "+e)}),r&&("object"!=typeof r||r.id)||(r=null),s(t,(function(){if(null!==r){var t="string"==typeof r?r:r.id;return e.printFrame(t)}return e.printDocument()}),n)},PrintHTML:function(e,t,r){return void 0===r&&(r=function(e){}),g(e,t,r)},PrintHTMLEx:function(e,t,r,n,i){return void 0===i&&(i=function(e){}),g(e,t,i,r,n)},PrintPDF:function(e,r,n,i,o,a){return void 0===a&&(a=function(e){}),void 0!==t?(t.resetSettings(),void 0!==e.pagescaling?t.settings.pageScaling=e.pagescaling:t.settings.pageScaling=n?t.PdfPageScaling.SHRINKLARGEPAGES:t.PdfPageScaling.UNDEFINED,void 0!==e.autorotatecenter?t.settings.autoRotateCenter=e.autorotatecenter?t.BooleanOption.TRUE:t.BooleanOption.FALSE:t.settings.autoRotateCenter=t.BooleanOption.DEFAULT,void 0!==e.orientation?t.settings.orientation=1===e.orientation?t.PageOrientation.PORTRAIT:t.PageOrientation.LANDSCAPE:t.settings.orientation=this.portrait?t.PageOrientation.PORTRAIT:t.PageOrientation.LANDSCAPE,void 0!==e.pages?t.settings.pageRange=e.pages:t.settings.pageRange=void 0!==i&&void 0!==o&&-1!==i&&-1!==o?i+"-"+o:"",void 0!==e.monochrome?t.settings.monochrome=e.monochrome?t.BooleanOption.TRUE:t.BooleanOption.FALSE:t.settings.monochrome=t.BooleanOption.DEFAULT,void 0!==e.normalise||void 0!==e.normalize?t.settings.normalise=e.normalise||e.normalize?t.BooleanOption.TRUE:t.BooleanOption.FALSE:t.settings.normalise=t.BooleanOption.DEFAULT,void 0!==e.printMode?t.settings.printQuality=e.printMode:void 0!==e.printQuality&&(t.settings.printQuality=e.printQuality),void 0!==e.jobname&&(t.settings.jobDescription=e.jobname),void 0!==e.jobName&&(t.settings.jobDescription=e.jobName),u(e.url,r,a)):(MeadCo.error("MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation."),a(!1),!1)},BatchPrintPDF:function(e,t){this.BatchPrintPDFEx(e,(function(){}),"BatchPrintPDF",t)},BatchPrintPDFEx:function(e,n,i,o){if(void 0===o&&(o=function(e){}),void 0!==t)return t.resetSettings(),t.settings.pageRange=p.pageRange,t.settings.pageScaling=-1===r.viewScale?t.PdfPageScaling.SHRINKLARGEPAGES:t.PdfPageScaling.UNDEFINED,t.settings.orientation=this.portrait?t.PageOrientation.PORTRAIT:t.PageOrientation.LANDSCAPE,t.settings.printQuality=p.pdfPrintMode,void u(e,!1,o,n,i);MeadCo.error("MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation."),o(!1)},set units(e){this.SetMarginMeasure(e)},get units(){return this.GetMarginMeasure()},set paperSize(e){n.deviceSettings.paperSizeName=e},get paperSize(){return n.deviceSettings.paperSizeName},set paperSource(e){n.deviceSettings.paperSourceName=e},get paperSource(){return n.deviceSettings.paperSourceName},set paperSource2(e){n.deviceSettings.paperSourceName=e},get paperSource2(){return n.deviceSettings.paperSourceName},get pageWidth(){return n.deviceSettings.paperPageSize.width},get pageHeight(){return n.deviceSettings.paperPageSize.height},set copies(e){n.deviceSettings.copies=e},get copies(){return n.deviceSettings.copies},set collate(e){n.deviceSettings.collate=!0===e||1===e?n.CollateOptions.TRUE:n.CollateOptions.FALSE},get collate(){return n.deviceSettings.collate===n.CollateOptions.TRUE},set duplex(e){n.deviceSettings.duplex=e},get duplex(){return n.deviceSettings.duplex},set duplex2(e){n.deviceSettings.duplex=e},get duplex2(){return n.deviceSettings.duplex},set onafterprint(e){n.reportFeatureNotImplemented("onafterprint",e)},set onbeforeprint(e){n.reportFeatureNotImplemented("onbeforeprint",e)},set onbeforeunload(e){a=e,window.addEventListener("beforeunload",(async t=>{MeadCo.log("beforeunload handler running"),MeadCo.ScriptX.Print.noJobsWaitingDelivery?MeadCo.log("no jobs are waiting client side"):(MeadCo.log("jobs are waiting client side, will prompt user (custom text is not supported by modern browsers)"),t.returnValue=e,t.preventDefault())}))},get onbeforeunload(){return a},set onpagesetup(e){n.reportFeatureNotImplemented("onpagesetup",e)},set onuserpagesetup(e){n.reportFeatureNotImplemented("onuserpagesetup",e)},set onuserprint(e){n.reportFeatureNotImplemented("onuserprint",e)},set onuserprintpreview(e){n.reportFeatureNotImplemented("onuserprintpreview",e)},DefaultPrinter:function(){return n.deviceSettingsFor("systemdefault").printerName},AddPrinterConnection:function(e){n.addPrinterConnection(e)},RemovePrinterConnection:function(e){n.removePrinterConnection(e)},AddPrinterConnectionAsync:function(e,t){n.addPrinterConnectionAsync(e,t,(function(e){n.reportError(e)}))},RemovePrinterConnectionAsync:function(e,t){n.removePrinterConnectionAsync(e,t,(function(e){n.reportError(e)}))},get CurrentPrinter(){return n.printerName},set CurrentPrinter(e){this.currentPrinter=e},get currentPrinter(){return n.printerName},set currentPrinter(e){if("string"==typeof e){var t=n.onErrorAction;n.onErrorAction=n.ErrorAction.THROW;try{n.printerName=e,n.onErrorAction=t}catch(e){throw n.onErrorAction=t,e}}},get printer(){return n.printerName},set printer(e){if("string"==typeof e){var t=n.onErrorAction;n.onErrorAction=n.ErrorAction.THROW;try{n.printerName=e,n.onErrorAction=t}catch(e){n.onErrorAction=t}}},set printToFileName(e){n.deviceSettings.printToFileName=e},get printBackground(){return r.printBackgroundColorsAndImages},set printBackground(e){r.printBackgroundColorsAndImages=e},get viewScale(){return r.viewScale},set viewScale(e){r.viewScale=e},set unprintableLeft(e){n.deviceSettings.unprintableMargins.left=e},get unprintableLeft(){return n.deviceSettings.unprintableMargins.left},set unprintableRight(e){n.deviceSettings.unprintableMargins.right=e},get unprintableRight(){return n.deviceSettings.unprintableMargins.right},set unprintableTop(e){n.deviceSettings.unprintableMargins.top=e},get unprintableTop(){return n.deviceSettings.unprintableMargins.top},set unprintableBottom(e){n.deviceSettings.unprintableMargins.bottom=e},get unprintableBottom(){return n.deviceSettings.unprintableMargins.bottom},EnumPrinters:function(e){var t=n.availablePrinterNames;if(t&&0!==t.length){if(e<t.length)return t[e]}else if(0===e)return this.CurrentPrinter;return""},EnumJobs:function(e,t,r){var i,o=n.queue,a=new Array;for(e=e.toLowerCase(),i=0;i<o.length;i++)o[i].printerName.toLowerCase()===e&&a.push(o[i]);return t<a.length?(r.name=a[t].jobName,a[t].status):0},GetJobsCount:function(e){var t,r=n.queue,i=0;for(e=e.toLowerCase(),t=0;t<r.length;t++)r[t].printerName.toLowerCase()===e&&i++;return i},printerControl:function(e){return{get Forms(){return n.deviceSettingsFor(e).forms},get Bins(){return n.deviceSettingsFor(e).bins},get forms(){return n.deviceSettingsFor(e).forms},get bins(){return n.deviceSettingsFor(e).bins},get name(){return e},get status(){return n.deviceSettingsFor(e).port},get port(){return n.deviceSettingsFor(e).port},get attributes(){return n.deviceSettingsFor(e).attributes},get serverName(){return n.deviceSettingsFor(e).serverName},get shareName(){return n.deviceSettingsFor(e).shareName},get location(){return n.deviceSettingsFor(e).location},get isLocal(){return n.deviceSettingsFor(e).isLocal},get isNetwork(){return n.deviceSettingsFor(e).isNetwork},get isShared(){return n.deviceSettingsFor(e).isShared},get Jobs(){n.reportFeatureNotImplemented("printerControl.Jobs")},Purge:function(){n.reportFeatureNotImplemented("printerControl.Purge()")},Pause:function(){n.reportFeatureNotImplemented("printerControl.Pause()")},Resume:function(){n.reportFeatureNotImplemented("printerControl.Resume()")}}},GetMarginMeasure:function(){return r.page.units===n.MeasurementUnits.INCHES?2:1},SetMarginMeasure:function(e){r.page.units=2===e?n.MeasurementUnits.INCHES:n.MeasurementUnits.MM},SetPrintScale:function(e){r.viewScale=e},IsSpooling:function(){return n.isSpooling},OwnQueue:function(){return null},SetPageRange:function(e,t,i){e&&n.reportFeatureNotImplemented("SetPageRange selection only"),r.pageRange=t+"-"+i},SetPreviewZoom:function(){n.reportFeatureNotImplemented("SetPreviewZoom")},Sleep:function(){n.reportFeatureNotImplemented("Sleep")},TotalPrintPages:function(){n.reportFeatureNotImplemented("TotalPrintPages")},WaitForSpoolingComplete:function(e,t){n.waitForSpoolingComplete(e,t)},enhancedFormatting:p,PolyfillInit:function(){return MeadCo.ScriptX.Print.isConnected||e.connect("","",(function(e){MeadCo.warn("Services server connection failed: "+e)})),MeadCo.ScriptX.Print.isConnected},PolyfillInitAsync:function(t,r){MeadCo.ScriptX.Print.isConnected?t(2):e.connectAsync("","",t,r)},get PolyfillAuthorisationCookie(){return MeadCo.ScriptX.Print.authorisationCookie},set PolyfillAuthorisationCookie(e){MeadCo.ScriptX.Print.authorisationCookie=e}}})),"function"==typeof factory.extendFactoryNamespace&&factory.extendFactoryNamespace("factory.object",(function(){var e=this;return e.factory.log("factory.object loaded."),e.factory})),"function"==typeof factory.extendFactoryNamespace&&factory.extendFactoryNamespace("factory.object.js",(function(){return this.factory.log("factory.object.js loaded."),{FormatNumber:function(e){return isNaN(e)?0:"string"==typeof e?Number(e):e}}}));
//# sourceMappingURL=meadco-scriptxfactory.min.js.map
