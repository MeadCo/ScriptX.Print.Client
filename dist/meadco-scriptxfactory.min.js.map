{"version":3,"file":"meadco-scriptxfactory.min.js","names":["name","definition","undefined","this","document","getElementById","MeadCo","log","object","theModule","moduleversion","emulatedVersion","servicesVersion","printApi","ScriptX","Print","logApi","outerScope","str","GetComponentVersion","sComponent","a","b","c","d","v","toLowerCase","ea","onErrorAction","ErrorAction","THROW","sd","serviceDescription","serviceVersion","sv","major","minor","build","revision","e","secmgr","version","HTML","split","ComponentVersionString","sProgId","Object","factory","ScriptXVersion","SecurityManagerVersion","IsUniqueIDAvailable","bForMachine","UniqueID","ResetUniqueID","baseURL","sUrl","link","createElement","href","relativeURL","OnDocumentComplete","frameOrWindow","callback","contentWindow","addEventListener","once","rawPrinting","sPrinterName","printDirect","eContentType","sContent","bPrinted","p","printing","printer","ContentType","URL","printerName","printString","s","STRING","printDocument","Shutdown","extendFactoryNamespace","namespaces","scope","i","length","packageName","keyPressCtrlP","ctrlKey","keyCode","shiftKey","preventDefault","print","printHtml","printPdf","PDF","settings","htmlPrefixes","unloadMsg","promptAndPrint","bPrompt","fnPrint","fnNotifyStarted","lock","ensureSpoolingStatus","bStarted","err","UI","PrinterSettings","dlgAccepted","error","message","freeSpoolStatus","warn","isSnippet","foundPrefix","find","sPrefix","indexOf","substring","printHtmlContent","fnCallback","data","sHtml","docType","substr","printFromUrl","printPdfContent","iEnhancedFormatting","allPagesHeader","extraHeadersAndFooters","allPagesFooter","firstPageHeader","firstPageFooter","extraFirstPageFooter","allHeaderHeight","allFooterHeight","firstHeaderHeight","firstFooterHeight","extraFirstFooterHeight","pageRange","printingPass","PrintingPasses","DEFAULT","ALL","ODD","EVEN","x","pdfPrintMode","printQuality","useAttributes","querySelector","header","footer","headerFooterFont","orientation","sOrientation","page","PageOrientation","LANDSCAPE","PORTRAIT","portrait","bPortrait","leftMargin","n","margins","left","topMargin","top","bottomMargin","bottom","rightMargin","right","templateURL","IsTemplateSupported","PageSetup","fnNotify","bDlgOK","PrintSetup","Preview","sOrOFrame","id","sFrame","previewFrame","previewDocument","printFrame","PrintHTML","PrintHTMLEx","PrintPDF","options","bShrinkToFit","iPageFrom","iPageTo","resetSettings","pagescaling","pageScaling","PdfPageScaling","SHRINKLARGEPAGES","UNDEFINED","autorotatecenter","autoRotateCenter","BooleanOption","TRUE","FALSE","pages","monochrome","normalise","normalize","printMode","jobname","jobDescription","jobName","url","BatchPrintPDF","BatchPrintPDFEx","viewScale","units","enumUnits","SetMarginMeasure","GetMarginMeasure","paperSize","sPaperSize","deviceSettings","paperSizeName","paperSource","sPaperSource","paperSourceName","paperSource2","pageWidth","paperPageSize","width","pageHeight","height","copies","nCopies","collate","bCollate","CollateOptions","duplex","duplex2","onafterprint","fn","reportFeatureNotImplemented","onbeforeprint","onbeforeunload","sMsg","window","async","noJobsWaitingDelivery","returnValue","onpagesetup","onuserpagesetup","onuserprint","onuserprintpreview","DefaultPrinter","deviceSettingsFor","AddPrinterConnection","sShareName","addPrinterConnection","RemovePrinterConnection","removePrinterConnection","AddPrinterConnectionAsync","onSuccess","addPrinterConnectionAsync","errTxt","reportError","RemovePrinterConnectionAsync","removePrinterConnectionAsync","CurrentPrinter","currentPrinter","printToFileName","sFileName","printBackground","printBackgroundColorsAndImages","bPrintBackground","unprintableLeft","unprintableMargins","unprintableRight","unprintableTop","unprintableBottom","EnumPrinters","index","arP","availablePrinterNames","EnumJobs","iIndex","jobNameOut","jobs","queue","plist","Array","push","status","GetJobsCount","printerControl","Forms","forms","Bins","bins","port","attributes","serverName","shareName","location","isLocal","isNetwork","isShared","Jobs","Purge","Pause","Resume","MeasurementUnits","INCHES","MM","SetPrintScale","value","IsSpooling","isSpooling","OwnQueue","SetPageRange","bSelectionOnly","iFrom","iTo","SetPreviewZoom","Sleep","TotalPrintPages","WaitForSpoolingComplete","iTimeout","fnComplete","waitForSpoolingComplete","enhancedFormatting","PolyfillInit","isConnected","connect","PolyfillInitAsync","resolve","reject","connectAsync","PolyfillAuthorisationCookie","authorisationCookie","cookie","FormatNumber","arg","isNaN","Number"],"sources":["meadco-scriptxfactory.js"],"mappings":"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","ignoreList":[],"sourcesContent":["/**\r\n * MeadCo ScriptX 'window.factory' shim (support for modern browsers) JS client library.<br/>\r\n * \r\n * The ScriptX Add-on for Internet Explorer is included on a html document with an &lt;object /&gt; element with a de-facto standard id of 'factory': &lt;object id='factory' /&gt;.\r\n * \r\n * The object is referenced with the property window.factory which exposes properties and methods to define print setting and perform operations such as printing a document or frame.\r\n * \r\n * The object has three further properties:\r\n * - object\r\n *   - js\r\n * - rawPrinting  \r\n * - printing\r\n *   - printerControl\r\n *   - enhancedFormatting\r\n *\r\n * This javascript 'module' provides partial emulation of window.factory, window.factory.object and window.factory.object.js\r\n * \r\n * Full emulation (and almost complete implementation) is provided for window.factory.printing, window.factory.printing.printerControl, window.factory.printing.enhancedFormatting. The most notable absent implementation is an implementation of print preview.\r\n * \r\n * Full emulation is provided for window.factory.rawPrinting. Please note that the implementation is synchronous and browsers will issue a warning to the console.\r\n * \r\n * ScriptX Add-on for Internet Explorer intercepts the browser UI for printing. For obvious reasons this is not possible with javascript, however ::\r\n * \r\n * <strong>PLEASE NOTE:</strong> This library replaces window.print(). \r\n * \r\n * Full documentation on the properties/methods is provided by the {@link https://www.meadroid.com/Developers/KnowledgeBank/TechnicalReference/ScriptXAddOn|technical reference documentation} for the ScriptX Add-on for Internet Explorer. That documentation is not reproduced here.\r\n * \r\n * If the startup script determines that the ScriptX Add.on for IE is already active then it will quietly give priority to the object. In other words, the Add-on has precedence on Internet Explorer.\r\n * \r\n * This enables the same experience (almost) to be delivered to any browser on any device with the same html/javascript code.\r\n * \r\n * It is strongly recommended that the [MeadCoScriptJS library]{@link https://github.com/MeadCo/MeadCoScriptXJS} is used in conjunction with this library as it provides code (Promises) to assist\r\n * with working with the significant difference between the synchronous nature of the functions of ScriptX.Add-on (which hide the underlying asynchrony) and the asynchronous nature of javascript AJAX processing.\r\n * \r\n * Requires:\r\n * - MeadCo.Core\r\n * - MeadCo.ScriptX.Print\r\n * - MeadCo.ScriptX.Print.HTML\r\n *\r\n * - MeadCo.ScriptX.Print.Licensing when using ScritpX.Services for Windows PC\r\n *      \r\n * MeadCo.ScriptX.Print.HTML.connect[Async]() or MeadCo.ScriptX.Print.connect[Async]() *MUST* be called before using the apis in this library.\r\n * \r\n * See [ScriptX Samples]{@link https://scriptxprintsamples.meadroid.com} for a lot of samples on using this code.\r\n * \r\n * Some Add-on APIs lead to system provided dialogs (e.g. printer and paper setup) - support for implementing the dialogs in javascript as simple plug-ins is provided, along with an example implementation using bootstrap/jQuery (see jQuery-MeadCo.ScriptX.Print.UI.js)\r\n *\r\n * @example\r\n * MeadCo.ScriptX.Print.UI = {\r\n *    PageSetup: function(fnDialgCompleteCallBack) { ... dialog code ...},\r\n *    PrinterSettings: function(fnDialgCompleteCallBack) { ... dialog code ...}\r\n * }\r\n * \r\n * @namespace factory\r\n */\r\n\r\n// we anti-polyfill &lt;object id=\"factory\" /&gt;\r\n// enabling old code to run in modern browsers\r\n//\r\n// static singleton instances.\r\n//\r\n; (function (name, definition, undefined) {\r\n\r\n    if (this[name] !== undefined || document.getElementById(name) !== null) {\r\n        MeadCo.log(\"ScriptX.Services ScriptX.factory emulation believes it may not be requred.\");\r\n        if (this[name] !== undefined) {\r\n            MeadCo.log(\"this[\" + name + \"] is defined\");\r\n        }\r\n        if (document.getElementById(name) !== null) {\r\n            MeadCo.log(\"document.getElementById(\" + name + \") is defined\");\r\n        }\r\n        if (this[name].object !== undefined) {\r\n            MeadCo.log(\"this[\" + name + \"].object is defined -- not required!!!\");\r\n            return;\r\n        } else {\r\n            MeadCo.log(\"this[\" + name + \"].object is *not* defined\");\r\n        }\r\n    }\r\n\r\n    MeadCo.log(\"ScriptX.Services ScriptX.factory emulation believes it is requred.\");\r\n    var theModule = definition();\r\n\r\n    // Assign to the global object (window)\r\n    (this)[name] = theModule;\r\n\r\n})('factory', function () {\r\n    // If this is executing, we believe we are needed.\r\n    // protected API\r\n    const moduleversion = \"1.16.1.0\";\r\n    const emulatedVersion = \"8.3.0.0\";\r\n    let servicesVersion = \"\";\r\n    const printApi = MeadCo.ScriptX.Print;\r\n    const logApi = MeadCo; // could be console\r\n\r\n    let outerScope = this;\r\n\r\n    function log(str) {\r\n        logApi.log(\"factory emulation :: \" + str);\r\n    }\r\n\r\n    log(\"'factory' loaded \" + moduleversion);\r\n\r\n    // public API.\r\n    return {\r\n        log: log,\r\n\r\n        // 'factory' functions\r\n\r\n        /* GetComponentVersion is no longer documented . It is implemented as MeadCoScriptJS relies on it.\r\n         * \r\n         * We support ScriptX ProgIds and progid style names for scriptx services.\r\n         */\r\n        GetComponentVersion: function (sComponent, a, b, c, d) {\r\n            log(\"factory.object.getcomponentversion: \" + sComponent);\r\n            var v = moduleversion;\r\n\r\n            switch (sComponent.toLowerCase()) {\r\n                case \"scriptx.factory\":\r\n                    v = emulatedVersion;\r\n                    break;\r\n\r\n                case \"scriptx.factory.services\":\r\n                    v = moduleversion;\r\n                    break;\r\n\r\n                case \"scriptx.services\":\r\n                    if (servicesVersion === \"\") {\r\n                        if (typeof printApi !== \"undefined\") {\r\n                            var ea = printApi.onErrorAction;\r\n\r\n                            printApi.onErrorAction = printApi.ErrorAction.THROW;\r\n\r\n                            try {\r\n                                var sd = printApi.serviceDescription();\r\n                                if (sd !== null) {\r\n                                    if (typeof sd.serviceVersion === \"string\") {\r\n                                        servicesVersion = sd.serviceVersion;\r\n                                    }\r\n                                    else {\r\n                                        var sv = sd.serviceVersion;\r\n                                        servicesVersion = sv.major + \".\" + sv.minor + \".\" + sv.build + \".\" + sv.revision;\r\n                                    }\r\n                                }\r\n                            } catch (e) { servicesVersion = moduleversion; }\r\n\r\n                            printApi.onErrorAction = ea;\r\n                        }\r\n                    }\r\n                    v = servicesVersion;\r\n                    break;\r\n\r\n                case \"meadco.secmgr\":\r\n                    try {\r\n                        v = outerScope.secmgr.version;\r\n                    } catch (e) { v = \"0.0.0.0\"; }\r\n                    break;\r\n\r\n                case \"meadco.triprint\":\r\n                    try {\r\n                        v = MeadCo.ScriptX.Print.HTML.version;\r\n                    } catch (e) { v = \"0.0.0.0\"; }\r\n                    break;\r\n            }\r\n\r\n            v = v.split(\".\");\r\n            a[0] = v[0];\r\n            b[0] = v[1];\r\n            c[0] = v[2];\r\n            d[0] = v[3];\r\n        },\r\n\r\n        /*\r\n         * Only ScriptX related ProgIds are supported.\r\n         *\r\n         */\r\n        ComponentVersionString: function (sProgId) {\r\n            var a = new Object();\r\n            var b = new Object();\r\n            var c = new Object();\r\n            var d = new Object();\r\n\r\n            outerScope.factory.GetComponentVersion(sProgId, a, b, c, d);\r\n            return a[0] + \".\" + b[0] + \".\" + c[0] + \".\" + d[0];\r\n        },\r\n\r\n        get ScriptXVersion() { return emulatedVersion; },\r\n        get SecurityManagerVersion() { return emulatedVersion; },\r\n\r\n        /*\r\n         * Unique IDs are not suported in services\r\n         */\r\n        IsUniqueIDAvailable: function (bForMachine) { return false; },\r\n        UniqueID: function (bForMachine) { return 0; },\r\n        ResetUniqueID: function (bForMachine) { return 0; },\r\n\r\n        baseURL: function (sUrl) {\r\n            var link = document.createElement(\"a\");\r\n            link.href = sUrl;\r\n            return link.href;\r\n        },\r\n\r\n        relativeURL: function (sUrl) {\r\n            throw \"MeadCo.ScriptX.Print :: relativeUrl is not implemented.\\n\\nPlease see https://github.com/medialize/URI.js for an alternative.\";\r\n        },\r\n\r\n        OnDocumentComplete: function (frameOrWindow, callback) {\r\n            // other windows is an anachronism we dont support, this window is, by \r\n            // definition, complete\r\n            if (typeof frameOrWindow.contentWindow === \"undefined\") {\r\n                callback();\r\n            }\r\n            else {\r\n                // a frame .. listen for load \r\n                frameOrWindow.addEventListener(\"load\", function (e) {\r\n                    callback();\r\n                }, { once: true });\r\n            }\r\n        },\r\n\r\n        get rawPrinting() {\r\n            var sPrinterName = \"\";\r\n            var printApi = MeadCo.ScriptX.Print;\r\n\r\n            function printDirect(eContentType, sContent) {\r\n\r\n                var bPrinted = false;\r\n\r\n                if (typeof printApi !== \"undefined\") {\r\n\r\n                    var p = factory.printing.printer;\r\n\r\n                    factory.printing.printer = sPrinterName;\r\n\r\n                    if (eContentType === printApi.ContentType.URL) {\r\n                        sContent = outerScope.factory.baseURL(sContent);\r\n                    }\r\n\r\n                    bPrinted = printApi.printDirect(eContentType, sContent);\r\n\r\n                    factory.printing.printer = p;\r\n                }\r\n\r\n                return bPrinted;\r\n            }\r\n\r\n            return {\r\n\r\n                get printer() { return sPrinterName; },\r\n                set printer(printerName) {\r\n                    var p = factory.printing.printer;\r\n                    factory.printing.printer = printerName;\r\n                    if (factory.printing.printer !== printerName) {\r\n                        throw \"Unknown printer\";\r\n                    }\r\n                    factory.printing.printer = p;\r\n                    sPrinterName = printerName;\r\n                },\r\n\r\n                printString: function (s) {\r\n                    return typeof printApi !== \"undefined\" ? printDirect(printApi.ContentType.STRING, s) : false;\r\n                },\r\n\r\n                printDocument: function (sUrl) {\r\n                    return typeof printApi !== \"undefined\" ? printDirect(printApi.ContentType.URL, sUrl) : false;\r\n                }\r\n            };\r\n        },\r\n\r\n\r\n        /*\r\n         * A no op for services \r\n         */\r\n        Shutdown: function () {\r\n            return null;\r\n        },\r\n\r\n        // extend the namespace\r\n        extendFactoryNamespace: function (name, definition) {\r\n            var theModule = definition();\r\n\r\n            log(\"MeadCo factory extending namespace: \" + name);\r\n            // walk/build the namespace part by part and assign the module to the leaf\r\n            var namespaces = name.split(\".\");\r\n            var scope = outerScope;\r\n            for (var i = 0; i < namespaces.length; i++) {\r\n                var packageName = namespaces[i];\r\n                if (i === namespaces.length - 1) {\r\n                    if (typeof scope[packageName] === \"undefined\") {\r\n                        log(\"installing implementation at: \" + packageName);\r\n                        scope[packageName] = theModule;\r\n                    } else {\r\n                        log(\"Warning - not overwriting package: \" + packageName);\r\n                    }\r\n                } else if (typeof scope[packageName] === \"undefined\") {\r\n                    log(\"initialising new: \" + packageName);\r\n                    scope[packageName] = {};\r\n                } else {\r\n                    log(\"using existing package: \" + packageName);\r\n                }\r\n                scope = scope[packageName];\r\n            }\r\n        },\r\n\r\n        // a Ctrl-P handler function \r\n        keyPressCtrlP: function (e) {\r\n            if (e.ctrlKey && e.keyCode == 80 && !e.shiftKey) {\r\n                e.preventDefault();\r\n                log(\"ctrl-p being handled.\");\r\n                outerScope.print();\r\n            }\r\n        },\r\n\r\n    };\r\n});\r\n\r\n; (function (name, definition) {\r\n    if (typeof factory.extendFactoryNamespace === \"function\") {\r\n        factory.extendFactoryNamespace(name, definition);\r\n    }\r\n})('factory.printing', function () {\r\n\r\n    // protected API\r\n    const printHtml = MeadCo.ScriptX.Print.HTML;\r\n    const printPdf = MeadCo.ScriptX.Print.PDF;\r\n    const settings = printHtml.settings;\r\n    const printApi = MeadCo.ScriptX.Print;\r\n    const htmlPrefixes = [\"html://\", \"html4://\", \"html5://\"];\r\n\r\n    let outerScope = this;\r\n    let unloadMsg = \"\";\r\n\r\n    outerScope.factory.log(\"factory.Printing loaded.\");\r\n\r\n    function promptAndPrint(bPrompt, fnPrint, fnNotifyStarted) {\r\n        if (typeof (bPrompt) === 'undefined') bPrompt = true;\r\n        const lock = printApi.ensureSpoolingStatus();\r\n        let bStarted = false;\r\n        let err = null;\r\n\r\n        if (bPrompt) {\r\n            if (MeadCo.ScriptX.Print.UI) {\r\n                MeadCo.ScriptX.Print.UI.PrinterSettings(function (dlgAccepted) {\r\n                    if (dlgAccepted) {\r\n                        MeadCo.log(\"promptAndPrint requesting print ...\");\r\n                        try {\r\n                            bStarted = fnPrint();\r\n                            fnNotifyStarted(bStarted);\r\n                        }\r\n                        catch (e) {\r\n                            err = e;\r\n                            MeadCo.error(e.message)\r\n                            fnNotifyStarted(false);\r\n                        }\r\n                    }\r\n                    else\r\n                        fnNotifyStarted(false);\r\n\r\n                    printApi.freeSpoolStatus(lock);\r\n\r\n                });\r\n\r\n                MeadCo.log(\"promptAndPrint exits ...\");\r\n\r\n                if (err != null) { // not great but a breaking change to remove this behaviour\r\n                    throw err;\r\n                }\r\n\r\n                return bStarted;\r\n            }\r\n            MeadCo.warn(\"prompted print requested but no UI library loaded. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs\");\r\n        }\r\n\r\n        try {\r\n            bStarted = fnPrint();\r\n            fnNotifyStarted(bStarted);\r\n        }\r\n        catch (e) {\r\n            err = e;\r\n            MeadCo.error(e.message)\r\n            fnNotifyStarted(false);\r\n        }\r\n        finally {\r\n            printApi.freeSpoolStatus(lock);\r\n        }\r\n\r\n        if (err !== null)\r\n            throw err;\r\n\r\n\r\n        return bStarted;\r\n    }\r\n\r\n    function isSnippet(sContent) {\r\n\r\n        var foundPrefix = htmlPrefixes.find(function (sPrefix) {\r\n            return sContent.indexOf(sPrefix) === 0;\r\n        });\r\n\r\n        if (typeof foundPrefix === \"string\") {\r\n            return sContent.substring(foundPrefix.length);\r\n        }\r\n\r\n        return \"\";\r\n    }\r\n\r\n    function printHtmlContent(sUrl, bPrompt, fnNotifyStarted, fnCallback, data) {\r\n\r\n        var sHtml = isSnippet(sUrl);\r\n\r\n        // if requesting snippet then trim to just the html\r\n        if (sHtml.length > 0) {\r\n            var docType = \"<!doctype\";\r\n\r\n            // add-on scripters might also add doctype but the server handles this \r\n            if (sHtml.substr(0, docType.length).toLowerCase() === docType) {\r\n                sHtml = sHtml.substring(sHtml.indexOf(\">\") + 1);\r\n            }\r\n        } else {\r\n            // if a relative URL supplied then add the base URL of this website\r\n            sUrl = outerScope.factory.baseURL(sUrl);\r\n        }\r\n\r\n        return promptAndPrint(bPrompt,\r\n            function () {\r\n                MeadCo.log(\"printHtmlContent requesting print ...\");\r\n                return sHtml.length > 0 ? printHtml.printHtml(sHtml, null, fnCallback, data) : printHtml.printFromUrl(sUrl, null, fnCallback, data);\r\n            }, fnNotifyStarted);\r\n\r\n    }\r\n\r\n    function printPdfContent(sUrl, bPrompt, fnNotifyStarted, fnCallback, data) {\r\n        // if a relative URL supplied then add the base URL of this website\r\n        if (typeof printPdf !== \"undefined\") {\r\n            sUrl = outerScope.factory.baseURL(sUrl);\r\n\r\n            return promptAndPrint(bPrompt,\r\n                function () {\r\n                    MeadCo.log(\"printPdfContent requesting print ...\");\r\n                    return printPdf.print(sUrl, null, fnCallback, data);\r\n                },\r\n                fnNotifyStarted);\r\n        }\r\n\r\n        MeadCo.error(\"MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation.\");\r\n        fnNotifyStarted(false);\r\n        return false;\r\n    }\r\n\r\n    var iEnhancedFormatting = {\r\n        get allPagesHeader() {\r\n            return settings.extraHeadersAndFooters.allPagesHeader;\r\n        },\r\n        set allPagesHeader(v) {\r\n            settings.extraHeadersAndFooters.allPagesHeader = v;\r\n        },\r\n\r\n        get allPagesFooter() {\r\n            return settings.extraHeadersAndFooters.allPagesFooter;\r\n        },\r\n        set allPagesFooter(v) {\r\n            settings.extraHeadersAndFooters.allPagesFooter = v;\r\n        },\r\n\r\n        get firstPageHeader() {\r\n            return settings.extraHeadersAndFooters.firstPageHeader;\r\n        },\r\n        set firstPageHeader(v) {\r\n            settings.extraHeadersAndFooters.firstPageHeader = v;\r\n        },\r\n\r\n        get firstPageFooter() {\r\n            return settings.extraHeadersAndFooters.firstPageFooter;\r\n        },\r\n        set firstPageFooter(v) {\r\n            settings.extraHeadersAndFooters.firstPageFooter = v;\r\n        },\r\n\r\n        get extraFirstPageFooter() {\r\n            return settings.extraHeadersAndFooters.extraFirstPageFooter;\r\n        },\r\n        set extraFirstPageFooter(v) {\r\n            settings.extraHeadersAndFooters.extraFirstPageFooter = v;\r\n        },\r\n\r\n        get allHeaderHeight() {\r\n            return settings.extraHeadersAndFooters.allHeaderHeight;\r\n        },\r\n        set allHeaderHeight(v) {\r\n            if (typeof v !== \"number\") {\r\n                throw \"Invalid argument\";\r\n            }\r\n            settings.extraHeadersAndFooters.allHeaderHeight = v;\r\n        },\r\n\r\n        get allFooterHeight() {\r\n            return settings.extraHeadersAndFooters.allFooterHeight;\r\n        },\r\n        set allFooterHeight(v) {\r\n            if (typeof v !== \"number\") {\r\n                throw \"Invalid argument\";\r\n            }\r\n            settings.extraHeadersAndFooters.allFooterHeight = v;\r\n        },\r\n\r\n        get firstHeaderHeight() {\r\n            return settings.extraHeadersAndFooters.firstHeaderHeight;\r\n        },\r\n        set firstHeaderHeight(v) {\r\n            if (typeof v !== \"number\") {\r\n                throw \"Invalid argument\";\r\n            }\r\n            settings.extraHeadersAndFooters.firstHeaderHeight = v;\r\n        },\r\n\r\n        get firstFooterHeight() {\r\n            return settings.extraHeadersAndFooters.firstFooterHeight;\r\n        },\r\n        set firstFooterHeight(v) {\r\n            if (typeof v !== \"number\") {\r\n                throw \"Invalid argument\";\r\n            }\r\n            settings.extraHeadersAndFooters.firstFooterHeight = v;\r\n        },\r\n\r\n        get extraFirstFooterHeight() {\r\n            return settings.extraHeadersAndFooters.extraFirstFooterHeight;\r\n        },\r\n        set extraFirstFooterHeight(v) {\r\n            if (typeof v !== \"number\") {\r\n                throw \"Invalid argument\";\r\n            }\r\n            settings.extraHeadersAndFooters.extraFirstFooterHeight = v;\r\n        },\r\n\r\n        get pageRange() {\r\n            return settings.pageRange;\r\n        },\r\n        set pageRange(v) {\r\n            settings.pageRange = v;\r\n            if (typeof printPdf !== \"undefined\") {\r\n                printPdf.settings.pageRange = v;\r\n            }\r\n        },\r\n\r\n        get printingPass() {\r\n            var v = \"\";\r\n            switch (settings.printingPass) {\r\n                case printHtml.PrintingPasses.DEFAULT:\r\n                case printHtml.PrintingPasses.ALL:\r\n                    v = \"all\";\r\n                    break;\r\n\r\n                case printHtml.PrintingPasses.ODD:\r\n                    v = \"odd\";\r\n                    break;\r\n\r\n                case printHtml.PrintingPasses.EVEN:\r\n                    v = \"even\";\r\n                    break;\r\n\r\n            }\r\n            return v;\r\n        },\r\n        set printingPass(v) {\r\n            var x = printHtml.PrintingPasses.ALL;\r\n            if (typeof v === \"string\") {\r\n                switch (v.toLowerCase()) {\r\n                    case \"odd\":\r\n                        x = printHtml.PrintingPasses.ODD;\r\n                        break;\r\n\r\n                    case \"even\":\r\n                        x = printHtml.PrintingPasses.EVEN;\r\n                        break;\r\n\r\n                    case \"odd&even\":\r\n                    case \"all\":\r\n                        x = printHtml.PrintingPasses.ALL;\r\n                        break;\r\n                }\r\n            }\r\n            settings.printingPass = x;\r\n        },\r\n\r\n        get pdfPrintMode() {\r\n            return typeof printPdf !== \"undefined\" ? printPdf.settings.printQuality : 0;\r\n        },\r\n        set pdfPrintMode(v) {\r\n            if (typeof printPdf !== \"undefined\") {\r\n                printPdf.settings.printQuality = v;\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n    if (typeof printApi !== \"undefined\") {\r\n        printApi.useAttributes();\r\n\r\n        if (typeof outerScope.print === \"function\") {\r\n            outerScope.factory.log(\"overwriting outerScope.print\");\r\n            outerScope.print = function () {\r\n                outerScope.factory.log(\"window.print() called and being handled.\");\r\n                promptAndPrint(\r\n                    true,\r\n                    function () {\r\n                        return printHtml.printDocument();\r\n                    },\r\n                    function () { });\r\n            };\r\n        }\r\n\r\n        // ScriptX.Addon printing intercepts Ctrl-p ...\r\n        // listen for Ctrl-P and override ...\r\n        var doNotEnable = document.querySelector(\"[data-meadco-ctrlp='false']\") != null;\r\n        if (!doNotEnable) {\r\n            outerScope.factory.log(\"using addEventListener('keydown',factory.keyPressCtrlP) for Ctrl-P\");\r\n            document.addEventListener(\"keydown\", factory.keyPressCtrlP);\r\n        }\r\n    }\r\n    else {\r\n        MeadCo.error(\"MeadCo.ScriptX.Print is not available to ScriptX.Services factory emulation.\");\r\n    }\r\n\r\n    // public API\r\n    return {\r\n        // basic properties\r\n        //\r\n\r\n        set header(str) {\r\n            outerScope.factory.log(\"set factory.printing.header: \" + str);\r\n            settings.header = str;\r\n        },\r\n\r\n        get header() {\r\n            return settings.header;\r\n        },\r\n\r\n        set footer(str) {\r\n            settings.footer = str;\r\n        },\r\n\r\n        get footer() {\r\n            return settings.footer;\r\n        },\r\n\r\n        set headerFooterFont(str) {\r\n            settings.headerFooterFont = str;\r\n        },\r\n\r\n        get headerFooterFont() {\r\n            return settings.headerFooterFont;\r\n        },\r\n\r\n        set orientation(sOrientation) {\r\n            switch (sOrientation.toLowerCase()) {\r\n                case \"landscape\":\r\n                    settings.page.orientation = printHtml.PageOrientation.LANDSCAPE;\r\n                    break;\r\n\r\n                case \"portrait\":\r\n                    settings.page.orientation = printHtml.PageOrientation.PORTRAIT;\r\n                    break;\r\n            }\r\n        },\r\n\r\n        get orientation() {\r\n            return settings.page.orientation === printHtml.PageOrientation.PORTRAIT ? \"portrait\" : \"landscape\";\r\n        },\r\n\r\n        set portrait(bPortrait) {\r\n            settings.page.orientation = bPortrait ? printHtml.PageOrientation.PORTRAIT : printHtml.PageOrientation.LANDSCAPE;\r\n        },\r\n\r\n        get portrait() {\r\n            return settings.page.orientation === printHtml.PageOrientation.PORTRAIT;\r\n        },\r\n\r\n        set leftMargin(n) {\r\n            settings.page.margins.left = n;\r\n        },\r\n\r\n        get leftMargin() {\r\n            return settings.page.margins.left;\r\n        },\r\n\r\n        set topMargin(n) {\r\n            settings.page.margins.top = n;\r\n        },\r\n\r\n        get topMargin() {\r\n            return settings.page.margins.top;\r\n        },\r\n\r\n        set bottomMargin(n) {\r\n            settings.page.margins.bottom = n;\r\n        },\r\n\r\n        get bottomMargin() {\r\n            return settings.page.margins.bottom;\r\n        },\r\n\r\n        set rightMargin(n) {\r\n            settings.page.margins.right = n;\r\n        },\r\n\r\n        get rightMargin() {\r\n            return settings.page.margins.right;\r\n        },\r\n\r\n        // templateURL is a no-op at this time. In the future may\r\n        // enable alternative server behaviour. Doing something\r\n        // is required by the minimiser or it optimises to bad code\r\n        set templateURL(sUrl) {\r\n            var x = sUrl;\r\n        },\r\n\r\n        get templateURL() {\r\n            return \"MeadCo://default\";\r\n        },\r\n\r\n        // basic functions\r\n        //\r\n\r\n        // No longer relevant, has returned true since IE 6 and was\r\n        // a proxy for testing if the browser was IE5.5 or later!\r\n        IsTemplateSupported: function () {\r\n            return true;\r\n        },\r\n\r\n        PageSetup: function (fnNotify) {\r\n            if (typeof fnNotify !== \"function\") {\r\n                MeadCo.warn(\"PageSetup API in ScriptX.Print Service is not synchronous, there is no return value.\");\r\n                fnNotify = function (bDlgOK) { MeadCo.log(\"PageSetupDlg: \" + bDlgOK); };\r\n            }\r\n\r\n            if (MeadCo.ScriptX.Print.UI) {\r\n                MeadCo.ScriptX.Print.UI.PageSetup(fnNotify);\r\n            } else {\r\n                MeadCo.error(\"PageSetup dialog in ScriptX.Services needs a dialog implementation. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs\");\r\n                fnNotify(false);\r\n            }\r\n        },\r\n\r\n        PrintSetup: function (fnNotify) {\r\n            if (typeof fnNotify !== \"function\") {\r\n                MeadCo.warn(\"PrintSetup API in ScriptX.Print Service is not synchronous, there is no return value.\");\r\n                fnNotify = function (bDlgOK) { MeadCo.log(\"PrintSetupDlg: \" + bDlgOK); }\r\n            }\r\n\r\n            if (MeadCo.ScriptX.Print.UI) {\r\n                MeadCo.ScriptX.Print.UI.PrinterSettings(fnNotify);\r\n            } else {\r\n                MeadCo.error(\"PrintSettings dialog in ScriptX.Services needs a dialog implementation. See: https://www.meadroid.com/Developers/KnowledgeBank/Articles/Dialogs\");\r\n                fnNotify(false);\r\n            }\r\n        },\r\n\r\n        Preview: function (sOrOFrame) {\r\n            if (!sOrOFrame) {\r\n                sOrOFrame = null;\r\n            }\r\n            else {\r\n                // passing in window, or window.self etc will not have an id .. don't barf on that code\r\n                if (typeof (sOrOFrame) === 'object' && !sOrOFrame.id) {\r\n                    sOrOFrame = null;\r\n                }\r\n            }\r\n\r\n            if (sOrOFrame !== null) {\r\n                var sFrame = typeof (sOrOFrame) === 'string' ? sOrOFrame : sOrOFrame.id;\r\n                return printHtml.previewFrame(sFrame);\r\n            }\r\n\r\n            printHtml.previewDocument();\r\n        },\r\n\r\n        Print: function (bPrompt, sOrOFrame, fnNotifyStarted) { // needs and wants update to ES2015 (for default values)\r\n            if (!fnNotifyStarted) {\r\n                fnNotifyStarted = function (bStarted) { MeadCo.log(\"A print has started: \" + bStarted); };\r\n            }\r\n            if (!sOrOFrame) {\r\n                sOrOFrame = null;\r\n            }\r\n            else {\r\n                // passing in window, or window.self etc will not have an id .. don't barf on that code\r\n                if (typeof (sOrOFrame) === 'object' && !sOrOFrame.id) {\r\n                    sOrOFrame = null;\r\n                }\r\n            }\r\n\r\n            return promptAndPrint(bPrompt,\r\n                function () {\r\n                    if (sOrOFrame !== null) {\r\n                        var sFrame = typeof (sOrOFrame) === 'string' ? sOrOFrame : sOrOFrame.id;\r\n                        return printHtml.printFrame(sFrame);\r\n                    }\r\n\r\n                    return printHtml.printDocument();\r\n                },\r\n                fnNotifyStarted);\r\n        },\r\n\r\n        PrintHTML: function (sUrl, bPrompt, fnNotifyStarted) {\r\n            if (typeof fnNotifyStarted === \"undefined\") {\r\n                fnNotifyStarted = function (bStarted) { };\r\n            }\r\n            return printHtmlContent(sUrl, bPrompt, fnNotifyStarted);\r\n        },\r\n\r\n        PrintHTMLEx: function (sUrl, bPrompt, fnCallback, data, fnNotifyStarted) {\r\n            if (typeof fnNotifyStarted === \"undefined\") {\r\n                fnNotifyStarted = function (bStarted) { };\r\n            }\r\n            return printHtmlContent(sUrl, bPrompt, fnNotifyStarted, fnCallback, data);\r\n        },\r\n\r\n        PrintPDF: function (options, bPrompt, bShrinkToFit, iPageFrom, iPageTo, fnNotifyStarted) {\r\n            if (typeof fnNotifyStarted === \"undefined\") {\r\n                fnNotifyStarted = function (bStarted) { };\r\n            }\r\n\r\n            if (typeof printPdf !== \"undefined\") {\r\n\r\n                printPdf.resetSettings();\r\n\r\n                if (typeof options.pagescaling !== \"undefined\") {\r\n                    printPdf.settings.pageScaling = options.pagescaling;\r\n                } else {\r\n                    printPdf.settings.pageScaling = bShrinkToFit\r\n                        ? printPdf.PdfPageScaling.SHRINKLARGEPAGES\r\n                        : printPdf.PdfPageScaling.UNDEFINED;\r\n                }\r\n\r\n                if (typeof options.autorotatecenter !== \"undefined\") {\r\n                    printPdf.settings.autoRotateCenter = options.autorotatecenter\r\n                        ? printPdf.BooleanOption.TRUE\r\n                        : printPdf.BooleanOption.FALSE;\r\n                } else\r\n                    printPdf.settings.autoRotateCenter = printPdf.BooleanOption.DEFAULT;\r\n\r\n                if (typeof options.orientation !== \"undefined\") {\r\n                    printPdf.settings.orientation = options.orientation === 1\r\n                        ? printPdf.PageOrientation.PORTRAIT\r\n                        : printPdf.PageOrientation.LANDSCAPE;\r\n                } else\r\n                    printPdf.settings.orientation = this.portrait\r\n                        ? printPdf.PageOrientation.PORTRAIT\r\n                        : printPdf.PageOrientation.LANDSCAPE;\r\n\r\n                if (typeof options.pages !== \"undefined\") {\r\n                    printPdf.settings.pageRange = options.pages;\r\n                } else {\r\n                    if (typeof iPageFrom !== \"undefined\" &&\r\n                        typeof iPageTo !== \"undefined\" &&\r\n                        iPageFrom !== -1 &&\r\n                        iPageTo !== -1) {\r\n                        printPdf.settings.pageRange = iPageFrom + \"-\" + iPageTo;\r\n                    } else {\r\n                        printPdf.settings.pageRange = \"\";\r\n                    }\r\n                }\r\n\r\n                if (typeof options.monochrome !== \"undefined\") {\r\n                    printPdf.settings.monochrome = options.monochrome\r\n                        ? printPdf.BooleanOption.TRUE\r\n                        : printPdf.BooleanOption.FALSE;\r\n                } else\r\n                    printPdf.settings.monochrome = printPdf.BooleanOption.DEFAULT;\r\n\r\n                if (typeof options.normalise !== \"undefined\" || typeof options.normalize !== \"undefined\") {\r\n                    printPdf.settings.normalise = options.normalise || options.normalize\r\n                        ? printPdf.BooleanOption.TRUE\r\n                        : printPdf.BooleanOption.FALSE;\r\n                } else\r\n                    printPdf.settings.normalise = printPdf.BooleanOption.DEFAULT;\r\n\r\n                if (typeof options.printMode !== \"undefined\") {\r\n                    printPdf.settings.printQuality = options.printMode;\r\n                } else {\r\n                    if (typeof options.printQuality !== \"undefined\") {\r\n                        printPdf.settings.printQuality = options.printQuality;\r\n                    }\r\n                }\r\n\r\n                if (typeof options.jobname !== \"undefined\") {\r\n                    printPdf.settings.jobDescription = options.jobname;\r\n                }\r\n\r\n                if (typeof options.jobName !== \"undefined\") {\r\n                    printPdf.settings.jobDescription = options.jobName;\r\n                }\r\n\r\n                return printPdfContent(options.url, bPrompt, fnNotifyStarted);\r\n            }\r\n            MeadCo.error(\"MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation.\");\r\n            fnNotifyStarted(false);\r\n            return false;\r\n        },\r\n\r\n        BatchPrintPDF: function (sUrl, fnNotifyStarted) {\r\n            this.BatchPrintPDFEx(sUrl, function () {\r\n\r\n            }, \"BatchPrintPDF\", fnNotifyStarted);\r\n        },\r\n\r\n        BatchPrintPDFEx: function (sUrl, fnCallback, data, fnNotifyStarted) {\r\n            if (typeof fnNotifyStarted === \"undefined\") {\r\n                fnNotifyStarted = function (bStarted) { };\r\n            }\r\n\r\n            if (typeof printPdf !== \"undefined\") {\r\n                printPdf.resetSettings();\r\n\r\n                printPdf.settings.pageRange = iEnhancedFormatting.pageRange;\r\n                printPdf.settings.pageScaling = settings.viewScale === -1\r\n                    ? printPdf.PdfPageScaling.SHRINKLARGEPAGES\r\n                    : printPdf.PdfPageScaling.UNDEFINED;\r\n                printPdf.settings.orientation = this.portrait\r\n                    ? printPdf.PageOrientation.PORTRAIT\r\n                    : printPdf.PageOrientation.LANDSCAPE;\r\n                printPdf.settings.printQuality = iEnhancedFormatting.pdfPrintMode;\r\n\r\n                printPdfContent(sUrl, false, fnNotifyStarted, fnCallback, data);\r\n                return;\r\n            }\r\n\r\n            MeadCo.error(\"MeadCo.ScriptX.Print.PDF is not available to ScriptX.Services factory emulation.\");\r\n            fnNotifyStarted(false);\r\n        },\r\n\r\n        set units(enumUnits) {\r\n            this.SetMarginMeasure(enumUnits);\r\n        },\r\n\r\n        get units() {\r\n            return this.GetMarginMeasure();\r\n        },\r\n\r\n        set paperSize(sPaperSize) {\r\n            printApi.deviceSettings.paperSizeName = sPaperSize;\r\n        },\r\n\r\n        get paperSize() {\r\n            return printApi.deviceSettings.paperSizeName;\r\n        },\r\n\r\n        set paperSource(sPaperSource) {\r\n            printApi.deviceSettings.paperSourceName = sPaperSource;\r\n        },\r\n\r\n        get paperSource() {\r\n            return printApi.deviceSettings.paperSourceName;\r\n        },\r\n\r\n        set paperSource2(sPaperSource) {\r\n            printApi.deviceSettings.paperSourceName = sPaperSource;\r\n        },\r\n\r\n        get paperSource2() {\r\n            return printApi.deviceSettings.paperSourceName;\r\n        },\r\n\r\n        get pageWidth() {\r\n            return printApi.deviceSettings.paperPageSize.width;\r\n        },\r\n\r\n        get pageHeight() {\r\n            return printApi.deviceSettings.paperPageSize.height;\r\n        },\r\n\r\n        set copies(nCopies) {\r\n            printApi.deviceSettings.copies = nCopies;\r\n        },\r\n\r\n        get copies() {\r\n            return printApi.deviceSettings.copies;\r\n        },\r\n\r\n        set collate(bCollate) {\r\n            printApi.deviceSettings.collate = (bCollate === true || bCollate === 1) ? printApi.CollateOptions.TRUE : printApi.CollateOptions.FALSE;\r\n        },\r\n\r\n        get collate() {\r\n            return printApi.deviceSettings.collate === printApi.CollateOptions.TRUE;\r\n        },\r\n\r\n        set duplex(duplex) {\r\n            printApi.deviceSettings.duplex = duplex;\r\n        },\r\n\r\n        get duplex() {\r\n            return printApi.deviceSettings.duplex;\r\n        },\r\n\r\n        set duplex2(duplex) {\r\n            printApi.deviceSettings.duplex = duplex;\r\n        },\r\n\r\n        get duplex2() {\r\n            return printApi.deviceSettings.duplex;\r\n        },\r\n\r\n        set onafterprint(fn) {\r\n            printApi.reportFeatureNotImplemented(\"onafterprint\", fn);\r\n        },\r\n        set onbeforeprint(fn) {\r\n            printApi.reportFeatureNotImplemented(\"onbeforeprint\", fn);\r\n        },\r\n\r\n        set onbeforeunload(sMsg) {\r\n            unloadMsg = sMsg;\r\n            window.addEventListener('beforeunload', async (e) => {\r\n                MeadCo.log(\"beforeunload handler running\");\r\n                if (!MeadCo.ScriptX.Print.noJobsWaitingDelivery) {\r\n                    MeadCo.log(\"jobs are waiting client side, will prompt user (custom text is not supported by modern browsers)\");\r\n                    e.returnValue = sMsg;\r\n                    e.preventDefault();\r\n                }\r\n                else {\r\n                    MeadCo.log(\"no jobs are waiting client side\");\r\n                }\r\n            });\r\n        },\r\n\r\n        get onbeforeunload() {\r\n            return unloadMsg;\r\n        },\r\n\r\n        set onpagesetup(fn) {\r\n            printApi.reportFeatureNotImplemented(\"onpagesetup\", fn);\r\n        },\r\n\r\n        set onuserpagesetup(fn) {\r\n            printApi.reportFeatureNotImplemented(\"onuserpagesetup\", fn);\r\n        },\r\n\r\n        set onuserprint(fn) {\r\n            printApi.reportFeatureNotImplemented(\"onuserprint\", fn);\r\n        },\r\n\r\n        set onuserprintpreview(fn) {\r\n            printApi.reportFeatureNotImplemented(\"onuserprintpreview\", fn);\r\n        },\r\n\r\n        DefaultPrinter: function () {\r\n            return printApi.deviceSettingsFor(\"systemdefault\").printerName;\r\n        },\r\n\r\n        AddPrinterConnection: function (sShareName) {\r\n            printApi.addPrinterConnection(sShareName);\r\n        },\r\n\r\n        RemovePrinterConnection: function (sShareName) {\r\n            printApi.removePrinterConnection(sShareName);\r\n        },\r\n\r\n        AddPrinterConnectionAsync: function (sShareName, onSuccess) {\r\n            printApi.addPrinterConnectionAsync(sShareName, onSuccess, function (errTxt) {\r\n                printApi.reportError(errTxt);\r\n            });\r\n        },\r\n\r\n        RemovePrinterConnectionAsync: function (sShareName, onSuccess) {\r\n            printApi.removePrinterConnectionAsync(sShareName, onSuccess, function (errTxt) {\r\n                printApi.reportError(errTxt);\r\n            });\r\n        },\r\n\r\n        // duplicate to cope with COM objects were/are not case sensitive\r\n        get CurrentPrinter() {\r\n            return printApi.printerName;\r\n        },\r\n\r\n        set CurrentPrinter(sPrinterName) {\r\n            this.currentPrinter = sPrinterName;\r\n        },\r\n\r\n        get currentPrinter() {\r\n            return printApi.printerName;\r\n        },\r\n\r\n        set currentPrinter(sPrinterName) {\r\n            if (typeof sPrinterName === \"string\") {\r\n                var a = printApi.onErrorAction;\r\n\r\n                printApi.onErrorAction = printApi.ErrorAction.THROW;\r\n\r\n                try {\r\n                    printApi.printerName = sPrinterName;\r\n                    printApi.onErrorAction = a;\r\n                } catch (e) {\r\n                    printApi.onErrorAction = a;\r\n                    throw e;\r\n                }\r\n            }\r\n        },\r\n\r\n        get printer() {\r\n            return printApi.printerName;\r\n        },\r\n\r\n        set printer(sPrinterName) {\r\n            if (typeof sPrinterName === \"string\") {\r\n\r\n                var a = printApi.onErrorAction;\r\n\r\n                printApi.onErrorAction = printApi.ErrorAction.THROW;\r\n\r\n                // eat all and any errors. finally might be better but\r\n                // minifiers dont like empty blocks \r\n                try {\r\n                    printApi.printerName = sPrinterName;\r\n                    printApi.onErrorAction = a;\r\n                }\r\n                catch (e) {\r\n                    printApi.onErrorAction = a;\r\n                }\r\n            }\r\n        },\r\n\r\n        set printToFileName(sFileName) {\r\n            printApi.deviceSettings.printToFileName = sFileName;\r\n        },\r\n\r\n        get printBackground() {\r\n            return settings.printBackgroundColorsAndImages;\r\n        },\r\n\r\n        set printBackground(bPrintBackground) {\r\n            settings.printBackgroundColorsAndImages = bPrintBackground;\r\n        },\r\n\r\n        get viewScale() {\r\n            return settings.viewScale;\r\n        },\r\n\r\n        set viewScale(x) {\r\n            settings.viewScale = x;\r\n        },\r\n\r\n        set unprintableLeft(n) {\r\n            printApi.deviceSettings.unprintableMargins.left = n;\r\n        },\r\n\r\n        get unprintableLeft() {\r\n            return printApi.deviceSettings.unprintableMargins.left;\r\n        },\r\n\r\n        set unprintableRight(n) {\r\n            printApi.deviceSettings.unprintableMargins.right = n;\r\n        },\r\n\r\n        get unprintableRight() {\r\n            return printApi.deviceSettings.unprintableMargins.right;\r\n        },\r\n\r\n        set unprintableTop(n) {\r\n            printApi.deviceSettings.unprintableMargins.top = n;\r\n        },\r\n\r\n        get unprintableTop() {\r\n            return printApi.deviceSettings.unprintableMargins.top;\r\n        },\r\n\r\n        set unprintableBottom(n) {\r\n            printApi.deviceSettings.unprintableMargins.bottom = n;\r\n        },\r\n\r\n        get unprintableBottom() {\r\n            return printApi.deviceSettings.unprintableMargins.bottom;\r\n        },\r\n\r\n        EnumPrinters: function (index) {\r\n            var arP = printApi.availablePrinterNames;\r\n\r\n            if (!arP || arP.length === 0) {\r\n                if (index === 0) {\r\n                    return this.CurrentPrinter;\r\n                }\r\n            } else {\r\n                if (index < arP.length) {\r\n                    return arP[index];\r\n                }\r\n            }\r\n\r\n            return \"\";\r\n        },\r\n\r\n        EnumJobs: function (sPrinterName, iIndex, jobNameOut) {\r\n\r\n            var jobs = printApi.queue;\r\n            var i;\r\n            var plist = new Array();\r\n\r\n            sPrinterName = sPrinterName.toLowerCase();\r\n            for (i = 0; i < jobs.length; i++) {\r\n                if (jobs[i].printerName.toLowerCase() === sPrinterName) {\r\n                    plist.push(jobs[i]);\r\n                }\r\n            }\r\n\r\n            if (iIndex < plist.length) {\r\n                jobNameOut.name = plist[iIndex].jobName;\r\n                return plist[iIndex].status;\r\n            }\r\n\r\n            return 0;\r\n        },\r\n\r\n        GetJobsCount: function (sPrinterName) {\r\n            // return printApi.activeJobs;\r\n            var jobs = printApi.queue;\r\n            var i;\r\n            var c = 0;\r\n\r\n            sPrinterName = sPrinterName.toLowerCase();\r\n            for (i = 0; i < jobs.length; i++) {\r\n                if (jobs[i].printerName.toLowerCase() === sPrinterName)\r\n                    c++;\r\n            }\r\n\r\n            return c;\r\n        },\r\n\r\n        printerControl: function (printerName) {\r\n            return {\r\n                get Forms() {\r\n                    return printApi.deviceSettingsFor(printerName).forms;\r\n                },\r\n\r\n                get Bins() {\r\n                    return printApi.deviceSettingsFor(printerName).bins;\r\n                },\r\n\r\n                get forms() {\r\n                    return printApi.deviceSettingsFor(printerName).forms;\r\n                },\r\n\r\n                get bins() {\r\n                    return printApi.deviceSettingsFor(printerName).bins;\r\n                },\r\n\r\n                get name() {\r\n                    return printerName;\r\n                },\r\n\r\n                get status() {\r\n                    return printApi.deviceSettingsFor(printerName).port;\r\n                },\r\n\r\n                get port() {\r\n                    return printApi.deviceSettingsFor(printerName).port;\r\n                },\r\n                get attributes() {\r\n                    return printApi.deviceSettingsFor(printerName).attributes;\r\n                },\r\n                get serverName() {\r\n                    return printApi.deviceSettingsFor(printerName).serverName;\r\n                },\r\n                get shareName() {\r\n                    return printApi.deviceSettingsFor(printerName).shareName;\r\n                },\r\n                get location() {\r\n                    return printApi.deviceSettingsFor(printerName).location;\r\n                },\r\n                get isLocal() {\r\n                    return printApi.deviceSettingsFor(printerName).isLocal;\r\n                },\r\n                get isNetwork() {\r\n                    return printApi.deviceSettingsFor(printerName).isNetwork;\r\n                },\r\n                get isShared() {\r\n                    return printApi.deviceSettingsFor(printerName).isShared;\r\n                },\r\n\r\n                get Jobs() {\r\n                    printApi.reportFeatureNotImplemented(\"printerControl.Jobs\");\r\n                },\r\n                Purge: function () {\r\n                    printApi.reportFeatureNotImplemented(\"printerControl.Purge()\");\r\n                },\r\n                Pause: function () {\r\n                    printApi.reportFeatureNotImplemented(\"printerControl.Pause()\");\r\n                },\r\n                Resume: function () {\r\n                    printApi.reportFeatureNotImplemented(\"printerControl.Resume()\");\r\n                }\r\n            };\r\n        },\r\n\r\n        GetMarginMeasure: function () {\r\n            return settings.page.units === printApi.MeasurementUnits.INCHES ? 2 : 1;\r\n        },\r\n\r\n        SetMarginMeasure: function (enumUnits) {\r\n            settings.page.units = enumUnits === 2 ? printApi.MeasurementUnits.INCHES : printApi.MeasurementUnits.MM;\r\n        },\r\n\r\n        SetPrintScale: function (value) {\r\n            settings.viewScale = value;\r\n        },\r\n\r\n        IsSpooling: function () {\r\n            return printApi.isSpooling;\r\n        },\r\n\r\n        OwnQueue: function () {\r\n            // NOTE: No-op, no concept of 'out of process' here\r\n            return null;\r\n        },\r\n\r\n        SetPageRange: function (bSelectionOnly, iFrom, iTo) {\r\n            if (bSelectionOnly) {\r\n                printApi.reportFeatureNotImplemented(\"SetPageRange selection only\");\r\n            }\r\n\r\n            settings.pageRange = \"\" + iFrom + \"-\" + iTo;\r\n        },\r\n\r\n        SetPreviewZoom: function () {\r\n            printApi.reportFeatureNotImplemented(\"SetPreviewZoom\");\r\n        },\r\n\r\n        Sleep: function () {\r\n            // If you need this, please implement your own for the browsers you are deploying to. \r\n            // Contact MeadCo for assistance if required.\r\n            printApi.reportFeatureNotImplemented(\"Sleep\");\r\n        },\r\n\r\n        TotalPrintPages: function () {\r\n            printApi.reportFeatureNotImplemented(\"TotalPrintPages\");\r\n        },\r\n\r\n        WaitForSpoolingComplete: function (iTimeout, fnComplete) {\r\n            printApi.waitForSpoolingComplete(iTimeout, fnComplete);\r\n        },\r\n\r\n        enhancedFormatting: iEnhancedFormatting,\r\n\r\n        // helpers for wrapper MeadCoJS\r\n        PolyfillInit: function () {\r\n            if (!MeadCo.ScriptX.Print.isConnected) {\r\n                printHtml.connect(\"\", \"\", function (e) {\r\n                    MeadCo.warn(\"Services server connection failed: \" + e);\r\n                });\r\n            }\r\n            return MeadCo.ScriptX.Print.isConnected;\r\n        },\r\n\r\n        PolyfillInitAsync: function (resolve, reject) {\r\n            if (MeadCo.ScriptX.Print.isConnected) {\r\n                resolve(2);\r\n            } else {\r\n                printHtml.connectAsync(\"\", \"\", resolve, reject);\r\n            }\r\n        },\r\n\r\n        get PolyfillAuthorisationCookie() {\r\n            return MeadCo.ScriptX.Print.authorisationCookie;\r\n        },\r\n\r\n        set PolyfillAuthorisationCookie(cookie) {\r\n            MeadCo.ScriptX.Print.authorisationCookie = cookie;\r\n        }\r\n    };\r\n\r\n});\r\n\r\n; (function (name, definition) {\r\n    if (typeof factory.extendFactoryNamespace === \"function\") {\r\n        factory.extendFactoryNamespace(name, definition);\r\n    }\r\n})('factory.object', function () {\r\n\r\n    // protected API\r\n    var outerScope = this;\r\n\r\n    outerScope.factory.log(\"factory.object loaded.\");\r\n\r\n    /*\r\n     * This completes the emulation of an &lt;object /&gt; element\r\n     *\r\n     * Compatibility with Add-on to allow inspection of  &lt;object /&gt; and this javascript\r\n     * for the underlying object implementing 'factory'.\r\n     * \r\n     * @property {object} factory\r\n     * @memberof factoryobject\r\n     */\r\n    return outerScope.factory;\r\n});\r\n\r\n; (function (name, definition) {\r\n    if (typeof factory.extendFactoryNamespace === \"function\") {\r\n        factory.extendFactoryNamespace(name, definition);\r\n    }\r\n})('factory.object.js', function () {\r\n\r\n    // protected API\r\n    var outerScope = this;\r\n\r\n    outerScope.factory.log(\"factory.object.js loaded.\");\r\n\r\n    // public API\r\n    return {\r\n        /*\r\n         * Convert object to number -- required for some code compatibility only. Do not use\r\n         * \r\n         * @function FormatNumber\r\n         * @memberof factoryjs\r\n         * @param {any} arg object to convert\r\n         * @returns {Number} arg as a number if it can be converted, else 0 \r\n         */\r\n        FormatNumber: function (arg) {\r\n            if (isNaN(arg)) {\r\n                return 0;\r\n            } else {\r\n                if (typeof arg === 'string') {\r\n                    return Number(arg);\r\n                } else {\r\n                    return arg;\r\n                }\r\n            }\r\n        }\r\n    };\r\n});\r\n"]}