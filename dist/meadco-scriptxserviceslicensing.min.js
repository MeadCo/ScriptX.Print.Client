!function(e,r){var n=function(){var d=this,e="1.10.1.0",r="undefined"!=typeof MeadCo&&void 0!==MeadCo.logEnable&&MeadCo.logEnable,g=function(e){r&&console.log("MeadCo :: "+e)},i=function(e){console.error("MeadCo :: "+e)};return d.extendMeadCoNamespace=function(e,r){var n=r();g("MeadCo root extending namespace: "+e);for(var o=e.split("."),t=d.scope||this.jQuery||this.ender||this.$||this,s=0;s<o.length;s++){var a=o[s];if(s===o.length-1)if(void 0===t[a])g("installing implementation at: "+a),t[a]=n;else{g("Warning - extending package: "+a);var i=t[a];t[a]=n;var p=t[a];for(var l in g("preserving old scope ... "),i)i.hasOwnProperty(l)&&(g("will preserve: "+l),p[l]=i[l])}else void 0===t[a]?(g("initialising new: "+a),t[a]={}):g("using existing package: "+a);t=t[a]}},g("MeadCo root namespace "+e+" loaded."),{log:g,warn:function(e){console.warn("MeadCo :: "+e)},error:i,get version(){return e},get logEnabled(){return r},set logEnabled(e){r=e},createNS:function(e){var r=e.split("."),n=d.scope.MeadCo;"MeadCo"===r[0]&&(r=r.slice(1));for(var o=0;o<r.length;o++){var t=r[o];void 0===n[t]&&(n[t]={}),n=n[t]}return n},set scope(e){d.scope=e},makeApiEndPoint:function(e,r){var n=e.indexOf("/api");return-1===n?(e.lastIndexOf("/")!==e.length-1&&(e+="/"),e+="api/"+r):e=e.substr(0,n)+"/api/"+r,e},parseAjaxError:function(e,r,n,o){return i("**warning: AJAX call failure in "+e+": ["+(s=n)+"], ["+(a=o)+"], ["+(t=r).responseText+"], ["+t.statusText+"]"),""===a||"Internal Server Error"===a?a="error"!==s?t.responseText||s:"object"==typeof t.responseJSON&&"string"==typeof t.responseJSON.Message?t.responseJSON.Message:"string"==typeof t.responseText?t.responseText:"Server or network error":"object"!=typeof t.responseJSON&&"string"==typeof t.responseText&&0<t.responseText.length&&(a=t.responseText),i(" error parsed to --\x3e ["+a+"]"),a;var t,s,a}}}(),o=this,t=null;if(void 0!==o[e]&&(t=o[e]),o[e]=n,null!==t){var s=o[e];for(var a in t)t.hasOwnProperty(a)&&(s[a]=t[a])}n.scope=o}("MeadCo");
extendMeadCoNamespace("MeadCo.ScriptX.Print",function(){var e="1.10.1.6",u="v1/printHtml",l="v1/printPdf",o="v1/printDirect",d="",f={cookie:""},p={},v=this,s=[],g={serviceUrl:"",pendingUrl:"",failedUrl:"",orchestratorPort:0,portsToTry:10,verifying:!1,get url(){if(""===this.serviceUrl&&""!==this.pendingUrl){MeadCo.warn("[GET] servicesServer.url is not ready, performing synchronous search. Recommend code re-org to resolve the server earlier and asynchronously.");var e=this;this.verifyUrl(this.pendingUrl,!1,function(){return e.serviceUrl},function(){return""})}return this.serviceUrl},set url(e){MeadCo.log("servicesServer::setUrl: "+e),this.IsChangingServer(e)&&(MeadCo.log("note set as pending"),this.serviceUrl="",this.pendingUrl=e)},urlAsync:function(e,r,t){MeadCo.log("servicesServer::urlAsync: "+e),this.verifyUrl(e,!0,r,t)},verifyUrl:function(e,o,n,i){if(this.verifying&&o){console.warn("Verify called and verify in progress ....");var a=this,c=e;window.setTimeout(function(){a.verifyUrl(c,o,n,i)},1e3)}else if(this.IsChangingServer(e)&&!this.IsFailedConnection(e)){var a=this,c=e;MeadCo.log("servicesServer::verifyurl: "+e+", async: "+o),"number"!=typeof this.orchestratorPort&&(this.orchestratorPort=parseInt(""+this.orchestratorPort)),0<this.orchestratorPort?(MeadCo.log("Using request to Orchestrator on port: "+this.orchestratorPort),a.verifying=!0,v.jQuery.ajax("http://127.0.0.1:"+this.orchestratorPort+"/api/v1",{method:"GET",dataType:"json",cache:!1,async:o}).done(function(e){MeadCo.log("orchestrator returned ScriptX.Services port: "+e.HttpPort);var r=new URL(c);r.port=e.HttpPort,c=r.protocol+"//"+r.host+r.pathname,a.test(c,0,o,function(e){a.serviceUrl=e,a.pendingUrl="",a.verifying=!1,n(e)},function(e){a.serviceUrl="",a.pendingUrl="",a.failedUrl=c,a.verifying=!1,"function"==typeof i&&i(e)})}).fail(function(e,r,t){a.verifying=!1,MeadCo.warn(MeadCo.parseAjaxError("Failed to connect with orchestrator: ",e,r,t)),MeadCo.log("Will try unorchestrated url"),a.orchestratorPort=0,a.verifyUrl(c,o,n,i)})):(a.verifying=!0,a.test(c,a.portsToTry,o,function(e){a.serviceUrl=e,a.pendingUrl="",a.verifying=!1,n(e)},function(e){a.serviceUrl="",a.pendingUrl="",a.verifying=!1,a.failedUrl=c,"function"==typeof i&&i("ScriptX.Services could not be found at "+c)}))}else n(this.serviceUrl)},test:function(e,o,n,i,a){if(0<e.length)if(v.jQuery){var c=this,s=new URL(e);MeadCo.log("Test server requested: "+e+", port: "+s.port);var r=MeadCo.makeApiEndPoint(s.href,"v1/licensing/ping");MeadCo.log(".ajax() get: "+r),v.jQuery.ajax(r,{method:"GET",dataType:"json",cache:!1,async:n}).done(function(e){i(s.protocol+"//"+s.host+s.pathname)}).fail(function(e,r,t){0<o&&("localhost"===s.hostname||"127.0.0.1"==s.hostname)?(s.port++,v.setTimeout(c.test(s.protocol+"//"+s.host+s.pathname,--o,n,i,a),1)):(t=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.servicesServer.test:",e,r,t),"function"==typeof a&&a(t))})}else MeadCo.error("jQuery is required by ScriptX.Services")},call:function(o,n,e,r,t,i,a){if(""===this.serviceUrl&&""!==this.pendingUrl){var c=this;this.verifyUrl(this.pendingUrl,t,function(){""!==c.url?c.call(o,n,e,r,t,i,a):"function"==typeof a&&a("Server url verification failed to set url")},a)}else if(v.jQuery)if(""!==this.serviceUrl){var s=MeadCo.makeApiEndPoint(this.serviceUrl,o);MeadCo.log("servicesServer.call() "+n+": "+s);var l={method:n,cache:!1,async:t,jsonp:!1,dataType:"json",contentType:"application/json"};r&&(l.headers={Authorization:"Basic "+btoa(h+":")}),"object"==typeof e&&null!==e&&(MeadCo.log("payload defined."),l.data=JSON.stringify(e)),v.jQuery.ajax(s,l).done(function(e){return"function"==typeof i&&i(e),e}).fail(function(e,r,t){t=MeadCo.parseAjaxError("MeadCo.ScriptX.Print:"+o+n,e,r,t),"function"==typeof a&&a(t)})}else{if("function"!=typeof a)throw new Error("MeadCo.ScriptX.Print : server connection is not defined.");a("MeadCo.ScriptX.Print : server connection is not defined.")}else{if("function"!=typeof a)throw new Error("MeadCo.ScriptX.Print : no known ajax helper available");a("MeadCo.ScriptX.Print : no known ajax helper available")}},IsChangingServer:function(r){if(""!==this.serviceUrl)try{var e=new URL(this.serviceUrl),t=new URL(r);return e.hostname!=t.hostname}catch(e){return console.error("Failed to construct URL(): "+e.message+", from: "+this.serviceUrl+", or: "+r),console.error("Many errors will ensue"),!1}return!0},IsFailedConnection:function(r){if(0<this.failedUrl.length)try{var e=new URL(this.failedUrl),t=new URL(r);return e.hostname===t.hostname&&(console.warn("Attempt to use: "+r+" is noted as a failed connection and will not be retried"),!0)}catch(e){return console.error("Testing IsFailed unable to construct URL(): "+e.message+", from: "+this.failedUrl+", or: "+r),!0}return!1}},h="",n=!1,m=!1,i=[],a=null,C={URL:1,HTML:2,INNERHTML:4,STRING:8},t={UNKNOWN:0,QUEUEDTODEVICE:1,QUEUEDTOFILE:2,SOFTERROR:3,OK:4},r={REPORT:1,THROW:2},c=r.REPORT,y={NOTSTARTED:0,QUEUED:1,STARTING:2,DOWNLOADING:3,DOWNLOADED:4,PRINTING:5,COMPLETED:6,PAUSED:7,PRINTPDF:8,ERROR:-1,ABANDONED:-2};function S(e){s.push(e),MeadCo.log("ScriptX.Print queueJob: "+e.jobName+", jobCount: "+s.length)}function M(){return MeadCo.log("ScriptX.Print jobCount: "+s.length),s.length}function E(e){var r;for(r=0;r<s.length;r++)if(s[r].jobIdentifier===e)return MeadCo.log("ScriptX.Print removing job: "+s[r].jobName),s.splice(r,1),MeadCo.log("ScriptX.Print remove job, jobCount: "+s.length),void(0==s.length&&(j=0));console.warn("Unable to find job: "+e+" to remove it")}function P(e,r,t){"function"==typeof e.OnProgress&&e.OnProgress(r,t,e.UserData)}var b=0,j=0,w=750,T=1e4;function U(e,r,t,o){"string"==typeof e&&0<e.length?(MeadCo.log("Print server requested: "+e+" with license: "+r),h="string"==typeof r&&0<r.length?r:h,d="",p={},n=!(s=[]),i=[],"function"==typeof t?g.urlAsync(e,t,o):g.url=e):(MeadCo.log("Print server retained: "+g.url+" update with license: "+r),h="string"==typeof r&&0<r.length?r:h)}function D(e,r,o){if(g.url.length<=0)throw new Error("MeadCo.ScriptX.Print : print server URL is not set or is invalid");var n={jobIdentifier:Date.now(),printerName:r.Device.printerName,jobName:"Job starting"};if(v.jQuery)return MeadCo.log(".ajax() post to: "+e),S(n),v.jQuery.ajax(e+"/print",{data:JSON.stringify(r),dataType:"json",contentType:"application/json",method:"POST",headers:{Authorization:"Basic "+btoa(h+":")}}).done(function(e){switch(MeadCo.log("Success response: "+e.status),e.printerName=r.Device.printerName,e.jobName=r.Settings.jobTitle,S(e),E(n.jobIdentifier),e.status){case t.QUEUEDTOFILE:o.queuedToFile(e);break;case t.QUEUEDTODEVICE:o.queuedToDevice(e);break;case t.SOFTERROR:case t.UNKNOWN:o.softError(e);break;case t.OK:o.ok(e)}}).fail(function(e,r,t){E(n.jobIdentifier),"function"==typeof o.fail&&o.fail(e,r,t)}),!0;if("function"!=typeof o.fail)throw new Error("MeadCo.ScriptX.Print : no known ajax helper available");o.fail("MeadCo.ScriptX.Print : no known ajax helper available")}function R(e,r,t,o){return N(e,"GET",null,!0,r,t,o)}function N(e,r,t,o,n,i,a){return g.call(e,r,t,o,n,i,a)}function O(e,o,n,r,i){MeadCo.log("monitorJob: "+n);var t=0,a=!1,c=window.setInterval(function(){a?MeadCo.log("** info : still waiting for last status request to complete"):(MeadCo.log("Going to request status with .ajax"),a=!0,jQuery.ajax(e+"/status/"+n,{dataType:"json",method:"GET",cache:!1,headers:{Authorization:"Basic "+btoa(h+":")}}).done(function(e){switch(MeadCo.log("jobStatus: "+e.status),e.status){case y.COMPLETED:MeadCo.log("clear interval: "+c),window.clearInterval(c),E(n),i(e);break;case y.NOTSTARTED:case y.DOWNLOADED:case y.DOWNLOADING:case y.PRINTING:case y.QUEUED:case y.STARTING:case y.PAUSED:case y.PRINTPDF:P(o,e.status,e.message),function(r){var t;for(t=0;t<s.length;t++)if(s[t].jobIdentifier===r.jobIdentifier)return Object.keys(r).forEach(function(e){s[t][e]=r[e]});console.warn("Unable to find job: "+r.jobIdentifier+" to update it")}(e),0<r&&1e3*++t>r&&(window.clearInterval(c),MeadCo.ScriptX.Print.reportError("unknown failure while printing.")),a=!1;break;case y.ERROR:case y.ABANDONED:MeadCo.log("error status in monitorJob so clear interval: "+c),P(o,e.status,e.message),E(n),window.clearInterval(c),MeadCo.ScriptX.Print.reportError("The print failed with the error: "+e.message),i(null);break;default:P(o,e.status,e.message),MeadCo.log("unknown status in monitorJob so clear interval: "+c),E(n),window.clearInterval(c),i(null)}}).fail(function(e,r,t){t=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.monitorJob:",e,r,t),MeadCo.log("error: "+t+" in monitorJob so clear interval: "+c),P(o,y.ERROR,t),E(n),window.clearInterval(c),i(null)}))},1e3);MeadCo.log("intervalId: "+c)}function I(e){if("string"==typeof e.printerName){if(e.isDefault)for(var r=0;r<p.length;r++)p[r].isDefault=!1;(p[e.printerName]=e).isDefault&&0===d.length&&(d=e.printerName)}}function A(r){r.name=r.name.replace(/\\/g,"||"),MeadCo.log("Request get device info: "+r.name),R(u+"/deviceinfo/"+encodeURIComponent(r.name)+"/0",r.async,function(e){n=!0,I(e),"function"==typeof r.done&&r.done(e)},function(e){"systemdefault"===r.name?(console.warn("request for systemdefault printer failed - please update to ScriptX.Services 2.11.1"),r.name="default",r.async=!1,A(r)):(MeadCo.log("failed to getdevice: "+e),"function"==typeof r.fail&&r.fail(e))})}return v.jQuery||MeadCo.log("**** warning :: no jQuery *******"),MeadCo.log("MeadCo.ScriptX.Print "+e+" loaded."),{ContentType:C,PrintStatus:y,ErrorAction:r,CollateOptions:{DEFAULT:0,TRUE:1,FALSE:2},DuplexOptions:{DEFAULT:0,SIMPLEX:1,VERTICAL:2,HORIZONTAL:3},MeasurementUnits:{DEFAULT:0,INCHES:1,MM:2},ServiceClasses:{CLOUD:1,ONPREMISE:2,WINDOWSPC:3},get onErrorAction(){return c},set onErrorAction(e){c=e},get orchestrator(){return g.orchestratorPort},set orchestrator(e){g.orchestratorPort=e},get authorisationCookie(){return f.cookie},set authorisationCookie(e){f.cookie=e},get printerName(){return d},set printerName(e){e!==d&&e.name!==d&&("string"==typeof e?void 0===p[e]?A({name:e,done:function(e){d=e.printerName},async:!1,fail:function(e){MeadCo.ScriptX.Print.reportError(e)}}):d=e:A(e))},get version(){return e},serviceVersion:function(){return this.cachedServiceDescription.ServiceVersion},serviceVersionAsync:function(r,e){this.serviceDescriptionAsync(function(e){r(e.serviceVersion)},e)},get deviceSettings(){return""!==d?p[d]:{}},set deviceSettings(e){I(e)},deviceSettingsFor:function(e){return"string"!=typeof(r=e)||""===r?{}:(void 0===p[r]&&A({name:r,async:!1,done:function(e){"systemdefault"===r.toLowerCase()&&(r=e.printerName)},fail:function(e){MeadCo.ScriptX.Print.reportError(e)}}),p[r]);var r},useAttributes:function(){!function(){if(MeadCo.log("MeadCo.ScriptX.Print ... looking for auto connect, already found?: "+m),this.jQuery&&!m){var i=MeadCo.ScriptX.Print.HTML,a=MeadCo.ScriptX.Print,c=MeadCo.ScriptX.Print.Licensing;jQuery("[data-meadco-subscription]").each(function(){if(void 0===a||void 0===i)console.warn("Unable to auto-connect subscription - print or printHtml API not present (yet?)");else if(!m){var e=jQuery(this),r=e.data();MeadCo.log("Auto connect susbcription to: "+r.meadcoServer+", or "+r.meadcoPrinthtmlserver+", with subscription: "+r.meadcoSubscription+", sync: "+r.meadcoSyncinit);var t="false"!==(""+r.meadcoSyncinit).toLowerCase(),o=r.meadcoServer;void 0===o&&(o=r.meadcoPrinthtmlserver),void 0===o?console.error("No server specified"):(void 0!==c&&c.connect(o,r.meadcoSubscription),t?(console.warn("Synchronous connection is deprecated, please use data-meadco-syncinit='false'"),i.connect(o,r.meadcoSubscription)):(MeadCo.log("Async connectlite..."),a.connectLite(o,r.meadcoSubscription)),m=!0)}return!1}),jQuery("[data-meadco-license]").each(function(){if(void 0===a||void 0===i||void 0===c)console.warn("Unable to auto-connect client license - print or printHtml or license API not present (yet?)");else if(!m){var e=jQuery(this),r=e.data();MeadCo.log("Auto connect client license to: "+r.meadcoServer+", with license: "+r.meadcoLicense+", path: "+r.meadcoLicensePath+", revision: "+r.meadcoLicenseRevision+", sync: "+r.meadcoSyncinit+", orchestrator: "+r.meadcoOrchestrator);var t="false"!==(""+r.meadcoSyncinit).toLowerCase(),o="false"!==(""+r.meadcoReporterror).toLowerCase(),n=r.meadcoServer;g.orchestratorPort=r.meadcoOrchestrator,t?(console.warn("Synchronous connection is deprecated, please use data-meadco-syncinit='false'"),c.connect(n,r.meadcoLicense),void 0!==r.meadcoLicensePath&&void 0!==r.meadcoLicenseRevision&&(c.apply(r.meadcoLicense,r.meadcoLicenseRevision,r.meadcoLicensePath),0!=c.result&&o&&MeadCo.ScriptX.Print.reportError(c.errorMessage)),i.connect(n,r.meadcoLicense)):(MeadCo.log("Async connectlite..."),c.connectLite(n,r.meadcoLicense,r.meadcoLicenseRevision,r.meadcoLicensePath),a.connectLite(n,r.meadcoLicense)),m=!0}return!1})}}()},connect:function(e,r){U(e,r),A({name:"systemdefault",async:!1}),R("",!0,function(e){a=e})},connectLite:function(e,r){U(e,r)},connectAsync:function(e,r,t,o){var n,i;n=t,U(e,r,function(e){A({name:"systemdefault",done:n,async:!0,fail:i}),R("",!0,function(e){a=e})},i=o)},connectTestAsync:function(e,r,t){g.verifyUrl(e,!0,r,t)},serviceDescription:function(){return a||R("",!1,function(e){a=e},function(e){MeadCo.ScriptX.Print.reportError(e.message)}),a},serviceDescriptionAsync:function(r,e){a?r(a):R("",!0,function(e){r(a=e)},e)},connectDeviceAndPrinters:function(e,r){n=!0,I(e),i=r},get isConnected(){return n},get availablePrinterNames(){return i},getFromServer:function(e,r,t,o){R(u+e,r,t,o)},printHtml:function(e,r,t,o,n,i){if(!r||"string"==typeof r&&0===r.length)return MeadCo.ScriptX.Print.reportError("Request to print no content - access denied?"),"function"==typeof o&&o("Request to print no content"),!1;var a=Date.now();return T<a-j&&(b=0),j=a,setTimeout(function(e,r,t,n,o,i){var a;MeadCo.log("started MeadCo.ScriptX.Print.print.printHtmlAtServer() Type: "+e),e===C.URL&&MeadCo.log(".. request print url: "+r),a=""===d?{}:JSON.parse(JSON.stringify(p[d]));var c={ContentType:e,Content:r,Settings:JSON.parse(JSON.stringify(t)),Device:a,ProtectedContentAccess:f,OnProgress:o,UserData:i},s={jobIdentifier:Date.now(),printerName:c.Device.printerName,jobName:"Job timeout hold clientside"};S(s);var l=MeadCo.makeApiEndPoint(g.url,u);return function(){return E(s.jobIdentifier),D(l,c,{fail:function(e,r,t){var o=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.printHtmlAtServer",e,r,t);P(c,y.ERROR,o),MeadCo.ScriptX.Print.reportError(o),"function"==typeof n&&n("Server error")},queuedToFile:function(e){MeadCo.log("default handler on queued to file response"),P(c,y.QUEUED),O(l,c,e.jobIdentifier,-1,function(e){null!==e&&(MeadCo.log("Will download printed file"),P(c,y.COMPLETED),window.open(l+"/download/"+e.jobIdentifier,"_self")),"function"==typeof n&&n(null===e?"Server error":null)})},queuedToDevice:function(e){MeadCo.log("print was queued to device"),P(c,y.QUEUED),O(l,c,e.jobIdentifier,-1,function(e){null!==e&&P(c,y.COMPLETED),"function"==typeof n&&n(null===e?"Server error":null)})},softError:function(e){P(c,y.ERROR,e.message),MeadCo.ScriptX.Print.reportError(e.message),MeadCo.log("print has soft error"),E(e.jobIdentifier),"function"==typeof n&&(MeadCo.log("Call fnDone"),n(e.message))},ok:function(e){P(c,y.COMPLETED),MeadCo.log("printed ok, no further information"),E(e.jobIdentifier),"function"==typeof n&&n(null)}})}}(e,r,t,o,n,i),b),b+=w,!0},printPdf:function(e,r,t,o,n){if(!e||"string"==typeof e&&0===e.length)return MeadCo.ScriptX.Print.reportError("The document to print must be given."),"function"==typeof t&&t("Request to print no content"),!1;var i=Date.now();return T<i-j&&(b=0),j=i,setTimeout(function(e,r,n,t,o){var i;MeadCo.log("started MeadCo.ScriptX.Print.print.printPdfAtServer() document: "+e+", printerName: "+d),i=""===d?{}:JSON.parse(JSON.stringify(p[d]));var a={Document:e,Description:r.jobDescription,Settings:JSON.parse(JSON.stringify(r)),Device:i,ProtectedContentAccess:f,OnProgress:t,UserData:o};a.Settings.jobTitle=r.jobDescription;var c=MeadCo.makeApiEndPoint(g.url,l),s={jobIdentifier:Date.now(),printerName:a.Device.printerName,jobName:"Job timeout hold clientside"};return S(s),function(){return E(s.jobIdentifier),D(c,a,{fail:function(e,r,t){var o=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.printPdfAtServer",e,r,t);P(a,y.ERROR,o),MeadCo.ScriptX.Print.reportError(o),"function"==typeof n&&n("Server error")},queuedToFile:function(e){MeadCo.log("default handler on queued to file response"),P(a,y.QUEUED),O(c,a,e.jobIdentifier,-1,function(e){null!==e&&(MeadCo.log("Will download printed file"),P(a,y.COMPLETED),window.open(c+"/download/"+e.jobIdentifier,"_self")),"function"==typeof n&&n(null===e?"Server error":null)})},queuedToDevice:function(e){MeadCo.log("print was queued to device"),P(a,y.QUEUED),O(c,a,e.jobIdentifier,-1,function(e){null!==e&&P(a,y.COMPLETED),"function"==typeof n&&n(null===e?"Server error":null)})},softError:function(e){P(a,y.ERROR,e.message),MeadCo.ScriptX.Print.reportError(e.message),MeadCo.log("printpdf call has soft error, remove job: "+e.jobIdentifier),E(e.jobIdentifier),"function"==typeof n&&(MeadCo.log("Call fnDone"),n("Server error"))},ok:function(e){P(a,y.COMPLETED),MeadCo.log("printed ok, no further information"),E(e.jobIdentifier),"function"==typeof n&&n(null)}})}}(e,r,t,o,n),b),b+=w,!0},printDirect:function(e,r,n){if(MeadCo.log("started MeadCo.ScriptX.Print.print.printDirectAtServer() Type: "+e+", printerName: "+d),e===C.URL)MeadCo.log(".. request print url: "+r);else if(e!==C.STRING)return MeadCo.ScriptX.Print.reportError("Bad content type for direct printing"),"function"==typeof n&&n("Bad content type for direct printing"),!1;if(!r||"string"==typeof r&&0===r.length)return MeadCo.ScriptX.Print.reportError("Request to print no content - access denied?"),"function"==typeof n&&n("Request to print no content"),!1;if(""===d)return MeadCo.ScriptX.Print.reportError("Request to print but no current printer defined."),"function"==typeof n&&n("Request to print but no current printer defined."),!1;var t={ContentType:e,Content:r,PrinterName:d,Settings:{jobTitle:"Direct print"},Device:p[d]};return D(MeadCo.makeApiEndPoint(g.url,o),t,{fail:function(e,r,t){var o=MeadCo.parseAjaxError("MeadCo.ScriptX.Print.printDirectAtServer",e,r,t);MeadCo.ScriptX.Print.reportError(o),"function"==typeof n&&n("Server error")},softError:function(e){MeadCo.ScriptX.Print.reportError(e.message),MeadCo.log("print has soft error"),E(e.jobIdentifier),"function"==typeof n&&(MeadCo.log("Call fnDone"),n(e.message))},ok:function(e){MeadCo.log("printed ok, no further information"),E(e.jobIdentifier),"function"==typeof n&&n(null)}})},parseAjaxError:function(e,r,t,o){return MeadCo.parseAjaxError(e,r,t,o)},reportError:function(e){switch(MeadCo.error("ReportError: "+e),c){case r.REPORT:MeadCo.ScriptX.Print.reportServerError(e);break;case r.THROW:throw new Error(e)}},reportServerError:function(e){alert("There was an error in the printing service\n\n"+e)},reportFeatureNotImplemented:function(e){MeadCo.log("Call to not implemented: "+e),alert(e+"\n\nis not available.")},get queue(){return s},get activeJobs(){return M()},ensureSpoolingStatus:function(){var e={jobIdentifier:Date.now(),printerName:"ensureJobsPrinter",jobName:"null Job"};return S(e),e},freeSpoolStatus:function(e){E(e.jobIdentifier)},get isSpooling(){return 0<M()},waitForSpoolingComplete:function(e,r){if(MeadCo.log("Started WaitForSpoolingComplete("+e+")"),"function"!=typeof r)throw"WaitForSpoolingComplete requires a completion callback";var t=Date.now(),o=window.setInterval(function(){0===M()?(MeadCo.log("WaitForSpoolingComplete - complete"),window.clearInterval(o),r(!0)):0<=e&&Date.now()-t>e&&(MeadCo.log("WaitForSpoolingComplete - timeout"),window.clearInterval(o),r(0===M()))},250)},get queueTimeoutSpacing(){return w},set queueTimeoutSpacing(e){w=e},get queueGapResetTime(){return T},set queueGapResetTime(e){T=e},requestService:function(e,r,t,o,n,i,a){return N(e,r,t,o,n,i,a)},getService:function(e,r,t){return N(e,"GET",r,t,!1)},postService:function(e,r,t){return N(e,"POST",r,t,!1)},getServiceAsync:function(e,r,t,o,n){return N(e,"GET",r,t,!0,o,n)},postServiceAsync:function(e,r,t,o,n){return N(e,"POST",r,t,!0,o,n)}}});
extendMeadCoNamespace("MeadCo.ScriptX.Print.Licensing",function(){var n="1.10.1.0",f="v1/licensing",a="",o=0,r="",p="No license applied",d={};function c(n,e){var i=MeadCo.ScriptX.Print;void 0!==i&&"function"==typeof i.connectLite?i.connectLite(n,e):console.error("MeadCo.ScriptX.Print is not available"),a=e,d={},p="No license applied",o=0,r=""}function i(e,i){var n=MeadCo.ScriptX.Print;if(void 0!==n&&"function"==typeof n.connectLite)return 0<d.length?"function"==typeof e&&e(d):n.requestService(f,"GET",{},!0,"function"==typeof e,function(n){p="",$.extend(d,n),"function"!=typeof e||e(d)},function(n){if(p="MeadCo.ScriptX.Licensing.getSubscriptionFromServer: "+n,"function"!=typeof i)throw new Error(p);i(p)}),d;var t="MeadCo.ScriptX.Licensing : MeadCo.ScriptX.Print API not available";if("function"!=typeof i)throw new Error(t);i(t)}function u(n,e,i,t,o){MeadCo.log("Apply license: "+n+",revision: "+e+", path: "+i);var r=MeadCo.ScriptX.Print;if(void 0===r||"function"!=typeof r.connectLite){var c="MeadCo.ScriptX.Licensing : MeadCo.ScriptX.Print API not available";if("function"==typeof o)return void o(c);throw new Error(c)}var u={Guid:a=n,Url:i,Revision:e};return r.requestService(f,"POST",u,!1,"function"==typeof t,function(n){p="",$.extend(d,n),"function"!=typeof t||t(d)},function(n){p="MeadCo.ScriptX.Print.Licensing.applyLicense: "+n,"function"!=typeof o||o(p)}),"function"!=typeof t?(MeadCo.log("returning applied (sync) license: "+d.company),d):0}return MeadCo.log("MeadCo.ScriptX.Print.Licensing "+n+" loaded."),{get version(){return n},connect:function(n,e){c(n,e)},connectLite:function(n,e,i,t){c(n,e),o=i,r=t},apply:function(n,e,i){return u(n,e,i)},applyAsync:function(n,e,i,t,o){u(n,e,i,t,o)},get result(){return""===p?0:5},get validLicense(){return void 0!==d.guid},get errorMessage(){return p},get License(){return void 0!==d.guid?d:i()},GetLicenseAsync:function(n,e){i(n,e)},PolyfillInit:function(){return void 0!==d.guid||""!==a&&(""===r||(u(a,o,r),void 0!==d.guid))},PolyfillInitAsync:function(n,e){void 0!==d.guid||""===r?n(d):u(a,o,r,n,e)}}});
!function(e,i,t){if(this[e]!==t||null!==document.getElementById(e)){if(MeadCo.log("ScriptX.Services MeadCo Security Manager emulation believes it may not be required."),this[e]!==t&&MeadCo.log("this["+e+"] is defined"),null!==document.getElementById(e)&&MeadCo.log("document.getElementById("+e+") is defined"),this[e].object!==t)return MeadCo.log("this["+e+"].object is defined -- not required!!!");MeadCo.log("this["+e+"].object is *not* defined")}MeadCo.log("ScriptX.Services MeadCo Security Manager emulation believes it is required.");var n=function(){var i=MeadCo,e=MeadCo.ScriptX.Print,t=MeadCo.ScriptX.Print.Licensing;function s(e){i.log("secmgr emulation :: "+e)}this.extendSecMgrNamespace=function(e,i){var t=i();s("MeadCo security manager extending namespace2: "+e);for(var n=e.split("."),o=this,r=0;r<n.length;r++){var a=n[r];r===n.length-1?void 0===o[a]?(s("installing implementation at: "+a),o[a]=t):s("Warning - not overwriting package: "+a):void 0===o[a]?(s("initialising new: "+a),o[a]={}):s("using existing package: "+a),o=o[a]}},s("'secmgr' loaded."),"function"!=typeof t.GetLicenseAsync&&MeadCo.error("MeadCo.ScriptX.Print.Licensing not available");"function"!=typeof e.useAttributes?MeadCo.warn("Attribute based licensing not available as MeadCo.ScriptX.Print is not available"):e.useAttributes();return{log:s,get version(){return"1.10.1.0"},get result(){return t.result},get validLicense(){return t.validLicense},get License(){return t.License},GetLicenseAsync:function(e,i){t.GetLicenseAsync(e,i)},PolyfillInit:function(){return t.PolyfillInit()},PolyfillInitAsync:function(e,i){t.PolyfillInitAsync(e,i)}}}();this[e]=n}("secmgr"),"function"==typeof extendSecMgrNamespace&&extendSecMgrNamespace("secmgr.object",function(){return this.secmgr.log("secmgr.object loaded."),this.secmgr});