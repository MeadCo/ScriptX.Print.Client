@model ScriptX.Print.Client.Models.Sample

@{
    ViewBag.Title = Model.Title;
    var frameUrl = Url.Action("FramedHeaderFooterArgs");
    var server = $"{Request.Url.Scheme}://{Request.Url.Authority}{Url.Content("~/api/v1/printHtml")}";
}

<h2>@ViewBag.Title</h2>

<div>
    <button id="btn-printPage" class="btn btn-primary">Print page</button>&nbsp;<button id="btn-printDoc" class="btn btn-primary">Print doc</button>&nbsp;<button id="btn-printFrame" class="btn btn-primary">Print frame</button>
</div>

<div style="margin: 20px; width: 50%; height: 500px">
    <iframe style="width: 100%; height: 100%; border: 2px solid grey; margin: 0px" src="@frameUrl" id="infoframe"></iframe>
</div>

@section scripts
{
    <script src="~/Scripts/meadco-scriptx-1.1.4.js"></script>
    <script data-meadco-server="@server" data-meadco-license="@Model.License" src="@Url.Action("script","Home",new { filename= "meadco-scriptxfactory.js" })"></script>

    <script type="text/javascript">
        $(function() {
            console.log("Shim factory test starting");

            try {
                if (MeadCo.ScriptX.Init()) {
                    MeadCo.log("Installed version of ScriptX is: " + MeadCo.ScriptX.Version());
                    MeadCo.ScriptX.Printing.header = "This is a MeadCoJSShim Header";
                    MeadCo.log("Header was set to: " + MeadCo.ScriptX.Printing.header);

                    $("#btn-printPage").click(function (e) {
                        e.preventDefault();
                        MeadCo.ScriptX.PrintPage(true);
                    });

                    $("#btn-printDoc").click(function (e) {
                        e.preventDefault();
                        MeadCo.ScriptX.BackgroundPrintURL("http://scriptx.meadroid.com");
                    });

                    $("#btn-printFrame").click(function (e) {
                        e.preventDefault();
                        MeadCo.ScriptX.PrintFrame("infoframe");
                    });
                } else {
                    MeadCo.log("Failed to init");
                }
            } catch (e) {
                MeadCo.log("Error: " + e.message);
            }
        });
    </script>
}
